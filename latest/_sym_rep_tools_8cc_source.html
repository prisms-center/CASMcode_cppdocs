<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CASM: /Users/bpuchala/Work/codes/CASMcode_v0.2.X_reference/src/casm/symmetry/SymRepTools.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CASM
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">A Clusters Approach to Statistical Mechanics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_sym_rep_tools_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SymRepTools.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_sym_rep_tools_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_rep_tools_8hh.html">casm/symmetry/SymRepTools.hh</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_log_8hh.html">casm/casm_io/Log.hh</a>&quot;</span>  <span class="comment">// TODO: replace error log with exceptions</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="casm__io_2container_2stream__io_8hh.html">casm/casm_io/container/stream_io.hh</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_counter_8hh.html">casm/container/Counter.hh</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_c_a_s_m___eigen__math_8hh.html">casm/misc/CASM_Eigen_math.hh</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_c_a_s_m__math_8hh.html">casm/misc/CASM_math.hh</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="misc_2algorithm_8hh.html">casm/misc/algorithm.hh</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_orbit__impl_8hh.html">casm/symmetry/Orbit_impl.hh</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_group_8hh.html">casm/symmetry/SymGroup.hh</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_group_rep_8hh.html">casm/symmetry/SymGroupRep.hh</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_matrix_xd_8hh.html">casm/symmetry/SymMatrixXd.hh</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_permutation_8hh.html">casm/symmetry/SymPermutation.hh</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_vector_sym_compare__impl_8hh.html">casm/symmetry/VectorSymCompare_impl.hh</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_c_a_s_m.html">CASM</a> {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;Eigen::MatrixXcd <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools__v2_1_1_irrep_decomposition_impl.html#a34fe6112ec6265c700b785f6935c6d46">prettyc</a>(<span class="keyword">const</span> Eigen::MatrixXcd &amp;M) {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">double</span> tol = 1e-10;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  Eigen::MatrixXcd Mp(M);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; M.rows(); i++) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; M.cols(); j++) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordflow">if</span> (std::abs(<a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">std::round</a>(M(i, j).real()) - M(i, j).real()) &lt; tol) {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        Mp(i, j).real(<a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">std::round</a>(M(i, j).real()));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordflow">if</span> (std::abs(<a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">std::round</a>(M(i, j).imag()) - M(i, j).imag()) &lt; tol) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        Mp(i, j).imag(<a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">std::round</a>(M(i, j).imag()));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">return</span> Mp;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> <a class="code" href="group___linear_algebra.html#ga1712e24d5ef8f3b419e52256025aa675">pretty</a>(<span class="keyword">const</span> <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> &amp;M) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span> tol = 1e-10;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> Mp(M);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; M.rows(); i++) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; M.cols(); j++) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">if</span> (std::abs(<a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">std::round</a>(M(i, j)) - M(i, j)) &lt; tol) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        Mp(i, j) = <a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">std::round</a>(M(i, j));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">return</span> Mp;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}  <span class="comment">// namespace</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}  <span class="comment">// namespace CASM</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_c_a_s_m.html">CASM</a> {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_local.html">Local</a> {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_local_1_1_irrep_compare.html">   58</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_c_a_s_m_1_1_local_1_1_irrep_compare.html">IrrepCompare</a> {</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_local_1_1_irrep_compare.html#a39c04c708ffb1a6bd2a4780f85b74ac2">   59</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="struct_c_a_s_m_1_1_local_1_1_irrep_compare.html#a39c04c708ffb1a6bd2a4780f85b74ac2">operator()</a>(<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> <span class="keyword">const</span> &amp;irrep_a,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                  <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> <span class="keyword">const</span> &amp;irrep_b)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Eigen::VectorXcd <span class="keyword">const</span> &amp;a = irrep_a.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a0a2bf886732fa9fc46168577010b2af6">characters</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    Eigen::VectorXcd <span class="keyword">const</span> &amp;b = irrep_b.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a0a2bf886732fa9fc46168577010b2af6">characters</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">typedef</span> std::complex&lt;double&gt; C;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// Check if a and b are identity irrep, identity always compares less than</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// other irreps</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">bool</span> a_id = <a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(a[0], C(1., 0.)) &amp;&amp;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                <a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(C(a.sum()), C(a.size(), 0.));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">bool</span> b_id = <a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(b[0], C(1., 0.)) &amp;&amp;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                <a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(C(b.sum()), C(b.size(), 0.));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (a_id != b_id)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">return</span> a_id;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a_id) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">// Index is used to break ties if they are both identity</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">return</span> irrep_a.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a175c2734544c5bcd094dabd3eb16c7ec">index</a> &lt; irrep_b.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a175c2734544c5bcd094dabd3eb16c7ec">index</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Low-dimensional irreps come before higher dimensional</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(a[0], b[0])) <span class="keywordflow">return</span> a[0].real() &lt; b[0].real();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// &#39;gerade&#39; irreps come before &#39;ungerade&#39; irreps</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// This check may need to be improved to know whether inversion is actually</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// present</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">bool</span> a_g = <a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(a[0], a[a.size() - 1]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">bool</span> b_g = <a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(b[0], b[b.size() - 1]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (a_g != b_g) <span class="keywordflow">return</span> a_g;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// Finally, compare lexicographically (real first, then imag)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; a.size(); ++i) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(a[i].real(), b[i].real()))</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">return</span> a[i].real() &gt; b[i].real();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (irrep_a.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ab1e8196e27c3709fd21bf73522ee3087">complex</a> || irrep_b.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ab1e8196e27c3709fd21bf73522ee3087">complex</a>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; a.size(); ++i) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(a[i].imag(), b[i].imag()))</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <span class="keywordflow">return</span> a[i].imag() &gt; b[i].imag();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// Index is used to break ties</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">return</span> irrep_a.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a175c2734544c5bcd094dabd3eb16c7ec">index</a> &lt; irrep_b.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a175c2734544c5bcd094dabd3eb16c7ec">index</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;};</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_local_1_1___real_type.html">  110</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_c_a_s_m_1_1_local_1_1___real_type.html">_RealType</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#a9c3cddd8d2565c83b441e7ad545c4a85">  113</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_c_a_s_m_1_1_local.html#a9c3cddd8d2565c83b441e7ad545c4a85">_Real</a> = <span class="keyword">typename</span> <a class="code" href="struct_c_a_s_m_1_1_local_1_1___real_type.html">_RealType&lt;T&gt;::Type</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01std_1_1vector_3_01_t_01_4_01_4.html">  116</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_c_a_s_m_1_1_local_1_1___real_type.html">_RealType</a>&lt;<a class="code" href="namespacestd.html">std</a>::vector&lt;T&gt;&gt; {</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01std_1_1vector_3_01_t_01_4_01_4.html#ae3d9c10cc8989236eb6f816e6e1c740d">  117</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01std_1_1vector_3_01_t_01_4_01_4.html#ae3d9c10cc8989236eb6f816e6e1c740d">Type</a> = std::vector&lt;_Real&lt;T&gt;&gt;;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;};</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Scalar, <span class="keywordtype">int</span> RowsAtCompileTime, <span class="keywordtype">int</span> ColsAtCompileTime&gt;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01_eigen_1_1_matrix_3_01_scalar_00_01_rows_at_compile6f4d710d8c9ad9672096477019959e44.html">  121</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_c_a_s_m_1_1_local_1_1___real_type.html">_RealType</a>&lt;<a class="code" href="namespace_eigen.html">Eigen</a>::Matrix&lt;Scalar, RowsAtCompileTime, ColsAtCompileTime&gt;&gt; {</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01_eigen_1_1_matrix_3_01_scalar_00_01_rows_at_compile6f4d710d8c9ad9672096477019959e44.html#a7443da17095b4d4be172ffec44728460">  122</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01_eigen_1_1_matrix_3_01_scalar_00_01_rows_at_compile6f4d710d8c9ad9672096477019959e44.html#a7443da17095b4d4be172ffec44728460">Type</a> = Eigen::Matrix&lt;double, RowsAtCompileTime, ColsAtCompileTime&gt;;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;};</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Derived&gt;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#aad6b338413750f42a180b53b723b61ed">  126</a></span>&#160;<a class="code" href="namespace_c_a_s_m_1_1_local.html#a9c3cddd8d2565c83b441e7ad545c4a85">_Real&lt;Derived&gt;</a> <a class="code" href="namespace_c_a_s_m_1_1_local.html#aad6b338413750f42a180b53b723b61ed">_real</a>(Eigen::MatrixBase&lt;Derived&gt; <span class="keyword">const</span> &amp;mat) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span> mat.real().template cast&lt;double&gt;();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#a3f8ad3f675fef9ea32559a13a1ed20ac">  131</a></span>&#160;<a class="code" href="namespace_c_a_s_m_1_1_local.html#a9c3cddd8d2565c83b441e7ad545c4a85">_Real&lt;std::vector&lt;T&gt;</a>&gt; <a class="code" href="namespace_c_a_s_m_1_1_local.html#aad6b338413750f42a180b53b723b61ed">_real</a>(std::vector&lt;T&gt; <span class="keyword">const</span> &amp;vec) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  std::vector&lt;_Real&lt;T&gt;&gt; result;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  result.reserve(vec.size());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">for</span> (T <span class="keyword">const</span> &amp;el : vec) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    result.emplace_back(<a class="code" href="namespace_c_a_s_m_1_1_local.html#aad6b338413750f42a180b53b723b61ed">_real</a>(el));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#a43878c3acaba35209db62ba5bf80cce4">  146</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> <a class="code" href="namespace_c_a_s_m_1_1_local.html#a43878c3acaba35209db62ba5bf80cce4">_block_shape_matrix</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                           <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (!_rep.size() || !head_group.size() || !_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[0]))</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a>();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> block_shape(</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[0])</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          -&gt;cwiseProduct(*_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[0])));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 1; i &lt; head_group.size(); i++) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    block_shape += _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[i])</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                       -&gt;cwiseProduct(*_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[i]));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">return</span> block_shape;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// assumes that representation is real-valued and irreducible</span></div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#a7107b8aa69050f38129e9ac44e71bf58">  166</a></span>&#160;<span class="keyword">static</span> Eigen::MatrixXcd <a class="code" href="namespace_c_a_s_m_1_1_local.html#a7107b8aa69050f38129e9ac44e71bf58">_irrep_symmetrizer_from_directions</a>(</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="struct_c_a_s_m_1_1multivector.html">multivector&lt;Eigen::VectorXcd&gt;::X&lt;2&gt;</a> <span class="keyword">const</span> &amp;special_directions,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXcd&gt; <span class="keyword">const</span> &amp;_subspace,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">double</span> vec_compare_tol) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// Four strategies, in order of desparation</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// 1) find a spanning set of orthogonal axes within a single orbit of special</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// directions 2) find a spanning set of orthogonal axes within the total set</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// of special directions 3) perform qr decomposition on lowest-multiplicity</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// orbit to find spanning set of axes 4) find column-echelon form of _subspace</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// matrix to get a sparse/pretty set of axes</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  Eigen::MatrixXcd result;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> dim = _subspace.cols();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> min_mult = 10000;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">bool</span> orb_orthog = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">bool</span> tot_orthog = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  Eigen::MatrixXcd axes, orb_axes, tot_axes;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> tot_col(0);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  tot_axes.setZero(_subspace.rows(), dim);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;orbit : special_directions) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// Strategy 1</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> ((orb_orthog &amp;&amp; orbit.size() &lt; min_mult) || !orb_orthog) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      orb_axes.setZero(_subspace.rows(), dim);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> col = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;el : orbit) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>((el.adjoint() * orb_axes).eval(), vec_compare_tol)) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keywordflow">if</span> (col &lt; orb_axes.cols())</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            orb_axes.col(col++) = el;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            std::stringstream errstr;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            errstr</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Error in irrep_symmtrizer_from_directions(). Constructing &quot;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                   <span class="stringliteral">&quot;coordinate axes from special directions of space spanned &quot;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                   <span class="stringliteral">&quot;by row vectors:\n &quot;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                &lt;&lt; _subspace.transpose()</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;\nAxes collected thus far are the row vectors:\n&quot;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                &lt;&lt; orb_axes.transpose()</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;\nBut an additional orthogonal row vector has been found:\n&quot;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                &lt;&lt; el.transpose()</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;\nindicating that subspace matrix is malformed.&quot;</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(errstr.str());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">if</span> (col == dim) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;PLAN A-- col: &quot; &lt;&lt; col &lt;&lt; &quot;; dim: &quot; &lt;&lt; dim &lt;&lt; &quot;;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// min_mult: &quot; &lt;&lt; min_mult &lt;&lt; &quot;; orthog: &quot; &lt;&lt; orb_orthog &lt;&lt; &quot;;\naxes:</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">// \n&quot;</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// &lt;&lt; axes &lt;&lt; &quot;\norb_axes: \n&quot; &lt;&lt; orb_axes &lt;&lt; &quot;\n\n&quot;;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        orb_orthog = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        min_mult = orbit.size();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        axes = orb_axes;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// Greedy(ish) implementation of strategy 2 -- may not find a solution, even</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// if it exists</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (!orb_orthog &amp;&amp; !tot_orthog) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;el : orbit) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>((el.adjoint() * tot_axes).eval(), vec_compare_tol)) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          <span class="keywordflow">if</span> (tot_col &lt; tot_axes.cols())</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            tot_axes.col(tot_col++) = el;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            std::stringstream errstr;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            errstr</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Error in irrep_symmtrizer_from_directions(). Constructing &quot;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                   <span class="stringliteral">&quot;coordinate axes from special directions of space spanned &quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                   <span class="stringliteral">&quot;by row vectors:\n &quot;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                &lt;&lt; _subspace.transpose()</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;\nAxes collected thus far are the row vectors:\n&quot;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                &lt;&lt; tot_axes.transpose()</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;\nBut an additional orthogonal row vector has been found:\n&quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                &lt;&lt; el.transpose()</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;\nindicating that subspace matrix is malformed.&quot;</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(errstr.str());</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span> (tot_col == dim) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;PLAN B-- col: &quot; &lt;&lt; tot_col &lt;&lt; &quot;; dim: &quot; &lt;&lt; dim &lt;&lt; &quot;;</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">// min_mult: &quot; &lt;&lt; min_mult &lt;&lt; &quot;; orthog: &quot; &lt;&lt; tot_orthog &lt;&lt; &quot;;\naxes:</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// \n&quot;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="comment">// &lt;&lt; axes &lt;&lt; &quot;\ntot_axes: \n&quot; &lt;&lt; tot_axes &lt;&lt; &quot;\n\n&quot;;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        tot_orthog = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        axes = tot_axes;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// Strategy 3</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (!orb_orthog &amp;&amp; !tot_orthog &amp;&amp; orbit.size() &lt; min_mult) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      orb_axes.setZero(_subspace.rows(), orbit.size());</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> col = 0; col &lt; orbit.size(); ++col) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        orb_axes.col(col) = orbit[col];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="comment">// std::cout &lt;&lt; &quot;PLAN C--  dim: &quot; &lt;&lt; dim &lt;&lt; &quot;; min_mult: &quot; &lt;&lt; min_mult &lt;&lt;</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="comment">// &quot;; orthog: &quot; &lt;&lt; orb_orthog &lt;&lt; &quot;;\naxes: \n&quot; &lt;&lt; axes;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      min_mult = orbit.size();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      axes = Eigen::MatrixXcd(orb_axes.colPivHouseholderQr().matrixQ())</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                 .leftCols(dim);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="comment">// std::cout &lt;&lt; &quot;\norb_axes: \n&quot; &lt;&lt; orb_axes &lt;&lt; &quot;\n\n&quot;;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;axes: \n&quot; &lt;&lt; axes &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (axes.cols() == 0) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Plan D\n&quot;;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// SubspaceSymCompare doesn&#39;t actually use _rep</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    result = _subspace.colPivHouseholderQr().solve(</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="namespace_eigen.html#ab60d5c1366dd3d1b998333be1cbda72c">representation_prepare_impl</a>(_subspace, vec_compare_tol));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// Strategy 4</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    result = _subspace.colPivHouseholderQr().solve(axes);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;result: \n&quot; &lt;&lt; result &lt;&lt; &quot;\n&quot;</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">//&lt;&lt; &quot;_subspace*result: \n&quot; &lt;&lt; _subspace *result &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">return</span> result;  <span class="comment">//.transpose();</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#a1db9e1f3ad6bda87618083a07637984f">  287</a></span>&#160;<span class="keyword">static</span> <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">SymRepTools::IrrepWedge</a> <a class="code" href="namespace_c_a_s_m_1_1_local.html#a1db9e1f3ad6bda87618083a07637984f">_wedge_from_pseudo_irrep</a>(</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> <span class="keyword">const</span> &amp;irrep, <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> t_axes = irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ac4900083bcc0ce1ce544bc05de3ad4b0">trans_mat</a>.transpose().real();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> axes = <a class="code" href="namespace_eigen.html#ab60d5c1366dd3d1b998333be1cbda72c">representation_prepare_impl</a>(t_axes, <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aee432f438a1e381a46d59986e037200f">Eigen::VectorXd</a> v = axes.col(0);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aee432f438a1e381a46d59986e037200f">Eigen::VectorXd</a> vbest;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  axes.setZero(irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a3bd6850cd8c7a3eb523dd4efa5a3693e">vector_dim</a>(), irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#afcc60ff4c585665ea340aab6fb494d33">irrep_dim</a>());</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  axes.col(0) = v;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 1; i &lt; axes.cols(); ++i) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">double</span> bestproj = -1;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="class_c_a_s_m_1_1_sym_op.html">SymOp</a> <span class="keyword">const</span> &amp;op : head_group) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      v = (*_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(op)) * axes.col(0);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">// std::cout &lt;&lt; &quot;v: &quot; &lt;&lt; v.transpose() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordtype">bool</span> skip_op = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> j = 0; j &lt; i; ++j) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(v, axes.col(j))) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          skip_op = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">if</span> (skip_op) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">// std::cout &lt;&lt; &quot;bproj: &quot; &lt;&lt; bestproj &lt;&lt; &quot;  proj: &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// (v.transpose()*axes).transpose() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">if</span> (bestproj &lt; (v.transpose() * axes).sum()) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        bestproj = (v.transpose() * axes).<a class="code" href="namespace_c_a_s_m.html#a85c0e41be877c6726fe49f58506e1e50">sum</a>();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        vbest = v;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    axes.col(i) = vbest;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">SymRepTools::IrrepWedge</a>(irrep, axes);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#a2eaad124c966f3f886f3f885cee7bd92">  327</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_c_a_s_m_1_1_local.html#a2eaad124c966f3f886f3f885cee7bd92">_rep_check</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keywordtype">bool</span> verbose) {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">bool</span> passed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> ns = 0; ns &lt; head_group.size(); ns++) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> tmat = *(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[ns]));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (!almost_equal&lt;double&gt;((tmat * tmat.transpose()).trace(), tmat.cols())) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      passed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Representation failed full-rank/orthogonality check!\n&quot;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;  ns: &quot;</span> &lt;&lt; ns &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;  Matrix: \n&quot;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                  &lt;&lt; tmat &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;  Matrix*transpose: \n&quot;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                  &lt;&lt; tmat.transpose() * tmat &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> ns2 = ns; ns2 &lt; head_group.size(); ns2++) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keyword">auto</span> prod = (*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[ns]))) *</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                  (*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[ns2])));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> iprod = head_group[ns].<a class="code" href="class_c_a_s_m_1_1_sym_group.html#a82dc91ea37a33372c1651187bc69fcd3">ind_prod</a>(head_group[ns2]);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="group___tensor.html#gafe083696121adf5c9ca773388c59019f">norm</a> = (prod - *(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(iprod))).norm();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>(<a class="code" href="group___tensor.html#gafe083696121adf5c9ca773388c59019f">norm</a>)) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        passed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;  Representation failed multiplication check!\n&quot;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  ns: &quot;</span> &lt;&lt; ns &lt;&lt; <span class="stringliteral">&quot;  ns2: &quot;</span> &lt;&lt; ns2 &lt;&lt; <span class="stringliteral">&quot; iprod: &quot;</span> &lt;&lt; iprod</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; NO MATCH\n&quot;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  prod: \n&quot;</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    &lt;&lt; prod &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  mat(ns): \n&quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    &lt;&lt; *(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(ns)) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  mat(ns2): \n&quot;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    &lt;&lt; *(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(ns2)) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  mat(iprod): \n&quot;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    &lt;&lt; *(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(iprod)) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">return</span> passed;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_local.html#a138e9db175825351b3913b7f6f99df7a">  368</a></span>&#160;<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> <a class="code" href="namespace_c_a_s_m_1_1_local.html#a138e9db175825351b3913b7f6f99df7a">_subspace_to_full_space</a>(</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> <span class="keyword">const</span> &amp;irrep, Eigen::MatrixBase&lt;T&gt; <span class="keyword">const</span> &amp;subspace) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> result(irrep);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  result.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ac4900083bcc0ce1ce544bc05de3ad4b0">trans_mat</a> = irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ac4900083bcc0ce1ce544bc05de3ad4b0">trans_mat</a> *</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                     subspace.adjoint().template cast&lt;std::complex&lt;double&gt;&gt;();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  result.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a46f893b0244e203cbac0a5e9d6c18214">directions</a>.clear();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;direction_orbit : irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a46f893b0244e203cbac0a5e9d6c18214">directions</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    std::vector&lt;Eigen::VectorXd&gt; new_orbit;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    new_orbit.reserve(direction_orbit.size());</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;directions : direction_orbit) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      new_orbit.push_back(subspace * directions);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    result.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a46f893b0244e203cbac0a5e9d6c18214">directions</a>.push_back(std::move(new_orbit));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}  <span class="comment">// namespace Local</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}  <span class="comment">// namespace CASM</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_c_a_s_m.html">CASM</a> {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keyword">namespace </span>SymRepTools {</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a24613caac83f19ed831d200701bb2797">  391</a></span>&#160;<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a24613caac83f19ed831d200701bb2797">IrrepInfo::IrrepInfo</a>(Eigen::MatrixXcd _trans_mat, Eigen::VectorXcd _characters)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    : index(0),</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      trans_mat(<a class="code" href="namespacestd.html">std</a>::move(_trans_mat)),</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      characters(<a class="code" href="namespacestd.html">std</a>::move(_characters)) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ab1e8196e27c3709fd21bf73522ee3087">complex</a> = !<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>(<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ac4900083bcc0ce1ce544bc05de3ad4b0">trans_mat</a>.imag());</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}  <span class="comment">// namespace SymRepTools</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#aea0a866f5769367cb4de0fb6b0a4b2c2">  402</a></span>&#160;<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> <a class="code" href="namespace_c_a_s_m.html#aea0a866f5769367cb4de0fb6b0a4b2c2">num_blocks</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> bmat(<a class="code" href="namespace_c_a_s_m_1_1_local.html#a43878c3acaba35209db62ba5bf80cce4">Local::_block_shape_matrix</a>(_rep, head_group));</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> (bmat.cols() == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> Nb = 1;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// count zeros on first superdiagonal</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aca8cea3f57279005061816bdd2e7f97a">EigenIndex</a> i = 0; i + 1 &lt; bmat.rows(); i++) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>(bmat(i, i + 1))) Nb++;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">return</span> Nb;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">// assumes that representation is real-valued and irreducible</span></div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">  420</a></span>&#160;<a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a0c8815ad6af327131002e99bf03cb7d9">SymRepTools::Symmetrizer</a> <a class="code" href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">irrep_symmetrizer</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                           <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                           <span class="keywordtype">double</span> vec_compare_tol) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> dim = _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(0)-&gt;cols();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">irrep_symmetrizer</a>(</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      _rep, head_group, <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_builder.html#a7b03a9898fd1a6f469865ce1097ba7eb">Eigen::MatrixXcd::Identity</a>(dim, dim), vec_compare_tol);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">// assumes that representation is real-valued and irreducible</span></div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a50c2f489331f6d9f9f2909e2e94af770">  431</a></span>&#160;<a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a0c8815ad6af327131002e99bf03cb7d9">SymRepTools::Symmetrizer</a> <a class="code" href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">irrep_symmetrizer</a>(</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXcd&gt; <span class="keyword">const</span> &amp;_subspace,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">double</span> vec_compare_tol) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// Result of sdirs is ordered by symmetry breaking properties of different</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// directions. We won&#39;t do any element-based comparisons after this point, in</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// order to ensure that our choice of axes is totally determined by symmetry</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;Eigen::VectorXcd&gt;::X</a>&lt;2&gt; sdirs =</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#ac8763cffe4eb268bbb48b7a6caee626e">special_irrep_directions</a>(_rep, head_group, _subspace, vec_compare_tol);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">return</span> std::make_pair(<a class="code" href="namespace_c_a_s_m_1_1_local.html#a7107b8aa69050f38129e9ac44e71bf58">Local::_irrep_symmetrizer_from_directions</a>(</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                            sdirs, _subspace, vec_compare_tol),</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        std::move(sdirs));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a169a1e4b935291374d062af91051c83a">  447</a></span>&#160;<a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> <a class="code" href="namespace_c_a_s_m.html#a169a1e4b935291374d062af91051c83a">full_trans_mat</a>(</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    std::vector&lt;SymRepTools::IrrepInfo&gt; <span class="keyword">const</span> &amp;irreps) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> row = 0;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> col = 0;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;irrep : irreps) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    col = irrep.vector_dim();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    row += irrep.irrep_dim();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> trans_mat(row, col);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  row = 0;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;irrep : irreps) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    trans_mat.block(row, 0, irrep.irrep_dim(), irrep.vector_dim()) =</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        irrep.trans_mat.real();</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    row += irrep.irrep_dim();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">return</span> trans_mat;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a8a4e314541dcd4fbed7831b391944715">  467</a></span>&#160;<a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;Eigen::VectorXd&gt;::X</a>&lt;3&gt; <a class="code" href="namespace_c_a_s_m.html#a8a4e314541dcd4fbed7831b391944715">special_total_directions</a>(</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  std::vector&lt;SymRepTools::IrrepInfo&gt; irreps =</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(_rep, head_group, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;Eigen::VectorXd&gt;::X</a>&lt;3&gt; result;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  result.reserve(irreps.size());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;irrep : irreps) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    result.emplace_back(<a class="code" href="namespace_c_a_s_m_1_1_local.html#aad6b338413750f42a180b53b723b61ed">Local::_real</a>(irrep.directions));</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#ac8763cffe4eb268bbb48b7a6caee626e">  488</a></span>&#160;<a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;Eigen::VectorXcd&gt;::X</a>&lt;2&gt; <a class="code" href="namespace_c_a_s_m.html#ac8763cffe4eb268bbb48b7a6caee626e">special_irrep_directions</a>(</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">double</span> vec_compare_tol) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> dim = _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>();</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#ac8763cffe4eb268bbb48b7a6caee626e">special_irrep_directions</a>(</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      _rep, head_group, <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_builder.html#a7b03a9898fd1a6f469865ce1097ba7eb">Eigen::MatrixXcd::Identity</a>(dim, dim), vec_compare_tol);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a0c8cd1a746ee19d265a78421ea046bcb">  503</a></span>&#160;<a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;Eigen::VectorXcd&gt;::X</a>&lt;2&gt; <a class="code" href="namespace_c_a_s_m.html#ac8763cffe4eb268bbb48b7a6caee626e">special_irrep_directions</a>(</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXcd&gt; <span class="keyword">const</span> &amp;_subspace, <span class="keywordtype">double</span> vec_compare_tol,</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">bool</span> all_subgroups) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keyword">auto</span> sgroups =</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      (all_subgroups ? head_group.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#a20a9e1d2ba4873d95f09ac3e3cf2ad9a">subgroups</a>() : head_group.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#a7f1f41f1f5c4951e2029324e4ff31a1c">small_subgroups</a>());</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  std::vector&lt;Eigen::VectorXcd&gt; tdirs;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> R;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> dim = _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>();</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// Loop over small (i.e., cyclic) subgroups and hope that each special</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// direction is invariant to at least one small subgroup</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;orbit : sgroups) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// Reynolds for small subgroup *(orbit.begin()) in irrep subspace i</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    R.setZero(dim, dim);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> op : *(orbit.begin())) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      R += *(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[op]));</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span> ((R * _subspace).norm() &lt; <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// Find spanning vectors of column space of R*_subspace, which is projection</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// of _subspace into its invariant component</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">auto</span> QR = (R * _subspace).colPivHouseholderQr();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    QR.setThreshold(<a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// std::cout&lt;&lt; &quot; ----------------------------------------------------------</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// &quot; &lt;&lt; std::endl; std::cout &lt;&lt; &quot;Identity projector: \n&quot; &lt;&lt; R &lt;&lt; &quot;\n\n&quot;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">//          &lt;&lt; &quot;Projected coordinates:\n&quot; &lt;&lt; R*_subspace &lt;&lt; &quot;\n\n&quot;;</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Q matrix: \n&quot; &lt;&lt; Eigen::MatrixXd(QR.matrixQ()) &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;R matrix: \n&quot; &lt;&lt; Eigen::MatrixXd(QR.matrixR().template</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// triangularView&lt;Eigen::Upper&gt;()) &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// // If only one spanning vector, it is special direction</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (QR.rank() &gt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    Eigen::MatrixXcd Q = QR.matrixQ();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Special direction identified:\n&quot; &lt;&lt; Q.col(0).transpose() &lt;&lt;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// &quot;\n\n&quot;; std::cout &lt;&lt; &quot;MatrixR:a\n&quot; &lt;&lt;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// Eigen::MatrixXd(QR.matrixR().template triangularView&lt;Eigen::Upper&gt;()) &lt;&lt;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// &quot;\n&quot;;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// // PRINT OUT  the Reynolds matrix if its going to be added</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// std::cout&lt;&lt; &quot; ----------------------------------------------------------</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// &quot; &lt;&lt; std::endl; std::cout&lt;&lt; R &lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// Convert from irrep subspace back to total space and push_back</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    tdirs.push_back(Q.col(0));</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    tdirs.push_back(-Q.col(0));</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// std::cout&lt;&lt; &quot; The added vector is :</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// &quot;&lt;&lt;t_result.back().back().transpose()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// //Calculate the rank using an SVD decomposition</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// Eigen::JacobiSVD&lt;Eigen::MatrixXd&gt; svd(R);</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">// svd.setThreshold(1e-5);</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// std::cout&lt;&lt;&quot;The SVD rank is          : &quot;&lt;&lt;svd.rank()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// std::cout&lt;&lt;&quot;The singular values are  :</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">// &quot;&lt;&lt;svd.singularValues().transpose()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// //Loop over the SVD and count the number of non-zero singular values</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// int svd_rank = 0;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// for(auto singular_index = 0 ; singular_index&lt;svd.singularValues().size()</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// ; singular_index++)</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//   svd_rank += (std::abs(svd.singularValues()[singular_index]) &gt; 1e-5);</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// std::cout&lt;&lt;&quot;The calculated rank is   : &quot;&lt;&lt;svd_rank&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// std::cout&lt;&lt;&quot;The threshold is         : &quot;&lt;&lt;svd.threshold()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">// std::cout&lt;&lt;&quot;The maxPivot  is         : &quot;&lt;&lt;QR.maxPivot()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">// std::cout&lt;&lt; &quot; ----------------------------------------------------------</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">// &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// t_result may contain duplicates, or elements that are equivalent by</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// symmetry. To discern more info, we need to exclude duplicates and find</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">// the orbit of the directions. this should also</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// reveal the invariant subgroups.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keyword">using</span> SymCompareType =</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_direction_sym_compare.html">DirectionSymCompare&lt;Eigen::VectorXcd, EigenSymRepApply&lt;Eigen::VectorXcd&gt;</a>&gt;;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keyword">using</span> VectorOrbit = <a class="code" href="class_c_a_s_m_1_1_orbit.html">Orbit&lt;SymCompareType&gt;</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  std::set&lt;VectorOrbit&gt; orbit_result;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a0cf952b51ed558eba3df38f0e29142a4">make_orbits</a>(tdirs.begin(), tdirs.end(), head_group,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;              SymCompareType(vec_compare_tol, _rep),</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;              std::inserter(orbit_result, orbit_result.begin()));</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;Eigen::VectorXcd&gt;::X</a>&lt;2&gt; result;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;subspace: \n&quot; &lt;&lt; _subspace &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;Found &quot; &lt;&lt; orbit_result.size() &lt;&lt; &quot; direction orbits:\n&quot;;</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">for</span> (VectorOrbit <span class="keyword">const</span> &amp;orbit : orbit_result) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// std::cout &lt;&lt; orbit.begin()-&gt;transpose() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;---------\n&quot;;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    result.emplace_back(orbit.begin(), orbit.end());</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">if</span> (all_subgroups || result.size() &gt;= _subspace.cols()) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;special_irrep_direcions RETURNING RESULT\n&quot;;</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;result size: &quot; &lt;&lt; result.size() &lt;&lt; &quot;; _subspace cols: &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// _subspace.cols() &lt;&lt; &quot;\n&quot;; std::cout &lt;&lt; &quot;special_irrep_direcions REDOING</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// CALCULATION\n&quot;;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#ac8763cffe4eb268bbb48b7a6caee626e">special_irrep_directions</a>(_rep, head_group, _subspace,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                    vec_compare_tol, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">// Similar to algorithm for finding special directions, except we also find</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">// special planes, n-planes, etc. The matrices that are returned have column</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">// vectors that span the special subspaces.  The subspaces are arranged in</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">// orbits of subspaces that are equivalent by symmetry</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a6f18e9d065a782fcd4c27cd7082d71b7">  610</a></span>&#160;std::vector&lt;std::vector&lt;Eigen::MatrixXd&gt;&gt; <a class="code" href="namespace_c_a_s_m.html#a6f18e9d065a782fcd4c27cd7082d71b7">special_subspaces</a>(</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (!_rep.size() || !_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(0)) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>() &lt;&lt; <span class="stringliteral">&quot;CRITICAL ERROR: In special_subspaces() called on &quot;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                 <span class="stringliteral">&quot;imcompatible SymGroupRep.\n Exiting...\n&quot;</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    exit(1);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i, j, k;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  std::vector&lt;std::vector&lt;Eigen::MatrixXd&gt;&gt;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      ssubs;  <span class="comment">// std::vector of orbits of special directions</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> tsub, ttrans;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// Operation indices of subgroups</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp;sg_op_inds(head_group.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#a20a9e1d2ba4873d95f09ac3e3cf2ad9a">subgroups</a>());</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  Eigen::ColPivHouseholderQR&lt;Eigen::MatrixXd&gt; QR(*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(0)));</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  QR.setThreshold(<a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> Reynolds(*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(0)));</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// &#39;i&#39; loops over subgroup &quot;orbits&quot;. There are 0 to &#39;dim&#39; special directions</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// associated with each orbit.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; sg_op_inds.size(); i++) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (sg_op_inds[i].size() == 0 || sg_op_inds[i].begin()-&gt;size() == 0) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>() &lt;&lt; <span class="stringliteral">&quot;CRITICAL ERROR: In special_subspaces(), attempting to use &quot;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                   <span class="stringliteral">&quot;a zero-size subgroup.\n Exiting...\n&quot;</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      exit(1);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    Reynolds.setZero();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// j loops over elements of &quot;prototype&quot; subgroup to get the Reynold&#39;s</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// operator for the vector space on which the representation is defined</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> op : *(sg_op_inds[i].begin())) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      Reynolds += *(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[op]));</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    Reynolds /= double(sg_op_inds[i].begin()-&gt;size());</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// Column space of Reynold&#39;s matrix is invariant under the subgroup</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    QR.compute(Reynolds);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// If there are no special subspaces, the Reynold&#39;s operator has zero</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span> (QR.rank() &lt; 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">// The first (QR.rank()) columns of QR.matrixQ() span a special subspace --</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">// this can be accessed as QR.matrixQ().leftCols(QR.rank())</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    tsub = <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a>(QR.householderQ()).leftCols(QR.rank());</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// See if tsub has been found. Because we only keep orthonormal spanning</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// vectors, this check is significantly simplified</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">//  -- the matrix (tsub.transpose()*ssubs[j][k]) must have a determinant of</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">//  +/-1 if the two matrices span the same column space</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; ssubs.size(); j++) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keywordflow">if</span> (ssubs[j][0].cols() != tsub.cols()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; ssubs[j].size(); k++) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordtype">double</span> tdet = (tsub.transpose() * ssubs[j][k]).determinant();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(std::abs(tdet), 1.0)) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span> (k &lt; ssubs[j].size()) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (j &lt; ssubs.size()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// tsub is new -- get equivalents</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    ssubs.push_back(std::vector&lt;Eigen::MatrixXd&gt;());</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; head_group.size(); j++) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      ttrans = (*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[j]))) * tsub;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; ssubs.back().size(); k++) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordtype">double</span> tdet = (ttrans.transpose() * ssubs.back()[k]).determinant();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(std::abs(tdet), 1.0)) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">if</span> (k == ssubs.back().size()) ssubs.back().push_back(ttrans);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// Unlike directions, the negative orientation of a subspace matrix is not</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">// considered distinct. This is because we are only concerned about</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// coordinate axes.</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">// Order subspaces by dimension, small to large; within blocks of equal</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// dimension, order from lowest multiplicity to highest</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; ssubs.size(); i++) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">for</span> (j = i + 1; j &lt; ssubs.size(); j++) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordflow">if</span> (ssubs[i][0].cols() &gt; ssubs[j][0].cols()) ssubs[i].<a class="code" href="namespace_c_a_s_m.html#a4afad0f276101a30d9239372e963976b">swap</a>(ssubs[j]);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">if</span> (ssubs[i][0].cols() == ssubs[j][0].cols() &amp;&amp;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          ssubs[i].size() &gt; ssubs[j].size())</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        ssubs[i].<a class="code" href="namespace_c_a_s_m.html#a4afad0f276101a30d9239372e963976b">swap</a>(ssubs[j]);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">return</span> ssubs;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a14438ef105bddc48e0bc83073d0f2592">  708</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_c_a_s_m.html#a14438ef105bddc48e0bc83073d0f2592">is_irrep</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordtype">double</span> tvalue = 0;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; head_group.size(); i++) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    tvalue += (_rep[head_group[i].index()]-&gt;character()) *</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;              (_rep[head_group[i].index()]-&gt;character());</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a>(<a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">round</a>(tvalue)) == head_group.size()) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#ae738563f19bf3da2667828a8b491c3fc">  725</a></span>&#160;<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html">VectorSpaceSymReport</a> <a class="code" href="namespace_c_a_s_m.html#a0596b57289630bc8ba7e960b7143a5fe">vector_space_sym_report</a>(</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXd&gt; <span class="keyword">const</span> &amp;_subspace, <span class="keywordtype">bool</span> calc_wedge) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html">VectorSpaceSymReport</a> result;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">if</span> (calc_wedge) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a60ced0fffe11145d9327ff3df21c3eac">irreducible_wedge</a> =</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">SymRepTools::symrep_subwedges</a>(_rep, head_group, _subspace);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (!result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a60ced0fffe11145d9327ff3df21c3eac">irreducible_wedge</a>.empty()) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a914089ace50a744e00473f5920a7b3fe">irreps</a>.reserve(result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a60ced0fffe11145d9327ff3df21c3eac">irreducible_wedge</a>[0].irrep_wedges().size());</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;wedge : result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a60ced0fffe11145d9327ff3df21c3eac">irreducible_wedge</a>[0].irrep_wedges()) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a914089ace50a744e00473f5920a7b3fe">irreps</a>.push_back(wedge.irrep_info);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a914089ace50a744e00473f5920a7b3fe">irreps</a> = <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(_rep, head_group, _subspace, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a59b177df8cd516113d550066df6d96ea">symmetry_adapted_dof_subspace</a> =</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#a169a1e4b935291374d062af91051c83a">full_trans_mat</a>(result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a914089ace50a744e00473f5920a7b3fe">irreps</a>).adjoint();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a22c55848dc64bc5c1ceddea603b7b83a">axis_glossary</a> = std::vector&lt;std::string&gt;(</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a59b177df8cd516113d550066df6d96ea">symmetry_adapted_dof_subspace</a>.rows(), <span class="stringliteral">&quot;x&quot;</span>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">for</span> (std::string &amp;x : result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a22c55848dc64bc5c1ceddea603b7b83a">axis_glossary</a>) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    x += <a class="code" href="group___enum_i_o.html#ga7ee1b1efaa692e126299864147fcd0c0">std::to_string</a>(++i);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="class_c_a_s_m_1_1_sym_op.html">SymOp</a> <span class="keyword">const</span> &amp;op : head_group) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    result.<a class="code" href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a03af2233f0f37938e46cf92a0ab25941">symgroup_rep</a>.push_back(*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(op)));</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;}</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">  761</a></span>&#160;std::vector&lt;SymRepTools::IrrepInfo&gt; <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group, <span class="keywordtype">bool</span> allow_complex) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(_rep, head_group,</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                             <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_builder.html#a7b03a9898fd1a6f469865ce1097ba7eb">Eigen::MatrixXd::Identity</a>(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>(), _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>()),</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                             allow_complex);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a17f6037b983cb3e0a48e0b04325169dd">  770</a></span>&#160;std::vector&lt;SymRepTools::IrrepInfo&gt; <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXd&gt; <span class="keyword">const</span> &amp;_subspace, <span class="keywordtype">bool</span> allow_complex) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      _rep, head_group,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      [&amp;](Eigen::Ref&lt;const Eigen::MatrixXcd&gt; <span class="keyword">const</span> &amp;f_subspace) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">irrep_symmetrizer</a>(_rep, head_group, f_subspace, <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      },</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      _subspace, allow_complex);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">// Finds the transformation matrix that block-diagonalizes this representation</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">// into irrep blocks The ROWS of trans_mat are the new basis vectors in terms of</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">// the old such that new_symrep_matrix = trans_mat * old_symrep_matrix *</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">// trans_mat.transpose();</span></div>
<div class="line"><a name="l00787"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a06734be2e6d8a6e65a9d4dbeb9762f90">  787</a></span>&#160;std::vector&lt;SymRepTools::IrrepInfo&gt; <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a83cc0cf3653c859aba41f99f063f558c">SymRepTools::SymmetrizerFunction</a> <span class="keyword">const</span> &amp;symmetrizer_func,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> subspace, <span class="keywordtype">bool</span> allow_complex) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">if</span> (_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>() != subspace.rows()) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="stringliteral">&quot;In irrep_decomposition, subspace matrix does not have proper number &quot;</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="stringliteral">&quot;of rows (should have &quot;</span> +</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <a class="code" href="group___enum_i_o.html#ga7ee1b1efaa692e126299864147fcd0c0">std::to_string</a>(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>()) + <span class="stringliteral">&quot;, but has &quot;</span> +</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <a class="code" href="group___enum_i_o.html#ga7ee1b1efaa692e126299864147fcd0c0">std::to_string</a>(subspace.rows()));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> symspace(subspace.rows(),</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                           subspace.cols() * head_group.size());</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> l = 0;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">if</span> (!subspace.isIdentity()) {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">// Expand subpsace if it isn&#39;t already an invariant subspace</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;op : head_group) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      symspace.block(0, l, subspace.rows(), subspace.cols()) =</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          (*(_rep[op.index()]-&gt;<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>())) * subspace;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      l += subspace.cols();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    Eigen::ColPivHouseholderQR&lt;Eigen::MatrixXd&gt; qr(symspace);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    qr.setThreshold(<a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    subspace = <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a>(qr.householderQ()).leftCols(qr.rank());</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;subspace after expansion: \n&quot; &lt;&lt; subspace &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> sub_rep = <a class="code" href="namespace_c_a_s_m.html#a5561556618b8d54641a8f75a38f9b49f">coord_transformed_copy</a>(_rep, subspace.transpose());</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keyword">auto</span> subspace_symmetrizer =</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      [&amp;](<span class="keyword">const</span> Eigen::Ref&lt;const Eigen::MatrixXcd&gt; &amp;_subspace) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">irrep_symmetrizer</a>(sub_rep, head_group, _subspace, <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      };</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  std::vector&lt;SymRepTools::IrrepInfo&gt; irreps = <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      sub_rep, head_group, subspace_symmetrizer, allow_complex);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  std::vector&lt;SymRepTools::IrrepInfo&gt; result;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  result.reserve(irreps.size());</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  l = 0;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;irrep : irreps) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;irrep &quot; &lt;&lt; ++l &lt;&lt; &quot; index: &quot; &lt;&lt; irrep.index &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    result.push_back(<a class="code" href="namespace_c_a_s_m_1_1_local.html#a138e9db175825351b3913b7f6f99df7a">Local::_subspace_to_full_space</a>(irrep, subspace));</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">// Finds the transformation matrix that block-diagonalizes this representation</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">// into irrep blocks The ROWS of trans_mat are the new basis vectors in terms of</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">// the old such that new_symrep_matrix = trans_mat * old_symrep_matrix *</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">// trans_mat.transpose();</span></div>
<div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a8d9d07e004e5ef2d4c67c86bde6b6bfc">  842</a></span>&#160;std::vector&lt;SymRepTools::IrrepInfo&gt; <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a83cc0cf3653c859aba41f99f063f558c">SymRepTools::SymmetrizerFunction</a> <span class="keyword">const</span> &amp;symmetrizer_func,</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">bool</span> allow_complex) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  std::set&lt;SymRepTools::IrrepInfo, Local::IrrepCompare&gt; result{</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="struct_c_a_s_m_1_1_local_1_1_irrep_compare.html">Local::IrrepCompare</a>()};</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">if</span> (!_rep.size() || !head_group.size() || !_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[0])) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>()</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;WARNING:  In irrep_decomposition(), size of representation is &quot;</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        &lt;&lt; _rep.size() &lt;&lt; <span class="stringliteral">&quot; and MatrixXd address is &quot;</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        &lt;&lt; _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[0]) &lt;&lt; std::endl</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;          No valid irreps will be returned.\n&quot;</span>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  assert(<a class="code" href="namespace_c_a_s_m_1_1_local.html#a2eaad124c966f3f886f3f885cee7bd92">Local::_rep_check</a>(_rep, head_group, <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;         <span class="stringliteral">&quot;REPRESENTATION IS ILL-DEFINED!!&quot;</span>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordtype">int</span> dim(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>());</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  std::vector&lt;Eigen::MatrixXcd&gt; commuters;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// std::cout.precision(8);</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// std::cout.flags(std::ios::showpoint | std::ios::fixed | std::ios::right);</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespace_c_a_s_m.html#a14438ef105bddc48e0bc83073d0f2592">is_irrep</a>(_rep, head_group)) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// Identity always commutes, and by putting it first we prevent some</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// accidental degeneracies</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    commuters.push_back(<a class="code" href="namespace_c_a_s_m_1_1_sym_rep_builder.html#a7b03a9898fd1a6f469865ce1097ba7eb">Eigen::MatrixXcd::Identity</a>(dim, dim) /</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                        sqrt(<span class="keywordtype">double</span>(dim)));</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keyword">typedef</span> std::complex&lt;double&gt; cplx;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  std::vector&lt;cplx&gt; phase;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  phase.push_back(cplx(1.0, 0.0));  <span class="comment">// 1+0i</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  phase.push_back(cplx(0.0, 1.0));  <span class="comment">// 0+1i</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  Eigen::SelfAdjointEigenSolver&lt;Eigen::MatrixXcd&gt; esolve;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  Eigen::HouseholderQR&lt;Eigen::MatrixXcd&gt; qr;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  Eigen::ColPivHouseholderQR&lt;Eigen::MatrixXcd&gt; colqr;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  colqr.setThreshold(0.001);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordtype">int</span> Nfound(0);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  Eigen::MatrixXcd tmat(Eigen::MatrixXcd::Zero(dim, dim)),</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      tcommute(Eigen::MatrixXcd::Zero(dim, dim));</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  Eigen::MatrixXcd adapted_subspace(Eigen::MatrixXcd::Zero(dim, dim));</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">// Initialize kernel as a random orthogonal matrix</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  Eigen::MatrixXcd kernel(((1000 * Eigen::MatrixXcd::Random(dim, dim)) / 1000.)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                              .householderQr()</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                              .householderQ());</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  kernel.setIdentity(dim, dim);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;kernel matrix:\n&quot; &lt;&lt; kernel &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">// Build &#39;commuters&#39;, which span space of real matrices that commute with</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">// SymOpReps &#39;kernel&#39; is the kernel of adapted_subspace, and as the loop</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">// progresses, &#39;kernel&#39; shrinks and the rank of adapted_subspace increases</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> nph = 0; nph &lt; 2; nph++) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> kci = 0; kci &lt; kernel.cols(); kci++) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="keywordtype">bool</span> found_new_irreps(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> kcj = kernel.cols() - 1; kci &lt;= kcj; kcj--) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;nph: &quot; &lt;&lt; nph &lt;&lt; &quot;  kci: &quot; &lt;&lt; kci &lt;&lt; &quot;  kcj: &quot; &lt;&lt; kcj</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="comment">// &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">if</span> (kci == kcj &amp;&amp; nph &gt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        tcommute.setZero();</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;kernel imag:\n&quot; &lt;&lt; kernel.imag() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">// form commuters by taking outer product of i&#39;th column of the kernel</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="comment">// with the j&#39;th column commuters are constructed to be self-adjoint,</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">// which assures eigenvalues are real</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        tmat = phase[nph] * kernel.col(kci) *</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                   kernel.col(kcj).adjoint()  <span class="comment">// outer product</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;               + std::conj(phase[nph]) * kernel.col(kcj) *</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                     kernel.col(kci).adjoint();  <span class="comment">// adjoint of outer product</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;tmat:\n&quot; &lt;&lt; prettyc(tmat) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="comment">// apply reynolds operator</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="class_c_a_s_m_1_1_sym_op.html">SymOp</a> <span class="keyword">const</span> &amp;op : head_group) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <span class="comment">// std::cout &lt;&lt; &quot;Op &quot; &lt;&lt; op.index() &lt;&lt; &quot;:\n&quot; &lt;&lt; (*(_rep.MatrixXd(op)))</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          <span class="comment">// &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          tcommute += (*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(op))) * tmat *</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                      (*(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(op))).transpose();</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;Raw commuter: \n&quot; &lt;&lt; prettyc(tcommute) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="comment">// Do Gram-Shmidt while building &#39;commuters&#39;</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> nc = 0; nc &lt; commuters.size(); nc++) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          cplx tproj((commuters[nc].array() * tcommute.array().conjugate())</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                         .sum());  <span class="comment">// Frobenius product</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          <span class="comment">// std::cout &lt;&lt; &quot;tproj&quot; &lt;&lt; tproj &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          tcommute -= tproj * commuters[nc];</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// std::cout &lt;&lt; std::endl &lt;&lt; &quot;###&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;commuter_params: (&quot; &lt;&lt; kci &lt;&lt; &quot;, &quot; &lt;&lt; kcj &lt;&lt; &quot;, &quot;</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">//           &lt;&lt; phase[nph] &lt;&lt; &quot;) &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;commuters.size(): &quot; &lt;&lt; commuters.size() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;commuter: \n&quot; &lt;&lt; prettyc(tcommute) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordtype">double</span> tnorm(</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            (tcommute.array().conjugate() * tcommute.array()).sum().real());</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;Commuter: \n&quot; &lt;&lt; tcommute &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;norm: &quot; &lt;&lt; tnorm &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">if</span> (tnorm &gt; <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          commuters.push_back(tcommute / sqrt(tnorm));</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          <span class="keywordflow">continue</span>;  <span class="comment">// Attempt to construct the next commuter...</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">// Finished building commuter now we can try to harvest irreps from it</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="comment">// construct adapted_subspace from the non-degenerate irreps obtained</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="comment">// from the commuter</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> nc = commuters.size() - 1;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="comment">// magnify the range of eigenvalues to be (I think) independent of</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="comment">// matrix dimension by multiplying by dim^{3/2}</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        esolve.compute(<span class="keywordtype">double</span>(dim) * sqrt(<span class="keywordtype">double</span>(dim)) * kernel.adjoint() *</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                       commuters[nc] * kernel);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        std::vector&lt;Index&gt; subspace_dims =</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <a class="code" href="namespace_c_a_s_m.html#aa7f2fb63a73a30cd5d252e2073eba704">partition_distinct_values</a>(esolve.eigenvalues());</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;My big matrix: \n&quot; &lt;&lt; commuters[nc] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;My little matrix: \n&quot; &lt;&lt;</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="comment">// double(dim)*sqrt(double(dim))*kernel.adjoint()*commuters[nc]*kernel</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="comment">// &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="comment">// Columns of tmat are orthonormal eigenvectors of commuter in terms of</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="comment">// natural basis (they were calculated in terms of kernel as basis)</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="comment">// tmat = kernel/*.conjugate()*/ *</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">// (esolve.eigenvectors().householderQr().householderQ());</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        tmat = kernel * esolve.eigenvectors();</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;Raw eigenvecs: \n&quot; &lt;&lt; esolve.eigenvectors() &lt;&lt;</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment">// std::endl; std::cout &lt;&lt; &quot;Rotated eigenvecs: \n&quot; &lt;&lt; tmat &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;Eigenvec unitarity: \n&quot; &lt;&lt;</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="comment">// esolve.eigenvectors().adjoint()* esolve.eigenvectors() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;rebuild little 1:\n&quot;</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="comment">//&lt;&lt;</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="comment">// esolve.eigenvectors()*esolve.eigenvalues().asDiagonal()*esolve.eigenvectors().inverse()</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">//&lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;rebuild big 1:\n&quot;</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">//&lt;&lt;</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment">// kernel*esolve.eigenvectors()*esolve.eigenvalues().asDiagonal()*esolve.eigenvectors().inverse()*kernel.adjoint()</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="comment">//&lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;rebuild big 2:\n&quot;</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">//&lt;&lt; tmat*esolve.eigenvalues().asDiagonal()*tmat.adjoint()</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="comment">//&lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="comment">// make transformed copy of the representation</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        std::vector&lt;Eigen::MatrixXcd&gt; trans_rep(head_group.size());</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; head_group.size(); i++) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          trans_rep[i] =</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;              tmat.adjoint() * (*_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(head_group[i])) * tmat;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;Eigenvals: &quot; &lt;&lt; esolve.eigenvalues().transpose() &lt;&lt; &quot;</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">// \ndims: &quot; &lt;&lt; subspace_dims &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> last_i = 0;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> ns = 0; ns &lt; subspace_dims.size(); ns++) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;          <span class="keywordtype">double</span> sqnorm(0);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;          Eigen::VectorXcd char_vec(head_group.size());</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          <span class="comment">// &#39;ns&#39; indexes an invariant subspace</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;          <span class="comment">// Loop over group operation and calculate character vector for the</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="comment">// group representation on this invariant subspace. If the squared</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          <span class="comment">// norm of the character vector is equal to the group order, the</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          <span class="comment">// invariant subspace is also irreducible</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> ng = 0; ng &lt; trans_rep.size(); ng++) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            char_vec[ng] = cplx(0, 0);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = last_i; i &lt; last_i + subspace_dims[ns]; i++)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;              char_vec[ng] += trans_rep[ng](i, i);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="comment">// std::norm is squared norm</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            sqnorm += <a class="code" href="group___tensor.html#gafe083696121adf5c9ca773388c59019f">std::norm</a>(char_vec[ng]);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;          }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          <span class="comment">// std::cout &lt;&lt; &quot;char_vec:\n&quot; &lt;&lt; char_vec &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <span class="comment">// std::cout &lt;&lt; &quot;subspace: &quot; &lt;&lt; ns &lt;&lt; &quot;; sqnorm: &quot; &lt;&lt; sqnorm &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(sqnorm,</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                           <span class="keywordtype">double</span>(head_group.size()))) {  <span class="comment">// this representation</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                                          <span class="comment">// is irreducible</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            Eigen::MatrixXcd t_irrep_subspace;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keywordflow">if</span> (allow_complex) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;              t_irrep_subspace = tmat.block(0, last_i, dim, subspace_dims[ns]);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;              t_irrep_subspace.resize(dim, 2 * subspace_dims[ns]);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;              t_irrep_subspace.leftCols(subspace_dims[ns]) =</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                  sqrt(2.0) * tmat.block(0, last_i, dim, subspace_dims[ns])</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                  .real()</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                  .cast&lt;std::complex&lt;double&gt;&gt;();</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;              t_irrep_subspace.rightCols(subspace_dims[ns]) =</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                  sqrt(2.0) * tmat.block(0, last_i, dim, subspace_dims[ns])</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                  .imag()</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                  .cast&lt;std::complex&lt;double&gt;&gt;();</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            <span class="comment">// Only append to adapted_subspace if the new columns extend the</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            <span class="comment">// space (i.e., are orthogonal)</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>(</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                    (t_irrep_subspace.adjoint() * adapted_subspace).norm(),</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    0.001)) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;              <span class="comment">// std::cout &lt;&lt; &quot;---&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;              <span class="comment">// std::cout &lt;&lt; &quot;new irrep: &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;              <span class="comment">// std::cout &lt;&lt; &quot;characters_squared_norm: &quot; &lt;&lt; sqnorm &lt;&lt;</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;              <span class="comment">// std::endl;</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;              qr.compute(t_irrep_subspace);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;              <span class="comment">// it seems stupid to use two different decompositions that do</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;              <span class="comment">// almost the same thing, but</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;              <span class="comment">// HouseholderQR is not rank-revealing, and colPivHouseholder</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;              <span class="comment">// mixes up the columns of the Q matrix.</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;              colqr.compute(t_irrep_subspace);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;              <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> rnk = colqr.rank();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;              <span class="comment">// std::cout &lt;&lt; &quot;t_irrep_subspace with rank: &quot; &lt;&lt; rnk &lt;&lt; &quot; --\n&quot;</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;              <span class="comment">// &lt;&lt; t_irrep_subspace &lt;&lt; std::endl &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;              t_irrep_subspace =</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                  Eigen::MatrixXcd(qr.householderQ()).leftCols(rnk);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;              <span class="comment">// std::cout &lt;&lt; &quot;MatrixR: \n&quot; &lt;&lt; colqr.matrixR() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;              <span class="keyword">auto</span> symmetrizer = symmetrizer_func(t_irrep_subspace);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;              <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> t_irrep(</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                  (t_irrep_subspace * symmetrizer.first).adjoint(), char_vec);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;              t_irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a46f893b0244e203cbac0a5e9d6c18214">directions</a> = <a class="code" href="namespace_c_a_s_m_1_1_local.html#aad6b338413750f42a180b53b723b61ed">Local::_real</a>(symmetrizer.second);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;              <span class="keywordflow">if</span> (rnk == 2 * subspace_dims[ns])</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                t_irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a535886e40f07026b920b9cfa57080b63">pseudo_irrep</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                t_irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a535886e40f07026b920b9cfa57080b63">pseudo_irrep</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;              <span class="comment">// extend adapted_subspace (used to simplify next iteration)</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;              adapted_subspace.block(0, Nfound, dim, rnk) =</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                  t_irrep_subspace;  <span class="comment">// t_irrep.trans_mat.adjoint();</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;              <span class="keyword">auto</span> it = result.find(t_irrep);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;              <span class="keywordflow">if</span> (it != result.end()) {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                t_irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a175c2734544c5bcd094dabd3eb16c7ec">index</a>++;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                ++it;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;              }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;              <span class="keywordflow">while</span> (it != result.end() &amp;&amp; it-&gt;index &gt; 0) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                t_irrep.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a175c2734544c5bcd094dabd3eb16c7ec">index</a>++;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                ++it;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;              }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;              result.emplace_hint(it, std::move(t_irrep));</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;              Nfound += rnk;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;              found_new_irreps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="comment">// else {</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="comment">//   std::cout &lt;&lt; &quot;---&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="comment">//   std::cout &lt;&lt; &quot;Irrep, but does not expand space: &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="comment">//   std::cout &lt;&lt; &quot;characters_squared_norm: &quot; &lt;&lt; sqnorm &lt;&lt;</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="comment">//   std::endl;</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="comment">// }</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;          <span class="comment">// else {</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;          <span class="comment">//   std::cout &lt;&lt; &quot;---&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          <span class="comment">//   std::cout &lt;&lt; &quot;Not an irrep: &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="comment">//   std::cout &lt;&lt; &quot;characters_squared_norm: &quot; &lt;&lt; sqnorm &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          <span class="comment">// }</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          last_i += subspace_dims[ns];</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">if</span> (found_new_irreps) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          qr.compute(adapted_subspace);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;          kernel = Eigen::MatrixXcd(qr.householderQ()).rightCols(dim - Nfound);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;          kci = 0;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;          kci--;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">return</span> std::vector&lt;SymRepTools::IrrepInfo&gt;(</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      std::make_move_iterator(result.begin()),</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      std::make_move_iterator(result.end()));</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;}</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">// Finds the transformation matrix that block-diagonalizes this representation</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">// into irrep blocks The ROWS of trans_mat are the new basis vectors in terms of</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">// the old such that new_symrep_matrix = trans_mat * old_symrep_matrix *</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">// trans_mat.transpose();</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#ac31c98c0408de7fcc0c9f9458abd2ac4"> 1128</a></span>&#160;<a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> <a class="code" href="namespace_c_a_s_m.html#ac31c98c0408de7fcc0c9f9458abd2ac4">irrep_trans_mat</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep,</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                                <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a169a1e4b935291374d062af91051c83a">full_trans_mat</a>(<a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      _rep, head_group,</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      [&amp;](Eigen::Ref&lt;const Eigen::MatrixXcd&gt; <span class="keyword">const</span> &amp;_subspace) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">irrep_symmetrizer</a>(_rep, head_group, _subspace,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                 <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>);  <span class="comment">//.transpose();</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      },</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keyword">false</span>));</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;}</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a44a198ddacab2dd978f2dded2e500c30"> 1141</a></span>&#160;<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <a class="code" href="namespace_c_a_s_m.html#a44a198ddacab2dd978f2dded2e500c30">subset_permutation_rep</a>(</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;permute_rep,</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::set&lt;Index&gt;&gt; &amp;subsets) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> new_rep(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a599d2c54694d96e5c4cced30567692f5a40f01f3f45fbcbefbfc11443b558a41e">SymGroupRep::NO_HOME</a>, permute_rep.size());</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="keywordflow">if</span> (permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>())</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    new_rep = <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a>(permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a11bc05b7f5c78ad6c40bb6457d80e8f3">master_group</a>());</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  std::vector&lt;Index&gt; tperm(subsets.size());</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> np = 0; np &lt; permute_rep.size(); ++np) {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_permutation.html">Permutation</a> <span class="keyword">const</span> *perm_ptr(permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9f41f3e29f032ed470431bcd0d145794">permutation</a>(np));</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (perm_ptr == NULL) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="comment">// This check may not make sense. Some representations may not have all</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="comment">// operations.  If it&#39;s causing problems, comment it out</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>() &lt;&lt; <span class="stringliteral">&quot;CRITICAL ERROR: In &quot;</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                   <span class="stringliteral">&quot;subset_permutation_rep(SymGroupRep,std::vector&lt;Index&gt;::X2),&quot;</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                   <span class="stringliteral">&quot; permute_rep is missing at least one permutation!\n&quot;</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;                Exiting...\n&quot;</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      assert(0);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      exit(1);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_permutation.html">Permutation</a> iperm = perm_ptr-&gt;<a class="code" href="class_c_a_s_m_1_1_permutation.html#a043c3e0fed9cf931a99d88b9bd1c3efe">inverse</a>();</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> ns = 0; ns &lt; subsets.size(); ++ns) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      std::set&lt;Index&gt; perm_sub;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i : subsets[ns]) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        perm_sub.insert(iperm[i]);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> ns2;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">for</span> (ns2 = 0; ns2 &lt; subsets.size(); ++ns2) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="keywordflow">if</span> (subsets[ns] == perm_sub) {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          tperm[ns] = ns2;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordflow">if</span> (ns2 &gt;= subsets.size()) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>()</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;CRITICAL ERROR: In &quot;</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;               <span class="stringliteral">&quot;subset_permutation_rep(SymGroupRep,std::vector&lt;Index&gt;::X2), &quot;</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;               <span class="stringliteral">&quot;subsets are not closed under permute_rep permutations!\n&quot;</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;                Exiting...\n&quot;</span>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        assert(0);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        exit(1);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    new_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a599a7ca33bdbc72c36f979dd7221a41a">set_rep</a>(np, <a class="code" href="class_c_a_s_m_1_1_sym_permutation.html">SymPermutation</a>(tperm.begin(), tperm.end()));</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">return</span> new_rep;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;}</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a03a5ccc431f39c38a390f5f2707949c8"> 1194</a></span>&#160;<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <a class="code" href="namespace_c_a_s_m.html#a03a5ccc431f39c38a390f5f2707949c8">permuted_direct_sum_rep</a>(</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;permute_rep,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keyword">const</span> std::vector&lt;SymGroupRep const *&gt; &amp;sum_reps) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> new_rep(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a599d2c54694d96e5c4cced30567692f5a40f01f3f45fbcbefbfc11443b558a41e">SymGroupRep::NO_HOME</a>, permute_rep.size());</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keywordflow">if</span> (permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>())</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    new_rep = <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a>(permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a11bc05b7f5c78ad6c40bb6457d80e8f3">master_group</a>());</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  std::vector&lt;Index&gt; rep_dims(sum_reps.size(), 0);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="keywordflow">if</span> (permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9f41f3e29f032ed470431bcd0d145794">permutation</a>(0) == NULL) {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>() &lt;&lt; <span class="stringliteral">&quot;CRITICAL ERROR: In &quot;</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                 <span class="stringliteral">&quot;permuted_direct_sum_rep(SymGroupRep,std::vector&lt;SymGroupRep &quot;</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                 <span class="stringliteral">&quot;const*&gt;), permute_rep does not contain permutations!\n&quot;</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;                Exiting...\n&quot;</span>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    assert(0);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    exit(1);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; sum_reps.size(); i++) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">if</span> (sum_reps[i] == NULL) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordflow">if</span> ((permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>() != sum_reps[i]-&gt;has_valid_master()) ||</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        (permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>() &amp;&amp;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;         &amp;(permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a11bc05b7f5c78ad6c40bb6457d80e8f3">master_group</a>()) != &amp;(sum_reps[i]-&gt;master_group())) ||</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        sum_reps[i]-&gt;MatrixXd(0) == NULL) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>() &lt;&lt; <span class="stringliteral">&quot;CRITICAL ERROR: In &quot;</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                   <span class="stringliteral">&quot;permuted_direct_sum_rep(SymGroupRep,std::vector&lt;&quot;</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                   <span class="stringliteral">&quot;SymGroupRep const*&gt;), found incompatible SymGroupReps!\n&quot;</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;                Exiting...\n&quot;</span>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      assert(0);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      exit(1);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    rep_dims[i] = sum_reps[i]-&gt;dim();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  std::vector&lt;Index&gt; sum_inds(1, 0);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  std::partial_sum(rep_dims.begin(), rep_dims.end(),</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                   std::back_inserter(sum_inds));</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keyword">auto</span> tot = std::accumulate(rep_dims.begin(), rep_dims.end(), 0);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> sum_mat(tot, tot);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> <span class="keyword">const</span> *rep_mat_ptr(NULL);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <a class="code" href="class_c_a_s_m_1_1_permutation.html">Permutation</a> <span class="keyword">const</span> *perm_ptr;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> g = 0; g &lt; permute_rep.size(); g++) {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (permute_rep[g] == NULL) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    sum_mat.setZero();</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    perm_ptr = permute_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9f41f3e29f032ed470431bcd0d145794">permutation</a>(g);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> r = 0; r &lt; perm_ptr-&gt;<a class="code" href="class_c_a_s_m_1_1_permutation.html#aa2b6dd64e196a97005ba65ff47e5eedb">size</a>(); r++) {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">if</span> (rep_dims[r] == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> new_r = (*perm_ptr)[r];</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      rep_mat_ptr = sum_reps[new_r]-&gt;MatrixXd(g);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      sum_mat.block(sum_inds[r], sum_inds[new_r], rep_dims[new_r],</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                    rep_dims[new_r]) = *rep_mat_ptr;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    new_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a599a7ca33bdbc72c36f979dd7221a41a">set_rep</a>(g, <a class="code" href="class_c_a_s_m_1_1_sym_matrix_xd.html">SymMatrixXd</a>(sum_mat));</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="keywordflow">return</span> new_rep;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;}</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a7ffaf7ad87657ef14e78a7ce88eef88d"> 1256</a></span>&#160;<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <a class="code" href="namespace_c_a_s_m.html#a7ffaf7ad87657ef14e78a7ce88eef88d">kron_rep</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;LHS, <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;RHS) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="keywordflow">if</span> ((LHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>() != RHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>()) ||</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      (LHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>() &amp;&amp; &amp;LHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a11bc05b7f5c78ad6c40bb6457d80e8f3">master_group</a>() != &amp;RHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a11bc05b7f5c78ad6c40bb6457d80e8f3">master_group</a>())) {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">err_log</a>() &lt;&lt; <span class="stringliteral">&quot;CRITICAL ERROR: In kron_rep(SymGroupRep,SymGroupRep), taking &quot;</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                 <span class="stringliteral">&quot;product of two incompatible SymGroupReps!\n&quot;</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;                Exiting...\n&quot;</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    exit(1);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> new_rep(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a599d2c54694d96e5c4cced30567692f5a40f01f3f45fbcbefbfc11443b558a41e">SymGroupRep::NO_HOME</a>, LHS.size());</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keywordflow">if</span> (LHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">has_valid_master</a>()) new_rep = <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a>(LHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a11bc05b7f5c78ad6c40bb6457d80e8f3">master_group</a>());</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> tmat;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; LHS.size(); i++) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;rep1 matrix:\n&quot;;</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">// std::cout &lt;&lt; *(rep1-&gt;MatrixXd(i)) &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;rep2 matrix:\n&quot;;</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="comment">// std::cout &lt;&lt; *(rep2-&gt;MatrixXd(i)) &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    assert(LHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(i) &amp;&amp; RHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(i));</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    kroneckerProduct(*(LHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(i)), *(RHS.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(i)), tmat);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Total matrix:\n&quot; &lt;&lt; tmat &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    new_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a599a7ca33bdbc72c36f979dd7221a41a">set_rep</a>(i, <a class="code" href="class_c_a_s_m_1_1_sym_matrix_xd.html">SymMatrixXd</a>(tmat));</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keywordflow">return</span> new_rep;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;}</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="keyword">namespace </span>SymRepTools {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; </div>
<div class="line"><a name="l01283"></a><span class="lineno"><a class="line" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#a5ca4f0a4270424f5ed66293eea4fdcce"> 1283</a></span>&#160;<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">IrrepWedge</a> <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#a5ca4f0a4270424f5ed66293eea4fdcce">IrrepWedge::make_dummy</a>(<span class="keyword">const</span> <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> &amp;axes) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">IrrepWedge</a> irrep_wedge(<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#aeb2a3f906d1ef2372eb132075e11953e">IrrepInfo::make_dummy</a>(<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#abf431d7ac038b60ff42471901cbba92f">axes</a>), <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#abf431d7ac038b60ff42471901cbba92f">axes</a>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  irrep_wedge.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#aeffcb1214a9fbce33c9a0ece5cc9306c">mult</a>.reserve(<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#abf431d7ac038b60ff42471901cbba92f">axes</a>.cols());</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#abf431d7ac038b60ff42471901cbba92f">axes</a>.cols(); ++i) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    irrep_wedge.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#aeffcb1214a9fbce33c9a0ece5cc9306c">mult</a>.push_back(1);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="keywordflow">return</span> irrep_wedge;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;}</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a51225e470ff790a43d2193805189577d"> 1292</a></span>&#160;<a class="code" href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html">SubWedge</a> <a class="code" href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a51225e470ff790a43d2193805189577d">SubWedge::make_dummy</a>(<span class="keyword">const</span> <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> &amp;axes) {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a5c10cac827069fed7c93e3ad1a4107a5">SubWedge</a>({<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#a5ca4f0a4270424f5ed66293eea4fdcce">IrrepWedge::make_dummy</a>(axes)});</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;}</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a049dd29ecb7ec22815413be94bf0664f"> 1296</a></span>&#160;<a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> <a class="code" href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a049dd29ecb7ec22815413be94bf0664f">SubWedge::_subwedge_to_trans_mat</a>(</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    std::vector&lt;IrrepWedge&gt; <span class="keyword">const</span> &amp;_iwedges) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">if</span> (_iwedges.empty()) <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a>();</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">Eigen::MatrixXd</a> result(_iwedges[0].axes.rows(), _iwedges[0].axes.rows());</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> w = 0; w &lt; _iwedges.size(); ++w) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    result.block(0, i, _iwedges[w].axes.rows(), _iwedges[w].axes.cols()) =</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        _iwedges[w].axes;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    i += _iwedges[w].axes.cols();</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">if</span> (i &lt; result.cols()) result.conservativeResize(Eigen::NoChange, i);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;}</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a38cd842032c7a184a27d2e762099f579"> 1312</a></span>&#160;std::vector&lt;IrrepWedge&gt; <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a38cd842032c7a184a27d2e762099f579">irrep_wedges</a>(</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group, <a class="code" href="class_c_a_s_m_1_1_sym_group_rep_i_d.html">SymGroupRepID</a> <span class="keywordtype">id</span>,</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXd&gt; <span class="keyword">const</span> &amp;_subspace) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a38cd842032c7a184a27d2e762099f579">irrep_wedges</a>(head_group.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#ac062ae038713839bafe73fa154b4ad70">master_group</a>().<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#a9e4871e42819f5e34427319fdbb3fa7e">representation</a>(<span class="keywordtype">id</span>), head_group,</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                      _subspace);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;}</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a541761ffc609da7b174a74a676336e78"> 1321</a></span>&#160;std::vector&lt;IrrepWedge&gt; <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a38cd842032c7a184a27d2e762099f579">irrep_wedges</a>(</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXd&gt; <span class="keyword">const</span> &amp;_subspace) {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  std::vector&lt;SymRepTools::IrrepInfo&gt; irreps =</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">irrep_decomposition</a>(_rep, head_group, _subspace, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  std::vector&lt;IrrepWedge&gt; wedges;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  wedges.reserve(irreps.size());</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordtype">double</span> best_proj, tproj;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;subspace: \n&quot; &lt;&lt; _subspace &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;irrep decomposition size: &quot; &lt;&lt; irreps.size() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">SymRepTools::IrrepInfo</a> <span class="keyword">const</span> &amp;irrep : irreps) {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">// 1D irreps directions can have positive and negative directions, but we</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// only want to include one. only 1D irreps can have singly-degenerate</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">// directions and two singly-degenerate directions indicate the same vector</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="comment">// duplicated in positive and negative direction (because they are not</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="comment">// equivalent by symmetry) If irrep.directions[0] is singly degenerate</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="comment">// (orbits size == 1) then irrepdim is 1 and we only need one direction to</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="comment">// define wedge</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    wedges.emplace_back(</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        irrep, Eigen::MatrixXd::Zero(irrep.vector_dim(), irrep.irrep_dim()));</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Irrep characters: \n&quot; &lt;&lt; irrep.characters &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Irrep directions: &quot; &lt;&lt; irrep.directions.size() &lt;&lt;</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">// std::endl;</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">if</span> (irrep.directions.empty()) {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      wedges.back() = <a class="code" href="namespace_c_a_s_m_1_1_local.html#a1db9e1f3ad6bda87618083a07637984f">Local::_wedge_from_pseudo_irrep</a>(irrep, _rep, head_group);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Irrep direction orbit&quot; &lt;&lt; 0 &lt;&lt; &quot; : &quot; &lt;&lt;</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">// irrep.directions[0].size() &lt;&lt; std::endl; std::cout &lt;&lt; &quot;Irrep direction: &quot;</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">// &lt;&lt; irrep.directions[0][0].transpose() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    wedges.back().axes.col(0) = irrep.directions[0][0];</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    wedges.back().mult.push_back(irrep.directions[0].size());</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 1; i &lt; irrep.irrep_dim(); i++) {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="comment">// std::cout &lt;&lt; &quot;Irrep direction orbit&quot; &lt;&lt; i &lt;&lt; &quot; : &quot; &lt;&lt;</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="comment">// irrep.directions[i].size() &lt;&lt; std::endl; std::cout &lt;&lt; &quot;Irrep direction:</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="comment">// &quot; &lt;&lt; irrep.directions[i][0].transpose() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> j_best = 0;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      best_proj =</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;          (wedges.back().axes.transpose() * irrep.directions[i][0]).<a class="code" href="namespace_c_a_s_m.html#a85c0e41be877c6726fe49f58506e1e50">sum</a>();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> j = 1; j &lt; irrep.directions[i].size(); j++) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        tproj = (wedges.back().axes.transpose() * irrep.directions[i][j]).<a class="code" href="namespace_c_a_s_m.html#a85c0e41be877c6726fe49f58506e1e50">sum</a>();</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">if</span> (tproj &gt; best_proj) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          best_proj = tproj;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;          j_best = j;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      wedges.back().axes.col(i) = irrep.directions[i][j_best];</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      wedges.back().mult.push_back(irrep.directions[i].size());</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;New irrep wedge: \n&quot; &lt;&lt; wedges.back().axes.transpose() &lt;&lt;</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="comment">// std::endl;</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="keywordflow">return</span> wedges;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;}</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f"> 1382</a></span>&#160;std::vector&lt;SubWedge&gt; <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">symrep_subwedges</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                       <a class="code" href="class_c_a_s_m_1_1_sym_group_rep_i_d.html">SymGroupRepID</a> <span class="keywordtype">id</span>) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">symrep_subwedges</a>(head_group.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#ac062ae038713839bafe73fa154b4ad70">master_group</a>().<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#a9e4871e42819f5e34427319fdbb3fa7e">representation</a>(<span class="keywordtype">id</span>),</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                          head_group);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;}</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#aba2fce2241d7ed2fc3cd2f702670d24f"> 1390</a></span>&#160;std::vector&lt;SubWedge&gt; <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">symrep_subwedges</a>(</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group, <a class="code" href="class_c_a_s_m_1_1_sym_group_rep_i_d.html">SymGroupRepID</a> <span class="keywordtype">id</span>,</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXd&gt; <span class="keyword">const</span> &amp;_subspace) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">symrep_subwedges</a>(head_group.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#ac062ae038713839bafe73fa154b4ad70">master_group</a>().<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#a9e4871e42819f5e34427319fdbb3fa7e">representation</a>(<span class="keywordtype">id</span>),</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                          head_group, _subspace);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;}</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a6b920a1f7bc79f0f3ca528bafa6b3980"> 1399</a></span>&#160;std::vector&lt;SubWedge&gt; <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">symrep_subwedges</a>(<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep,</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                                       <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group) {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">symrep_subwedges</a>(_rep, head_group,</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                          <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_builder.html#a7b03a9898fd1a6f469865ce1097ba7eb">Eigen::MatrixXd::Identity</a>(_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>(), _rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">dim</a>()));</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a97696ca1fa645292981bd752975a092e"> 1406</a></span>&#160;std::vector&lt;SubWedge&gt; <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">symrep_subwedges</a>(</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> &amp;_rep, <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> <span class="keyword">const</span> &amp;head_group,</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    Eigen::Ref&lt;const Eigen::MatrixXd&gt; <span class="keyword">const</span> &amp;_subspace) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keyword">auto</span> irrep_wedge_compare = [](<span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">IrrepWedge</a> &amp;a,</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                <span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">IrrepWedge</a> &amp;b) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_eigen.html#a353cdc8dd6f05043eb445122a8923fdd">Eigen::almost_equal</a>(a.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#abf431d7ac038b60ff42471901cbba92f">axes</a>, b.axes);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  };</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="keyword">auto</span> tot_wedge_compare = [irrep_wedge_compare](</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                               <span class="keyword">const</span> std::vector&lt;IrrepWedge&gt; &amp;a,</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                               <span class="keyword">const</span> std::vector&lt;IrrepWedge&gt; &amp;b) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span> (a.size() != b.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> ita = a.begin(), itb = b.begin(); ita != a.end(); ++ita, ++itb)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keywordflow">if</span> (!irrep_wedge_compare(*ita, *itb)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Equal: \n&quot; &lt;&lt; SubWedge(a).trans_mat() &lt;&lt; &quot;,\n&quot; &lt;&lt;</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">// SubWedge(b).trans_mat() &lt;&lt; &quot;\n\n&quot;;</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  };</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="keywordflow">if</span> (!_rep.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>(0))</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="stringliteral">&quot;In symrep_subwedges, SymGroupRep does not describe matrix &quot;</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="stringliteral">&quot;representation&quot;</span>);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160; </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  std::vector&lt;IrrepWedge&gt; init_wedges =</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <a class="code" href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a38cd842032c7a184a27d2e762099f579">irrep_wedges</a>(_rep, head_group, _subspace);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  std::vector&lt;SubWedge&gt; result;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="comment">// irrep_wedge_orbits[w] is orbit of wedges[w]</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;IrrepWedge&gt;::X</a>&lt;2&gt; irrep_wedge_orbits;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  irrep_wedge_orbits.reserve(init_wedges.size());</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="comment">// max_equiv[w] is irrep_wedge_orbits[w].size()-1</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  std::vector&lt;Index&gt; max_equiv;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  max_equiv.reserve(init_wedges.size());</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;irreducible wedges for group of order &quot; &lt;&lt; head_group.size()</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="comment">// &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> imax = 0;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1multivector.html">multivector&lt;Index&gt;::X</a>&lt;2&gt; subgroups;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">IrrepWedge</a> <span class="keyword">const</span> &amp;wedge : init_wedges) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;Working wedge with axes: \n&quot; &lt;&lt; wedge.axes.transpose() &lt;&lt;</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">// std::endl;</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    irrep_wedge_orbits.push_back({wedge});</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">// Start getting orbit of wedges[w]</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    subgroups.push_back({});</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="class_c_a_s_m_1_1_sym_op.html">SymOp</a> <span class="keyword">const</span> &amp;op : head_group) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      <a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">IrrepWedge</a> test_wedge{wedge};</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      test_wedge.<a class="code" href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#abf431d7ac038b60ff42471901cbba92f">axes</a> = (*(_rep[op.index()]-&gt;<a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">MatrixXd</a>())) * wedge.axes;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> o = 0;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keywordflow">for</span> (; o &lt; irrep_wedge_orbits.back().size(); ++o) {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="keywordflow">if</span> (irrep_wedge_compare(irrep_wedge_orbits.back()[o], test_wedge)) {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          <span class="keywordflow">if</span> (o == 0) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            subgroups.back().push_back(op.index());</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;          }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">if</span> (o &lt; irrep_wedge_orbits.back().size()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      irrep_wedge_orbits.back().push_back(test_wedge);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;wedge mult: &quot; &lt;&lt; irrep_wedge_orbits.back().size();</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;; subgroups[&quot; &lt;&lt; subgroups.size() &lt;&lt; &quot;]: &quot; &lt;&lt;</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// subgroups.back() &lt;&lt; std::endl; std::cout &lt;&lt; &quot;N equiv wedges found: &quot; &lt;&lt;</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// irrep_wedge_orbits.back().size() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    max_equiv.push_back(irrep_wedge_orbits.back().size() - 1);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span> (max_equiv.back() &gt; max_equiv[imax]) imax = max_equiv.size() - 1;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  max_equiv[imax] = 0;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">// Counter over combinations of equivalent wedges</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <a class="code" href="class_c_a_s_m_1_1_counter.html">Counter&lt;std::vector&lt;Index&gt;</a>&gt; wcount(std::vector&lt;Index&gt;(init_wedges.size(), 0),</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                     max_equiv,</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                     std::vector&lt;Index&gt;(init_wedges.size(), 1));</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;max_equiv: &quot; &lt;&lt; max_equiv &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;init wcount: &quot; &lt;&lt; wcount() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <a class="code" href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">multivector&lt;IrrepWedge&gt;::X</a>&lt;3&gt; tot_wedge_orbits;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;Starting slow bit!\n&quot;;</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="keywordflow">for</span> (; wcount; ++wcount) {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    std::vector&lt;IrrepWedge&gt; twedge = init_wedges;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; init_wedges.size(); i++)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      twedge[i].axes = irrep_wedge_orbits[i][wcount[i]].axes;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#addb972858a65c116ca50bb19d9946a45">contains_if</a>(</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            tot_wedge_orbits,</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            [tot_wedge_compare, &amp;twedge](</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                <span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1multivector.html">multivector&lt;IrrepWedge&gt;::X&lt;2&gt;</a> &amp;wedge_orbit) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#abaf3dc70b7ec68e71a693d80f3b99fca">contains</a>(wedge_orbit, twedge, tot_wedge_compare);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            }))</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    tot_wedge_orbits.push_back({twedge});</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    result.emplace_back(twedge);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> p : subgroups[imax]) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; twedge.size(); i++)</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        twedge[i].axes =</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            (*(_rep[p]-&gt;<a class="code" href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">MatrixXd</a>())) * result.back().irrep_wedges()[i].axes;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespace_c_a_s_m.html#abaf3dc70b7ec68e71a693d80f3b99fca">contains</a>(tot_wedge_orbits.back(), twedge, tot_wedge_compare)) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        tot_wedge_orbits.back().push_back(twedge);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;Num subwedges: &quot; &lt;&lt; result.size() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;}  <span class="comment">// namespace SymRepTools</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;}  <span class="comment">// namespace CASM</span></div>
<div class="ttc" id="a_c_a_s_m___eigen__math_8hh_html"><div class="ttname"><a href="_c_a_s_m___eigen__math_8hh.html">CASM_Eigen_math.hh</a></div></div>
<div class="ttc" id="a_c_a_s_m__math_8hh_html"><div class="ttname"><a href="_c_a_s_m__math_8hh.html">CASM_math.hh</a></div></div>
<div class="ttc" id="a_counter_8hh_html"><div class="ttname"><a href="_counter_8hh.html">Counter.hh</a></div></div>
<div class="ttc" id="a_log_8hh_html"><div class="ttname"><a href="_log_8hh.html">Log.hh</a></div></div>
<div class="ttc" id="a_orbit__impl_8hh_html"><div class="ttname"><a href="_orbit__impl_8hh.html">Orbit_impl.hh</a></div></div>
<div class="ttc" id="a_sym_group_8hh_html"><div class="ttname"><a href="_sym_group_8hh.html">SymGroup.hh</a></div></div>
<div class="ttc" id="a_sym_group_rep_8hh_html"><div class="ttname"><a href="_sym_group_rep_8hh.html">SymGroupRep.hh</a></div></div>
<div class="ttc" id="a_sym_matrix_xd_8hh_html"><div class="ttname"><a href="_sym_matrix_xd_8hh.html">SymMatrixXd.hh</a></div></div>
<div class="ttc" id="a_sym_permutation_8hh_html"><div class="ttname"><a href="_sym_permutation_8hh.html">SymPermutation.hh</a></div></div>
<div class="ttc" id="a_sym_rep_tools_8hh_html"><div class="ttname"><a href="_sym_rep_tools_8hh.html">SymRepTools.hh</a></div></div>
<div class="ttc" id="a_vector_sym_compare__impl_8hh_html"><div class="ttname"><a href="_vector_sym_compare__impl_8hh.html">VectorSymCompare_impl.hh</a></div></div>
<div class="ttc" id="acasm__io_2container_2stream__io_8hh_html"><div class="ttname"><a href="casm__io_2container_2stream__io_8hh.html">stream_io.hh</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_counter_html"><div class="ttname"><a href="class_c_a_s_m_1_1_counter.html">CASM::Counter</a></div><div class="ttdoc">A Counter allows looping over many incrementing variables in one loop.</div><div class="ttdef"><b>Definition:</b> <a href="_counter_8hh_source.html#l00107">Counter.hh:109</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_direction_sym_compare_html"><div class="ttname"><a href="class_c_a_s_m_1_1_direction_sym_compare.html">CASM::DirectionSymCompare</a></div><div class="ttdef"><b>Definition:</b> <a href="_vector_sym_compare_8hh_source.html#l00163">VectorSymCompare.hh:165</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_master_sym_group_html_a9e4871e42819f5e34427319fdbb3fa7e"><div class="ttname"><a href="class_c_a_s_m_1_1_master_sym_group.html#a9e4871e42819f5e34427319fdbb3fa7e">CASM::MasterSymGroup::representation</a></div><div class="ttdeci">SymGroupRep const  &amp; representation(SymGroupRepID i) const</div><div class="ttdoc">Const access of alternate Representations of a SymGroup.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l00717">SymGroup.cc:717</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_orbit_html"><div class="ttname"><a href="class_c_a_s_m_1_1_orbit.html">CASM::Orbit</a></div><div class="ttdoc">An Orbit of Element.</div><div class="ttdef"><b>Definition:</b> <a href="_orbit_8hh_source.html#l00043">Orbit.hh:43</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_permutation_html"><div class="ttname"><a href="class_c_a_s_m_1_1_permutation.html">CASM::Permutation</a></div><div class="ttdef"><b>Definition:</b> <a href="_permutation_8hh_source.html#l00040">Permutation.hh:40</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_permutation_html_a043c3e0fed9cf931a99d88b9bd1c3efe"><div class="ttname"><a href="class_c_a_s_m_1_1_permutation.html#a043c3e0fed9cf931a99d88b9bd1c3efe">CASM::Permutation::inverse</a></div><div class="ttdeci">Permutation inverse() const</div><div class="ttdoc">Construct permutation that undoes the permutation performed by 'this'.</div><div class="ttdef"><b>Definition:</b> <a href="_permutation_8cc_source.html#l00111">Permutation.cc:111</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_permutation_html_aa2b6dd64e196a97005ba65ff47e5eedb"><div class="ttname"><a href="class_c_a_s_m_1_1_permutation.html#aa2b6dd64e196a97005ba65ff47e5eedb">CASM::Permutation::size</a></div><div class="ttdeci">Index size() const</div><div class="ttdef"><b>Definition:</b> <a href="_permutation_8hh_source.html#l00060">Permutation.hh:60</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html">CASM::SymGroup</a></div><div class="ttdoc">SymGroup is a collection of symmetry operations that satisfy the group property The symmetry operatio...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8hh_source.html#l00042">SymGroup.hh:42</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_html_a20a9e1d2ba4873d95f09ac3e3cf2ad9a"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html#a20a9e1d2ba4873d95f09ac3e3cf2ad9a">CASM::SymGroup::subgroups</a></div><div class="ttdeci">const std::vector&lt; std::set&lt; std::set&lt; Index &gt; &gt; &gt; &amp; subgroups() const</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l01695">SymGroup.cc:1695</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_html_a7f1f41f1f5c4951e2029324e4ff31a1c"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html#a7f1f41f1f5c4951e2029324e4ff31a1c">CASM::SymGroup::small_subgroups</a></div><div class="ttdeci">std::vector&lt; std::set&lt; std::set&lt; Index &gt; &gt; &gt; small_subgroups() const</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8hh_source.html#l00206">SymGroup.hh:206</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_html_a82dc91ea37a33372c1651187bc69fcd3"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html#a82dc91ea37a33372c1651187bc69fcd3">CASM::SymGroup::ind_prod</a></div><div class="ttdeci">Index ind_prod(Index i, Index j) const</div><div class="ttdoc">Get index of operation that is result of multiplication of at(i)*at(j)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l01550">SymGroup.cc:1550</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_html_ac062ae038713839bafe73fa154b4ad70"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html#ac062ae038713839bafe73fa154b4ad70">CASM::SymGroup::master_group</a></div><div class="ttdeci">const MasterSymGroup &amp; master_group() const</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8hh_source.html#l00073">SymGroup.hh:73</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html">CASM::SymGroupRep</a></div><div class="ttdoc">SymGroupRep is an alternative representation of a SymGroup for something other than real space....</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8hh_source.html#l00031">SymGroupRep.hh:31</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html_a11bc05b7f5c78ad6c40bb6457d80e8f3"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html#a11bc05b7f5c78ad6c40bb6457d80e8f3">CASM::SymGroupRep::master_group</a></div><div class="ttdeci">const MasterSymGroup &amp; master_group() const</div><div class="ttdoc">Reference to MasterSymGroup for which this SymGroupRep is a group representation If a MasterSymGroup ...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8hh_source.html#l00076">SymGroupRep.hh:76</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html_a599a7ca33bdbc72c36f979dd7221a41a"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html#a599a7ca33bdbc72c36f979dd7221a41a">CASM::SymGroupRep::set_rep</a></div><div class="ttdeci">void set_rep(Index op_index, const SymOpRepresentation &amp;new_rep)</div><div class="ttdoc">Sets the representation of operation at entry 'op_index' of this group representation Throws if this ...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8cc_source.html#l00114">SymGroupRep.cc:114</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html_a599d2c54694d96e5c4cced30567692f5a40f01f3f45fbcbefbfc11443b558a41e"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html#a599d2c54694d96e5c4cced30567692f5a40f01f3f45fbcbefbfc11443b558a41e">CASM::SymGroupRep::NO_HOME</a></div><div class="ttdeci">@ NO_HOME</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8hh_source.html#l00039">SymGroupRep.hh:39</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html_a84a767d09b5d09ccdab15e4f6e18049c"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html#a84a767d09b5d09ccdab15e4f6e18049c">CASM::SymGroupRep::has_valid_master</a></div><div class="ttdeci">bool has_valid_master() const</div><div class="ttdoc">Returns true if this SymGroupRep has valid pointer to a MasterSymGroup.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8hh_source.html#l00086">SymGroupRep.hh:86</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html_a9cacca2e8cbb68b16062c3256d7d9003"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html#a9cacca2e8cbb68b16062c3256d7d9003">CASM::SymGroupRep::MatrixXd</a></div><div class="ttdeci">Eigen::MatrixXd const  * MatrixXd(Index i) const</div><div class="ttdoc">pointer to MatrixXd corresponding to SymOpRepresentation at entry 'i' of this SymGroupRep Returns nul...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8cc_source.html#l00144">SymGroupRep.cc:144</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html_a9f41f3e29f032ed470431bcd0d145794"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html#a9f41f3e29f032ed470431bcd0d145794">CASM::SymGroupRep::permutation</a></div><div class="ttdeci">Permutation const  * permutation(Index i) const</div><div class="ttdoc">pointer to Permutation corresponding to SymOpRepresentation at entry 'i' of this SymGroupRep Returns ...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8cc_source.html#l00157">SymGroupRep.cc:157</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_html_af2ad7f23c90e8a96933bb45ef34a220a"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html#af2ad7f23c90e8a96933bb45ef34a220a">CASM::SymGroupRep::dim</a></div><div class="ttdeci">Index dim() const</div><div class="ttdoc">Matrix dimension of representation.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8hh_source.html#l00082">SymGroupRep.hh:82</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_group_rep_i_d_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep_i_d.html">CASM::SymGroupRepID</a></div><div class="ttdoc">Type-safe ID object for communicating and accessing Symmetry representation info.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_i_d_8hh_source.html#l00025">SymGroupRepID.hh:25</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_matrix_xd_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_matrix_xd.html">CASM::SymMatrixXd</a></div><div class="ttdoc">Generalized symmetry matrix representation for arbitrary dimension Can be used to describe applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_matrix_xd_8hh_source.html#l00026">SymMatrixXd.hh:26</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_op_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_op.html">CASM::SymOp</a></div><div class="ttdoc">SymOp is the Coordinate representation of a symmetry operation it keeps fraction (FRAC) and Cartesian...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_op_8hh_source.html#l00028">SymOp.hh:28</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_permutation_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_permutation.html">CASM::SymPermutation</a></div><div class="ttdoc">SymPermutation describes how a symmetry operation permutes a list of 'things' For example,...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_permutation_8hh_source.html#l00026">SymPermutation.hh:26</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html">CASM::SymRepTools::SubWedge</a></div><div class="ttdoc">SubWedge is a vector of IrrepWedge, one from each irreducible subspace Together, the IrrepWedges that...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00108">SymRepTools.hh:108</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge_html_a049dd29ecb7ec22815413be94bf0664f"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a049dd29ecb7ec22815413be94bf0664f">CASM::SymRepTools::SubWedge::_subwedge_to_trans_mat</a></div><div class="ttdeci">static Eigen::MatrixXd _subwedge_to_trans_mat(std::vector&lt; IrrepWedge &gt; const &amp;_iwedges)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01296">SymRepTools.cc:1296</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge_html_a51225e470ff790a43d2193805189577d"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a51225e470ff790a43d2193805189577d">CASM::SymRepTools::SubWedge::make_dummy</a></div><div class="ttdeci">static SubWedge make_dummy(Eigen::MatrixXd const &amp;axes)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01292">SymRepTools.cc:1292</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge_html_a5c10cac827069fed7c93e3ad1a4107a5"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_rep_tools_1_1_sub_wedge.html#a5c10cac827069fed7c93e3ad1a4107a5">CASM::SymRepTools::SubWedge::SubWedge</a></div><div class="ttdeci">SubWedge(std::vector&lt; IrrepWedge &gt; const &amp;_iwedges)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00110">SymRepTools.hh:110</a></div></div>
<div class="ttc" id="agroup___enum_i_o_html_ga7ee1b1efaa692e126299864147fcd0c0"><div class="ttname"><a href="group___enum_i_o.html#ga7ee1b1efaa692e126299864147fcd0c0">CASM::to_string</a></div><div class="ttdeci">std::string to_string(ENUM val)</div><div class="ttdoc">Return string representation of enum class.</div><div class="ttdef"><b>Definition:</b> <a href="casm__io_2enum_2io__traits_8hh_source.html#l00172">io_traits.hh:172</a></div></div>
<div class="ttc" id="agroup___linear_algebra_html_ga1712e24d5ef8f3b419e52256025aa675"><div class="ttname"><a href="group___linear_algebra.html#ga1712e24d5ef8f3b419e52256025aa675">CASM::pretty</a></div><div class="ttdeci">Eigen::MatrixXd pretty(const Eigen::MatrixXd &amp;M, double tol)</div><div class="ttdoc">Round entries that are within tol of being integer to that integer value.</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8cc_source.html#l00629">CASM_Eigen_math.cc:629</a></div></div>
<div class="ttc" id="agroup___linear_algebra_html_ga8f2e443ab100f75d5ac872706f0ced0e"><div class="ttname"><a href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">CASM::round</a></div><div class="ttdeci">Eigen::CwiseUnaryOp&lt; decltype(Local::round_l&lt; typename Derived::Scalar &gt;), const Derived &gt; round(const Eigen::MatrixBase&lt; Derived &gt; &amp;val)</div><div class="ttdoc">Round Eigen::MatrixXd.</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8hh_source.html#l00202">CASM_Eigen_math.hh:202</a></div></div>
<div class="ttc" id="agroup___tensor_html_gafe083696121adf5c9ca773388c59019f"><div class="ttname"><a href="group___tensor.html#gafe083696121adf5c9ca773388c59019f">CASM::norm</a></div><div class="ttdeci">T norm(const Tensor&lt; T &gt; &amp;ttens)</div><div class="ttdef"><b>Definition:</b> <a href="_tensor_8hh_source.html#l00932">Tensor.hh:932</a></div></div>
<div class="ttc" id="amisc_2algorithm_8hh_html"><div class="ttname"><a href="misc_2algorithm_8hh.html">algorithm.hh</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_local_html_a138e9db175825351b3913b7f6f99df7a"><div class="ttname"><a href="namespace_c_a_s_m_1_1_local.html#a138e9db175825351b3913b7f6f99df7a">CASM::Local::_subspace_to_full_space</a></div><div class="ttdeci">SymRepTools::IrrepInfo _subspace_to_full_space(SymRepTools::IrrepInfo const &amp;irrep, Eigen::MatrixBase&lt; T &gt; const &amp;subspace)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00368">SymRepTools.cc:368</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_local_html_a1db9e1f3ad6bda87618083a07637984f"><div class="ttname"><a href="namespace_c_a_s_m_1_1_local.html#a1db9e1f3ad6bda87618083a07637984f">CASM::Local::_wedge_from_pseudo_irrep</a></div><div class="ttdeci">static SymRepTools::IrrepWedge _wedge_from_pseudo_irrep(SymRepTools::IrrepInfo const &amp;irrep, SymGroupRep const &amp;_rep, SymGroup const &amp;head_group)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00287">SymRepTools.cc:287</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_local_html_a2eaad124c966f3f886f3f885cee7bd92"><div class="ttname"><a href="namespace_c_a_s_m_1_1_local.html#a2eaad124c966f3f886f3f885cee7bd92">CASM::Local::_rep_check</a></div><div class="ttdeci">bool _rep_check(SymGroupRep const &amp;_rep, SymGroup const &amp;head_group, bool verbose)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00327">SymRepTools.cc:327</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_local_html_a43878c3acaba35209db62ba5bf80cce4"><div class="ttname"><a href="namespace_c_a_s_m_1_1_local.html#a43878c3acaba35209db62ba5bf80cce4">CASM::Local::_block_shape_matrix</a></div><div class="ttdeci">static Eigen::MatrixXd _block_shape_matrix(SymGroupRep const &amp;_rep, SymGroup const &amp;head_group)</div><div class="ttdoc">Matrix such that result(i,j) is sum of squares over 'p' of op_rep[p].matrix(i,j). 'p' only spans oper...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00146">SymRepTools.cc:146</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_local_html_a7107b8aa69050f38129e9ac44e71bf58"><div class="ttname"><a href="namespace_c_a_s_m_1_1_local.html#a7107b8aa69050f38129e9ac44e71bf58">CASM::Local::_irrep_symmetrizer_from_directions</a></div><div class="ttdeci">static Eigen::MatrixXcd _irrep_symmetrizer_from_directions(multivector&lt; Eigen::VectorXcd &gt;::X&lt; 2 &gt; const &amp;special_directions, Eigen::Ref&lt; const Eigen::MatrixXcd &gt; const &amp;_subspace, double vec_compare_tol)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00166">SymRepTools.cc:166</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_local_html_a9c3cddd8d2565c83b441e7ad545c4a85"><div class="ttname"><a href="namespace_c_a_s_m_1_1_local.html#a9c3cddd8d2565c83b441e7ad545c4a85">CASM::Local::_Real</a></div><div class="ttdeci">typename _RealType&lt; T &gt;::Type _Real</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00113">SymRepTools.cc:113</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_local_html_aad6b338413750f42a180b53b723b61ed"><div class="ttname"><a href="namespace_c_a_s_m_1_1_local.html#aad6b338413750f42a180b53b723b61ed">CASM::Local::_real</a></div><div class="ttdeci">_Real&lt; Derived &gt; _real(Eigen::MatrixBase&lt; Derived &gt; const &amp;mat)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00126">SymRepTools.cc:126</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_sym_rep_builder_html_a7b03a9898fd1a6f469865ce1097ba7eb"><div class="ttname"><a href="namespace_c_a_s_m_1_1_sym_rep_builder.html#a7b03a9898fd1a6f469865ce1097ba7eb">CASM::SymRepBuilder::Identity</a></div><div class="ttdeci">IdentitySymRepBuilder Identity()</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_builder_8hh_source.html#l00351">SymRepBuilder.hh:351</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_sym_rep_tools__v2_1_1_irrep_decomposition_impl_html_a34fe6112ec6265c700b785f6935c6d46"><div class="ttname"><a href="namespace_c_a_s_m_1_1_sym_rep_tools__v2_1_1_irrep_decomposition_impl.html#a34fe6112ec6265c700b785f6935c6d46">CASM::SymRepTools_v2::IrrepDecompositionImpl::prettyc</a></div><div class="ttdeci">Eigen::MatrixXcd prettyc(const Eigen::MatrixXcd &amp;M)</div><div class="ttdoc">Round entries that are within tol of being integer to that integer value.</div><div class="ttdef"><b>Definition:</b> <a href="_irrep_decomposition_impl_8cc_source.html#l00018">IrrepDecompositionImpl.cc:18</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_sym_rep_tools_html_a0c8815ad6af327131002e99bf03cb7d9"><div class="ttname"><a href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a0c8815ad6af327131002e99bf03cb7d9">CASM::SymRepTools::Symmetrizer</a></div><div class="ttdeci">std::pair&lt; Eigen::MatrixXcd, multivector&lt; Eigen::VectorXcd &gt;::X&lt; 2 &gt; &gt; Symmetrizer</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00020">SymRepTools.hh:21</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_sym_rep_tools_html_a38cd842032c7a184a27d2e762099f579"><div class="ttname"><a href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a38cd842032c7a184a27d2e762099f579">CASM::SymRepTools::irrep_wedges</a></div><div class="ttdeci">std::vector&lt; IrrepWedge &gt; irrep_wedges(SymGroup const &amp;head_group, SymGroupRepID id, Eigen::Ref&lt; const Eigen::MatrixXd &gt; const &amp;_subspace)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01312">SymRepTools.cc:1312</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_sym_rep_tools_html_a83cc0cf3653c859aba41f99f063f558c"><div class="ttname"><a href="namespace_c_a_s_m_1_1_sym_rep_tools.html#a83cc0cf3653c859aba41f99f063f558c">CASM::SymRepTools::SymmetrizerFunction</a></div><div class="ttdeci">std::function&lt; Symmetrizer(Eigen::Ref&lt; const Eigen::MatrixXcd &gt; const &amp;f_subspace)&gt; SymmetrizerFunction</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00025">SymRepTools.hh:26</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_sym_rep_tools_html_af28ea23cf55bbdeab42dfe3f271d359f"><div class="ttname"><a href="namespace_c_a_s_m_1_1_sym_rep_tools.html#af28ea23cf55bbdeab42dfe3f271d359f">CASM::SymRepTools::symrep_subwedges</a></div><div class="ttdeci">std::vector&lt; SubWedge &gt; symrep_subwedges(SymGroup const &amp;_group, SymGroupRepID id)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01382">SymRepTools.cc:1382</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html"><div class="ttname"><a href="namespace_c_a_s_m.html">CASM</a></div><div class="ttdoc">Main CASM namespace.</div><div class="ttdef"><b>Definition:</b> <a href="_a_p_i_command_8hh_source.html#l00008">APICommand.hh:8</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a0141b3c03c8b8006102d53cf9279d9dd"><div class="ttname"><a href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">CASM::almost_equal</a></div><div class="ttdeci">bool almost_equal(ClusterInvariants const &amp;A, ClusterInvariants const &amp;B, double tol)</div><div class="ttdoc">Check if ClusterInvariants are equal.</div><div class="ttdef"><b>Definition:</b> <a href="_cluster_invariants_8cc_source.html#l00036">ClusterInvariants.cc:36</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a03a5ccc431f39c38a390f5f2707949c8"><div class="ttname"><a href="namespace_c_a_s_m.html#a03a5ccc431f39c38a390f5f2707949c8">CASM::permuted_direct_sum_rep</a></div><div class="ttdeci">SymGroupRep permuted_direct_sum_rep(const SymGroupRep &amp;permute_rep, const std::vector&lt; SymGroupRep const * &gt; &amp;sum_reps)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01194">SymRepTools.cc:1194</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a0596b57289630bc8ba7e960b7143a5fe"><div class="ttname"><a href="namespace_c_a_s_m.html#a0596b57289630bc8ba7e960b7143a5fe">CASM::vector_space_sym_report</a></div><div class="ttdeci">VectorSpaceSymReport vector_space_sym_report(DoFSpace const &amp;dof_space, SupercellSymInfo const &amp;sym_info, std::vector&lt; PermuteIterator &gt; const &amp;group, bool calc_wedges=false)</div><div class="ttdoc">Make VectorSpaceSymReport.</div><div class="ttdef"><b>Definition:</b> <a href="_do_f_space_8cc_source.html#l00560">DoFSpace.cc:560</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a099bcf5b428b4811688a64426b378f8f"><div class="ttname"><a href="namespace_c_a_s_m.html#a099bcf5b428b4811688a64426b378f8f">CASM::MatrixXd</a></div><div class="ttdeci">Eigen::MatrixXd MatrixXd</div><div class="ttdef"><b>Definition:</b> <a href="_strain_converter_8hh_source.html#l00030">StrainConverter.hh:30</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a0cf952b51ed558eba3df38f0e29142a4"><div class="ttname"><a href="namespace_c_a_s_m.html#a0cf952b51ed558eba3df38f0e29142a4">CASM::make_orbits</a></div><div class="ttdeci">OrbitOutputIterator make_orbits(OrbitBranchSpecsIterator begin, OrbitBranchSpecsIterator end, const std::vector&lt; IntegralClusterOrbitGenerator &gt; &amp;custom_generators, OrbitOutputIterator result, std::ostream &amp;status)</div><div class="ttdoc">Generate orbits of IntegralCluster using OrbitBranchSpecs.</div><div class="ttdef"><b>Definition:</b> <a href="_cluster_orbits__impl_8hh_source.html#l00479">ClusterOrbits_impl.hh:479</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a14438ef105bddc48e0bc83073d0f2592"><div class="ttname"><a href="namespace_c_a_s_m.html#a14438ef105bddc48e0bc83073d0f2592">CASM::is_irrep</a></div><div class="ttdeci">bool is_irrep(SymGroupRep const &amp;_rep, const SymGroup &amp;head_group)</div><div class="ttdoc">Returns true if _rep is irreducible wrt head_group (does not use character table information)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00708">SymRepTools.cc:708</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a169a1e4b935291374d062af91051c83a"><div class="ttname"><a href="namespace_c_a_s_m.html#a169a1e4b935291374d062af91051c83a">CASM::full_trans_mat</a></div><div class="ttdeci">Eigen::MatrixXd full_trans_mat(std::vector&lt; SymRepTools::IrrepInfo &gt; const &amp;irreps)</div><div class="ttdoc">Assumes that irreps are real, and concatenates their individual trans_mats to form larger trans_mat.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00447">SymRepTools.cc:447</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a2a16b1d0d5b340c2c58e1e7ea98e2742"><div class="ttname"><a href="namespace_c_a_s_m.html#a2a16b1d0d5b340c2c58e1e7ea98e2742">CASM::irrep_symmetrizer</a></div><div class="ttdeci">SymRepTools::Symmetrizer irrep_symmetrizer(SymGroupRep const &amp;_rep, const SymGroup &amp;head_group, double vec_compare_tol)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00420">SymRepTools.cc:420</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a2b2682dec583ef35a708631c233a896e"><div class="ttname"><a href="namespace_c_a_s_m.html#a2b2682dec583ef35a708631c233a896e">CASM::irrep_decomposition</a></div><div class="ttdeci">std::vector&lt; SymRepTools::IrrepInfo &gt; irrep_decomposition(SymGroupRep const &amp;_rep, SymGroup const &amp;head_group, bool allow_complex)</div><div class="ttdoc">Finds irreducible subspaces that comprise an underlying subspace It does not rely on the character ta...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00761">SymRepTools.cc:761</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a44a198ddacab2dd978f2dded2e500c30"><div class="ttname"><a href="namespace_c_a_s_m.html#a44a198ddacab2dd978f2dded2e500c30">CASM::subset_permutation_rep</a></div><div class="ttdeci">SymGroupRep subset_permutation_rep(const SymGroupRep &amp;permute_rep, const std::vector&lt; std::set&lt; Index &gt;&gt; &amp;subsets)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01141">SymRepTools.cc:1141</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a4afad0f276101a30d9239372e963976b"><div class="ttname"><a href="namespace_c_a_s_m.html#a4afad0f276101a30d9239372e963976b">CASM::swap</a></div><div class="ttdeci">void swap(ConfigDoF &amp;A, ConfigDoF &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="_config_do_f_8cc_source.html#l00260">ConfigDoF.cc:260</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a5561556618b8d54641a8f75a38f9b49f"><div class="ttname"><a href="namespace_c_a_s_m.html#a5561556618b8d54641a8f75a38f9b49f">CASM::coord_transformed_copy</a></div><div class="ttdeci">SymGroupRep coord_transformed_copy(SymGroupRep const &amp;_rep, const Eigen::MatrixXd &amp;trans_mat)</div><div class="ttdoc">Make a copy of representation on vector space 'V' that is transformed into a representation on vector...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8cc_source.html#l00175">SymGroupRep.cc:175</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a6f18e9d065a782fcd4c27cd7082d71b7"><div class="ttname"><a href="namespace_c_a_s_m.html#a6f18e9d065a782fcd4c27cd7082d71b7">CASM::special_subspaces</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Eigen::MatrixXd &gt; &gt; special_subspaces(SymGroupRep const &amp;_rep, const SymGroup &amp;head_group)</div><div class="ttdoc">finds high-symmetry subspaces within vector space supporting _rep, wrt symmetry of head_group High-sy...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00610">SymRepTools.cc:610</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a71b214017b27f6027f6dc8ba848651a7"><div class="ttname"><a href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">CASM::TOL</a></div><div class="ttdeci">const double TOL</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8hh_source.html#l00030">definitions.hh:30</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a7ffaf7ad87657ef14e78a7ce88eef88d"><div class="ttname"><a href="namespace_c_a_s_m.html#a7ffaf7ad87657ef14e78a7ce88eef88d">CASM::kron_rep</a></div><div class="ttdeci">SymGroupRep kron_rep(const SymGroupRep &amp;LHS, const SymGroupRep &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01256">SymRepTools.cc:1256</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a85c0e41be877c6726fe49f58506e1e50"><div class="ttname"><a href="namespace_c_a_s_m.html#a85c0e41be877c6726fe49f58506e1e50">CASM::sum</a></div><div class="ttdeci">Container::value_type sum(const Container &amp;container, typename Container::value_type init_val=0)</div><div class="ttdef"><b>Definition:</b> <a href="misc_2algorithm_8hh_source.html#l00131">algorithm.hh:131</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a89a5a207d869cba7f5a9b83eca9ccffe"><div class="ttname"><a href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">CASM::almost_zero</a></div><div class="ttdeci">bool almost_zero(const T &amp;val, double tol=TOL)</div><div class="ttdoc">If T is not integral, use std::abs(val) &lt; tol;.</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__math_8hh_source.html#l00104">CASM_math.hh:104</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a8a4e314541dcd4fbed7831b391944715"><div class="ttname"><a href="namespace_c_a_s_m.html#a8a4e314541dcd4fbed7831b391944715">CASM::special_total_directions</a></div><div class="ttdeci">multivector&lt; Eigen::VectorXd &gt;::X&lt; 3 &gt; special_total_directions(SymGroupRep const &amp;_rep, const SymGroup &amp;head_group)</div><div class="ttdoc">finds high-symmetry directions within vector space supporting _rep, wrt symmetry of head_group</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00467">SymRepTools.cc:467</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_aa7f2fb63a73a30cd5d252e2073eba704"><div class="ttname"><a href="namespace_c_a_s_m.html#aa7f2fb63a73a30cd5d252e2073eba704">CASM::partition_distinct_values</a></div><div class="ttdeci">ReturnArray&lt; Index &gt; partition_distinct_values(const Eigen::MatrixBase&lt; Derived &gt; &amp;value, double tol=TOL)</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___array__math_8hh_source.html#l00100">CASM_Array_math.hh:100</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_abaf3dc70b7ec68e71a693d80f3b99fca"><div class="ttname"><a href="namespace_c_a_s_m.html#abaf3dc70b7ec68e71a693d80f3b99fca">CASM::contains</a></div><div class="ttdeci">bool contains(const Container &amp;container, const T &amp;value)</div><div class="ttdoc">Equivalent to container.end() != std::find(container.begin(), container.end(), value)</div><div class="ttdef"><b>Definition:</b> <a href="misc_2algorithm_8hh_source.html#l00083">algorithm.hh:83</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_ac31c98c0408de7fcc0c9f9458abd2ac4"><div class="ttname"><a href="namespace_c_a_s_m.html#ac31c98c0408de7fcc0c9f9458abd2ac4">CASM::irrep_trans_mat</a></div><div class="ttdeci">Eigen::MatrixXd irrep_trans_mat(SymGroupRep const &amp;_rep, const SymGroup &amp;head_group)</div><div class="ttdoc">Finds the transformation matrix that block-diagonalizes this representation of head_group into irrep ...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01128">SymRepTools.cc:1128</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_ac8763cffe4eb268bbb48b7a6caee626e"><div class="ttname"><a href="namespace_c_a_s_m.html#ac8763cffe4eb268bbb48b7a6caee626e">CASM::special_irrep_directions</a></div><div class="ttdeci">multivector&lt; Eigen::VectorXcd &gt;::X&lt; 2 &gt; special_irrep_directions(SymGroupRep const &amp;_rep, SymGroup const &amp;head_group, double vec_compare_tol)</div><div class="ttdoc">Assuming that _rep is an irrep of head_group, find high-symmetry directions throws if _rep is not an ...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00488">SymRepTools.cc:488</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_aca8cea3f57279005061816bdd2e7f97a"><div class="ttname"><a href="namespace_c_a_s_m.html#aca8cea3f57279005061816bdd2e7f97a">CASM::EigenIndex</a></div><div class="ttdeci">Eigen::MatrixXd::Index EigenIndex</div><div class="ttdef"><b>Definition:</b> <a href="eigen_8hh_source.html#l00007">eigen.hh:7</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_addb972858a65c116ca50bb19d9946a45"><div class="ttname"><a href="namespace_c_a_s_m.html#addb972858a65c116ca50bb19d9946a45">CASM::contains_if</a></div><div class="ttdeci">bool contains_if(const Container &amp;container, UnaryPredicate p)</div><div class="ttdoc">Equivalent to container.end() != std::find_if(container.begin(), container.end(), p)</div><div class="ttdef"><b>Definition:</b> <a href="misc_2algorithm_8hh_source.html#l00098">algorithm.hh:98</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_aea0a866f5769367cb4de0fb6b0a4b2c2"><div class="ttname"><a href="namespace_c_a_s_m.html#aea0a866f5769367cb4de0fb6b0a4b2c2">CASM::num_blocks</a></div><div class="ttdeci">Index num_blocks(SymGroupRep const &amp;_rep, const SymGroup &amp;head_group)</div><div class="ttdoc">counts number of nonzero blocks in matrix representation of head_group as specified by _rep Reveals n...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00402">SymRepTools.cc:402</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_aeb5d5a2111693f4d1eb9a34b58cef6fb"><div class="ttname"><a href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">CASM::Index</a></div><div class="ttdeci">INDEX_TYPE Index</div><div class="ttdoc">For long integer indexing:</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8hh_source.html#l00039">definitions.hh:39</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_aee432f438a1e381a46d59986e037200f"><div class="ttname"><a href="namespace_c_a_s_m.html#aee432f438a1e381a46d59986e037200f">CASM::VectorXd</a></div><div class="ttdeci">Eigen::VectorXd VectorXd</div><div class="ttdef"><b>Definition:</b> <a href="_strain_converter_8hh_source.html#l00029">StrainConverter.hh:29</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_afdfad393ec3b6f749f41e297ea6249aa"><div class="ttname"><a href="namespace_c_a_s_m.html#afdfad393ec3b6f749f41e297ea6249aa">CASM::err_log</a></div><div class="ttdeci">Log &amp; err_log()</div><div class="ttdef"><b>Definition:</b> <a href="_log_8hh_source.html#l00426">Log.hh:426</a></div></div>
<div class="ttc" id="anamespace_eigen_html"><div class="ttname"><a href="namespace_eigen.html">Eigen</a></div><div class="ttdef"><b>Definition:</b> <a href="_data_stream_8hh_source.html#l00326">DataStream.hh:326</a></div></div>
<div class="ttc" id="anamespace_eigen_html_a353cdc8dd6f05043eb445122a8923fdd"><div class="ttname"><a href="namespace_eigen.html#a353cdc8dd6f05043eb445122a8923fdd">Eigen::almost_equal</a></div><div class="ttdeci">bool almost_equal(const Eigen::MatrixBase&lt; Derived1 &gt; &amp;val1, const Eigen::MatrixBase&lt; Derived2 &gt; &amp;val2, double tol=CASM::TOL)</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8hh_source.html#l00653">CASM_Eigen_math.hh:653</a></div></div>
<div class="ttc" id="anamespace_eigen_html_ab60d5c1366dd3d1b998333be1cbda72c"><div class="ttname"><a href="namespace_eigen.html#ab60d5c1366dd3d1b998333be1cbda72c">Eigen::representation_prepare_impl</a></div><div class="ttdeci">Derived::PlainObject representation_prepare_impl(Eigen::MatrixBase&lt; Derived &gt; const &amp;obj, double _tol)</div><div class="ttdoc">Prepare an element for comparison.</div><div class="ttdef"><b>Definition:</b> <a href="_vector_sym_compare__impl_8hh_source.html#l00017">VectorSymCompare_impl.hh:17</a></div></div>
<div class="ttc" id="anamespace_local_html"><div class="ttname"><a href="namespace_local.html">Local</a></div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8hh_source.html#l00017">CASM_Eigen_math.hh:17</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="casm__io_2container_2stream__io_8hh_source.html#l00024">stream_io.hh:24</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_local_1_1___real_type_3_01_eigen_1_1_matrix_3_01_scalar_00_01_rows_at_compile6f4d710d8c9ad9672096477019959e44_html_a7443da17095b4d4be172ffec44728460"><div class="ttname"><a href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01_eigen_1_1_matrix_3_01_scalar_00_01_rows_at_compile6f4d710d8c9ad9672096477019959e44.html#a7443da17095b4d4be172ffec44728460">CASM::Local::_RealType&lt; Eigen::Matrix&lt; Scalar, RowsAtCompileTime, ColsAtCompileTime &gt; &gt;::Type</a></div><div class="ttdeci">Eigen::Matrix&lt; double, RowsAtCompileTime, ColsAtCompileTime &gt; Type</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00122">SymRepTools.cc:122</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_local_1_1___real_type_3_01std_1_1vector_3_01_t_01_4_01_4_html_ae3d9c10cc8989236eb6f816e6e1c740d"><div class="ttname"><a href="struct_c_a_s_m_1_1_local_1_1___real_type_3_01std_1_1vector_3_01_t_01_4_01_4.html#ae3d9c10cc8989236eb6f816e6e1c740d">CASM::Local::_RealType&lt; std::vector&lt; T &gt; &gt;::Type</a></div><div class="ttdeci">std::vector&lt; _Real&lt; T &gt; &gt; Type</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00117">SymRepTools.cc:117</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_local_1_1___real_type_html"><div class="ttname"><a href="struct_c_a_s_m_1_1_local_1_1___real_type.html">CASM::Local::_RealType</a></div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00110">SymRepTools.cc:110</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_local_1_1_irrep_compare_html"><div class="ttname"><a href="struct_c_a_s_m_1_1_local_1_1_irrep_compare.html">CASM::Local::IrrepCompare</a></div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00058">SymRepTools.cc:58</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_local_1_1_irrep_compare_html_a39c04c708ffb1a6bd2a4780f85b74ac2"><div class="ttname"><a href="struct_c_a_s_m_1_1_local_1_1_irrep_compare.html#a39c04c708ffb1a6bd2a4780f85b74ac2">CASM::Local::IrrepCompare::operator()</a></div><div class="ttdeci">bool operator()(SymRepTools::IrrepInfo const &amp;irrep_a, SymRepTools::IrrepInfo const &amp;irrep_b) const</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00059">SymRepTools.cc:59</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html">CASM::SymRepTools::IrrepInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00028">SymRepTools.hh:28</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_a0a2bf886732fa9fc46168577010b2af6"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a0a2bf886732fa9fc46168577010b2af6">CASM::SymRepTools::IrrepInfo::characters</a></div><div class="ttdeci">Eigen::VectorXcd characters</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00067">SymRepTools.hh:67</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_a175c2734544c5bcd094dabd3eb16c7ec"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a175c2734544c5bcd094dabd3eb16c7ec">CASM::SymRepTools::IrrepInfo::index</a></div><div class="ttdeci">Index index</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00059">SymRepTools.hh:59</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_a24613caac83f19ed831d200701bb2797"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a24613caac83f19ed831d200701bb2797">CASM::SymRepTools::IrrepInfo::IrrepInfo</a></div><div class="ttdeci">IrrepInfo(Eigen::MatrixXcd _trans_mat, Eigen::VectorXcd _characters)</div><div class="ttdoc">Construct an IrrepInfo with transformation matrix and vector of irreducible characters.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l00391">SymRepTools.cc:391</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_a3bd6850cd8c7a3eb523dd4efa5a3693e"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a3bd6850cd8c7a3eb523dd4efa5a3693e">CASM::SymRepTools::IrrepInfo::vector_dim</a></div><div class="ttdeci">Index vector_dim() const</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00047">SymRepTools.hh:47</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_a46f893b0244e203cbac0a5e9d6c18214"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a46f893b0244e203cbac0a5e9d6c18214">CASM::SymRepTools::IrrepInfo::directions</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Eigen::VectorXd &gt; &gt; directions</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00073">SymRepTools.hh:73</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_a535886e40f07026b920b9cfa57080b63"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#a535886e40f07026b920b9cfa57080b63">CASM::SymRepTools::IrrepInfo::pseudo_irrep</a></div><div class="ttdeci">bool pseudo_irrep</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00055">SymRepTools.hh:55</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_ab1e8196e27c3709fd21bf73522ee3087"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ab1e8196e27c3709fd21bf73522ee3087">CASM::SymRepTools::IrrepInfo::complex</a></div><div class="ttdeci">bool complex</div><div class="ttdoc">true if any character has non-zero imaginary component, false otherwise</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00050">SymRepTools.hh:50</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_ac4900083bcc0ce1ce544bc05de3ad4b0"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#ac4900083bcc0ce1ce544bc05de3ad4b0">CASM::SymRepTools::IrrepInfo::trans_mat</a></div><div class="ttdeci">Eigen::MatrixXcd trans_mat</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00063">SymRepTools.hh:63</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_aeb2a3f906d1ef2372eb132075e11953e"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#aeb2a3f906d1ef2372eb132075e11953e">CASM::SymRepTools::IrrepInfo::make_dummy</a></div><div class="ttdeci">static IrrepInfo make_dummy(Eigen::MatrixBase&lt; Derived &gt; const &amp;_trans_mat)</div><div class="ttdoc">Named constructor to initialize an IrrepInfo with a user-specified transformtion matrix and character...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00033">SymRepTools.hh:33</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info_html_afcc60ff4c585665ea340aab6fb494d33"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_info.html#afcc60ff4c585665ea340aab6fb494d33">CASM::SymRepTools::IrrepInfo::irrep_dim</a></div><div class="ttdeci">Index irrep_dim() const</div><div class="ttdoc">Dimension of irreducible vector space (less than or equal to vector_dim())</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00044">SymRepTools.hh:44</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge_html"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html">CASM::SymRepTools::IrrepWedge</a></div><div class="ttdoc">An irreducible wedge in an irreducible vector space.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00077">SymRepTools.hh:77</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge_html_a5ca4f0a4270424f5ed66293eea4fdcce"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#a5ca4f0a4270424f5ed66293eea4fdcce">CASM::SymRepTools::IrrepWedge::make_dummy</a></div><div class="ttdeci">static IrrepWedge make_dummy(const Eigen::MatrixXd &amp;axes)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8cc_source.html#l01283">SymRepTools.cc:1283</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge_html_abf431d7ac038b60ff42471901cbba92f"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#abf431d7ac038b60ff42471901cbba92f">CASM::SymRepTools::IrrepWedge::axes</a></div><div class="ttdeci">Eigen::MatrixXd axes</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00087">SymRepTools.hh:87</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge_html_aeffcb1214a9fbce33c9a0ece5cc9306c"><div class="ttname"><a href="struct_c_a_s_m_1_1_sym_rep_tools_1_1_irrep_wedge.html#aeffcb1214a9fbce33c9a0ece5cc9306c">CASM::SymRepTools::IrrepWedge::mult</a></div><div class="ttdeci">std::vector&lt; Index &gt; mult</div><div class="ttdoc">Symmetric multiplicity of each column of 'axes'.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00090">SymRepTools.hh:90</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_vector_space_sym_report_html"><div class="ttname"><a href="struct_c_a_s_m_1_1_vector_space_sym_report.html">CASM::VectorSpaceSymReport</a></div><div class="ttdoc">Summary of data associated with the action of a symmetry group on a vector space.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00185">SymRepTools.hh:185</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_vector_space_sym_report_html_a03af2233f0f37938e46cf92a0ab25941"><div class="ttname"><a href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a03af2233f0f37938e46cf92a0ab25941">CASM::VectorSpaceSymReport::symgroup_rep</a></div><div class="ttdeci">std::vector&lt; Eigen::MatrixXd &gt; symgroup_rep</div><div class="ttdoc">Matrix representation for each operation in the group  defines action of group on vector space.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00188">SymRepTools.hh:188</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_vector_space_sym_report_html_a22c55848dc64bc5c1ceddea603b7b83a"><div class="ttname"><a href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a22c55848dc64bc5c1ceddea603b7b83a">CASM::VectorSpaceSymReport::axis_glossary</a></div><div class="ttdeci">std::vector&lt; std::string &gt; axis_glossary</div><div class="ttdoc">Names given to individual axes in initial (un-adapted) vector space, corresponding to rows of symmetr...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00204">SymRepTools.hh:204</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_vector_space_sym_report_html_a59b177df8cd516113d550066df6d96ea"><div class="ttname"><a href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a59b177df8cd516113d550066df6d96ea">CASM::VectorSpaceSymReport::symmetry_adapted_dof_subspace</a></div><div class="ttdeci">Eigen::MatrixXd symmetry_adapted_dof_subspace</div><div class="ttdoc">Symmetry-oriented subspace of the vector space (columns are the basis vectors)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00200">SymRepTools.hh:200</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_vector_space_sym_report_html_a60ced0fffe11145d9327ff3df21c3eac"><div class="ttname"><a href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a60ced0fffe11145d9327ff3df21c3eac">CASM::VectorSpaceSymReport::irreducible_wedge</a></div><div class="ttdeci">std::vector&lt; SymRepTools::SubWedge &gt; irreducible_wedge</div><div class="ttdoc">Irreducible wedge in the vector space encoded as a vector of symmetrically distinct SubWedges.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00196">SymRepTools.hh:196</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1_vector_space_sym_report_html_a914089ace50a744e00473f5920a7b3fe"><div class="ttname"><a href="struct_c_a_s_m_1_1_vector_space_sym_report.html#a914089ace50a744e00473f5920a7b3fe">CASM::VectorSpaceSymReport::irreps</a></div><div class="ttdeci">std::vector&lt; SymRepTools::IrrepInfo &gt; irreps</div><div class="ttdoc">A list of all irreducible representation that make up the full representation.</div><div class="ttdef"><b>Definition:</b> <a href="_sym_rep_tools_8hh_source.html#l00192">SymRepTools.hh:192</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1multivector_html"><div class="ttname"><a href="struct_c_a_s_m_1_1multivector.html">CASM::multivector</a></div><div class="ttdoc">Shortcut for multidimensional vector (std::vector&lt; std::vector&lt; ...)</div><div class="ttdef"><b>Definition:</b> <a href="multivector_8hh_source.html#l00026">multivector.hh:26</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1multivector_html_a949152e4895e21cbe736da99a9a8d2de"><div class="ttname"><a href="struct_c_a_s_m_1_1multivector.html#a949152e4895e21cbe736da99a9a8d2de">CASM::multivector::X</a></div><div class="ttdeci">typename multivector_impl::multivector_tmp&lt; T, N &gt;::type X</div><div class="ttdef"><b>Definition:</b> <a href="multivector_8hh_source.html#l00028">multivector.hh:28</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1b1ebb90c7bf70e8cab253691ef0700c.html">casm</a></li><li class="navelem"><a class="el" href="dir_df377f2a9808cee3e55eefe3bdb482c7.html">symmetry</a></li><li class="navelem"><a class="el" href="_sym_rep_tools_8cc.html">SymRepTools.cc</a></li>
    <li class="footer">Generated on Tue Mar 23 2021 14:16:48 for CASM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
