<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CASM: /Users/bpuchala/Work/codes/CASMcode_v0.2.X_reference/src/casm/crystallography/BasicStructureTools.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CASM
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">A Clusters Approach to Statistical Mechanics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_basic_structure_tools_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BasicStructureTools.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_basic_structure_tools_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_basic_structure_tools_8hh.html">casm/crystallography/BasicStructureTools.hh</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="basis__set_2_adapter_8hh.html">casm/basis_set/Adapter.hh</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_do_f_is_equivalent_8hh.html">casm/basis_set/DoFIsEquivalent.hh</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_do_f_is_equivalent__impl_8hh.html">casm/basis_set/DoFIsEquivalent_impl.hh</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_basic_structure_8hh.html">casm/crystallography/BasicStructure.hh</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_coordinate_8hh.html">casm/crystallography/Coordinate.hh</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="crystallography_2_do_f_set_8hh.html">casm/crystallography/DoFSet.hh</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_integral_coordinate_within_8hh.html">casm/crystallography/IntegralCoordinateWithin.hh</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_lattice_8hh.html">casm/crystallography/Lattice.hh</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_niggli_8hh.html">casm/crystallography/Niggli.hh</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_site_8hh.html">casm/crystallography/Site.hh</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_superlattice_8hh.html">casm/crystallography/Superlattice.hh</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_superlattice_enumerator_8hh.html">casm/crystallography/SuperlatticeEnumerator.hh</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="crystallography_2_sym_tools_8hh.html">casm/crystallography/SymTools.hh</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_type_8hh.html">casm/crystallography/SymType.hh</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_type_comparator_8hh.html">casm/crystallography/SymTypeComparator.hh</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_unit_cell_coord_8hh.html">casm/crystallography/UnitCellCoord.hh</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;casm/external/Eigen/Core&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;casm/external/Eigen/src/Core/Matrix.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="definitions_8hh.html">casm/global/definitions.hh</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_c_a_s_m___eigen__math_8hh.html">casm/misc/CASM_Eigen_math.hh</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sym_op_8hh.html">casm/symmetry/SymOp.hh</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;casm/external/Eigen/src/Core/PermutationMatrix.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;casm/external/Eigen/src/Core/util/Constants.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_c_a_s_m.html">CASM</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordtype">bool</span> global_dofs_are_compatible_with_operation(</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">xtal::SymOp</a> &amp;operation,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">const</span> std::map&lt;DoFKey, xtal::DoFSet&gt; &amp;global_dof_map) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;name_dof_pr : global_dof_map) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_do_f_set.html">xtal::DoFSet</a> &amp;dof = name_dof_pr.second;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="class_c_a_s_m_1_1xtal_1_1_do_f_set.html">xtal::DoFSet</a> transformed_dof = <a class="code" href="namespace_c_a_s_m_1_1sym.html#a76e4a4b3415ee21b9509b074a194d99a">sym::copy_apply</a>(operation, dof);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_do_f_set_is_equivalent__f.html">xtal::DoFSetIsEquivalent_f</a>(dof, <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>)(transformed_dof)) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">void</span> expand_with_time_reversal(<a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> *growing_point_group) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">int</span> size = growing_point_group-&gt;size();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; size; ++ix) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    growing_point_group-&gt;emplace_back(growing_point_group-&gt;at(ix) *</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                      <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#aef062feb90e9e7ebb5b33873df82b237">xtal::SymOp::time_reversal</a>());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;std::pair&lt;bool, xtal::Coordinate&gt; map_translated_basis_and_calc_drift(</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">const</span> std::vector&lt;xtal::Site&gt; &amp;basis,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">const</span> std::vector&lt;xtal::Site&gt; &amp;translatable_basis,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">xtal::Coordinate</a> &amp;translation, <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">xtal::Coordinate</a> drift = <a class="code" href="group___coordinate.html#gafea15f31cb44314ab9e8a607bb87d7cb">xtal::Coordinate::origin</a>(translation.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a2fe8fb4c98020832700136902a20cc22">lattice</a>());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span> (basis.size() != translatable_basis.size()) <span class="keywordflow">return</span> {<span class="keyword">false</span>, drift};</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">xtal::Site</a> &amp;s_tb : translatable_basis) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> ix = <a class="code" href="namespace_c_a_s_m_1_1xtal.html#ab804ac22f44ba36729881c35cb2fb096">xtal::find_index</a>(basis, s_tb + translation, tol);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (ix &gt;= basis.size())</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">return</span> {<span class="keyword">false</span>, <a class="code" href="group___coordinate.html#gafea15f31cb44314ab9e8a607bb87d7cb">xtal::Coordinate::origin</a>(translation.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a2fe8fb4c98020832700136902a20cc22">lattice</a>())};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// (basis[ix]-s_tb) is exact_translation for mapping pair, translation is</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// proposed translation translation.min_translation(exact_translation) is</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// vector FROM nearest periodic image of exact_translation TO proposed</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// translation. Average of this vector is CoM drift due to proposed</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// translation</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    drift += translation.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a7fbed807d7e5892ffa643d79bcb81e48">min_translation</a>(basis[ix] - s_tb);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  drift.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a2422ca2fe1a9be2de5648512c970f3e2">cart</a>() /= double(basis.size());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">return</span> {<span class="keyword">true</span>, drift};</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordtype">void</span> bring_within(std::vector&lt;xtal::SymOp&gt; *symmetry_group,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                  <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html">xtal::Lattice</a> &amp;tiling_unit) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">xtal::SymOp</a> &amp;operation : *symmetry_group) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">xtal::Coordinate</a> translation_coord(operation.<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a8604ca9aa12e54f3681eafc5cd1914a5">translation</a>, tiling_unit,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                       <a class="code" href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CART</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    translation_coord.within();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    operation.<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a8604ca9aa12e54f3681eafc5cd1914a5">translation</a> = translation_coord.const_cart();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> make_factor_group_from_point_group(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">xtal::BasicStructure</a> &amp;struc, <span class="keyword">const</span> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> &amp;point_group,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="group___configuration.html#ga982c4b30538777719482f3e7aa2d2e77">is_primitive</a>, <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span> (struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>().size() == 0) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> point_group;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">xtal::SymOp</a> &amp;point_group_operation : point_group) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    ++i;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (!::global_dofs_are_compatible_with_operation(point_group_operation,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                     struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#a6c158b021fc135a0ce9aaad6a5c637f2">global_dofs</a>())) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// apply the point group operation to tall the sites</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    std::vector&lt;xtal::Site&gt; transformed_basis;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">xtal::Site</a> &amp;<a class="code" href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a> : struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>()) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      transformed_basis.emplace_back(point_group_operation * <a class="code" href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Using the symmetrically transformed basis, find all possible</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// translations that MIGHT map the symmetrically transformed basis onto</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// the original basis</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">xtal::Site</a> &amp;reference_site = struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>()[0];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">xtal::Site</a> &amp;transformed_site : transformed_basis) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">// If the types don&#39;t match don&#39;t even bother with anything else</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">if</span> (!reference_site.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html#a2da81af1e9344e0da16216d03ed97929">compare_type</a>(transformed_site)) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">xtal::Coordinate</a> translation = reference_site - transformed_site;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      translation.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a8245e700e3a9ee7696f5b331f22cda86">within</a>();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">xtal::Coordinate</a> drift(struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">bool</span> success = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// By construction, the current transformed_site matches the first</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">// basis site, do the rest of them match too?</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">// Determine if mapping is successful, and calculate center-of-mass drift</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      std::tie(success, drift) = map_translated_basis_and_calc_drift(</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>(), transformed_basis, translation, tol);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">// The mapping failed, continue to the next site for a new translation</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">if</span> (!success) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="comment">// You found a valid translation! BUT, before you construct the</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="comment">// symmetry operation, remove some bias from the translation. We want</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">// the average mapping error to be zero, but we arbitrarily</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// constructed the translation by taking the first basis site of the</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// structure as a reference. Here we use the average mapping error to</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">// correct this.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      translation -= drift;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// Now that the translation has been adjusted, create the symmetry</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="comment">// operation and add it if we don&#39;t have an equivalent one already</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">xtal::SymOp</a> translation_operation =</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a10c3b8e242aea6de6840e0c7f076ced7">xtal::SymOp::translation_operation</a>(translation.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#af6b7a17a3a6a7d4bf98d5b7945765c35">const_cart</a>());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">xtal::SymOp</a> new_factor_group_operation(translation_operation *</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                             point_group_operation);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_unary_compare__f.html">UnaryCompare_f&lt;xtal::SymOpPeriodicCompare_f&gt;</a></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          equals_new_factor_group_operation(new_factor_group_operation,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                            struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), tol);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">if</span> (std::find_if(<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.begin(), <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.end(),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                       equals_new_factor_group_operation) ==</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.end()) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.push_back(new_factor_group_operation);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group___configuration.html#ga982c4b30538777719482f3e7aa2d2e77">is_primitive</a>) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">// If structure is primitive, there is no need to attempt other</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment">// translations</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  xtal::close_group&lt;xtal::SymOpPeriodicCompare_f&gt;(&amp;<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                  struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), tol);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  bring_within(&amp;<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>, struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> make_translation_group(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">xtal::BasicStructure</a> &amp;struc,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                         <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> identity_group{<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a0a4018d2a64d7f4247474e28d028a1b1">xtal::SymOp::identity</a>()};</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> translation_group =</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      make_factor_group_from_point_group(struc, identity_group, <span class="keyword">false</span>, tol);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> translation_group;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;std::pair&lt;xtal::BasicStructure, xtal::SymOpVector&gt; make_primitive_factor_group(</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">xtal::BasicStructure</a> &amp;non_primitive_struc, <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">xtal::BasicStructure</a> primitive_struc =</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a8be6264f95230f1aea3f67c17e65d427">xtal::make_primitive</a>(non_primitive_struc);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> primitive_point_group =</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="namespace_c_a_s_m_1_1xtal.html#ae137eba34c546641e8dfb1a441a29ddd">xtal::make_point_group</a>(primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">if</span> (primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af0e2307333b5f26a0ce8cd00a3f88f50">is_time_reversal_active</a>()) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// Duplicate each symmetry operation so that the second version has time</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// reversal enabled</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    ::expand_with_time_reversal(&amp;primitive_point_group);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">xtal::SymOpVector</a> primitive_factor_group =</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      ::make_factor_group_from_point_group(primitive_struc,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                           primitive_point_group, <span class="keyword">true</span>, tol);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">return</span> std::make_pair(primitive_struc, primitive_factor_group);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}  <span class="comment">// namespace</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_c_a_s_m.html">CASM</a> {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">namespace </span>xtal {</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#ab804ac22f44ba36729881c35cb2fb096">  233</a></span>&#160;<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#ab804ac22f44ba36729881c35cb2fb096">find_index</a>(<span class="keyword">const</span> std::vector&lt;Site&gt; &amp;basis, <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">Site</a> &amp;test_site,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                 <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; basis.size(); i++) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (basis[i].<a class="code" href="group___molecule.html#ga34179f5dc76b15423a482b8ce4932ccb">compare_type</a>(test_site) &amp;&amp;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        basis[i].min_dist(test_site) &lt; tol) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">return</span> basis.size();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a9bc595622c9f82c19a2d54dd319dbb27">  244</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a9bc595622c9f82c19a2d54dd319dbb27">is_primitive</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;struc, <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">SymOpVector</a> translation_group = ::make_translation_group(struc, tol);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// For a primitive structure, the only possible translation is no translation</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">return</span> translation_group.size() == 1;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a8be6264f95230f1aea3f67c17e65d427">  250</a></span>&#160;<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a8be6264f95230f1aea3f67c17e65d427">make_primitive</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;non_primitive_struc,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                              <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>().size() == 0) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span> non_primitive_struc;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">SymOpVector</a> translation_group =</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      ::make_translation_group(non_primitive_struc, tol);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">double</span> minimum_possible_volume =</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      std::abs(0.5 * non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>().<a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a93fa0886a3b5f8c5ff0c34cb90da45c3">volume</a>() /</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;               non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>().size());</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// The candidate lattice vectors are the original lattice vectors, plus all</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// the possible translations that map the basis of the non primitive structure</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// onto itself</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  std::vector&lt;Eigen::Vector3d&gt; possible_lattice_vectors{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>()[0], non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>()[1],</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>()[2]};</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a> &amp;trans_op : translation_group) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">Coordinate</a> debug(trans_op.translation, non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), <a class="code" href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CART</a>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    possible_lattice_vectors.push_back(trans_op.translation);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Attempt every combination of vectors, picking one that doesn&#39;t have</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// colinearity (minimum volume check), but results in the smallest lattice</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// possible (running lattice volume check)</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">double</span> minimum_volume = std::abs(2 * non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>().<a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a93fa0886a3b5f8c5ff0c34cb90da45c3">volume</a>());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  Eigen::Vector3d a_vector_primitive, b_vector_primitive, c_vector_primitive;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> Eigen::Vector3d a_vector_candidate : possible_lattice_vectors) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> Eigen::Vector3d b_vector_candidate : possible_lattice_vectors) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> Eigen::Vector3d c_vector_candidate :</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;           possible_lattice_vectors) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">double</span> possible_volume = std::abs(<a class="code" href="group___linear_algebra.html#ga67c49c9fefde840185641db30cf46348">triple_product</a>(</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            a_vector_candidate, b_vector_candidate, c_vector_candidate));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (possible_volume &lt; minimum_volume &amp;&amp;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            possible_volume &gt; minimum_possible_volume) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          minimum_volume = possible_volume;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          a_vector_primitive = a_vector_candidate;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          b_vector_primitive = b_vector_candidate;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          c_vector_primitive = c_vector_candidate;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html">Lattice</a> non_reduced_form_primitive_lattice(</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      a_vector_primitive, b_vector_primitive, c_vector_primitive);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html">Lattice</a> primitive_lattice = <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aa9d6d98eff4f536033eb18beda8d07bb">niggli</a>(non_reduced_form_primitive_lattice,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                     non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>().<a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a74df291ef75456a26fb54c8c2ec39911">tol</a>());</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// The primitive lattice could be noisy, so we smoothen it out to match an</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// integer transformation to the original lattice exactly</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_superlattice.html">Superlattice</a> prim_to_original = <a class="code" href="class_c_a_s_m_1_1xtal_1_1_superlattice.html#af001191d511ba1a02898229e3f65a3b3">Superlattice::smooth_prim</a>(</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      primitive_lattice, non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>());</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  primitive_lattice = prim_to_original.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_superlattice.html#a2052413f9c7aef6328b66d31f513c2a7">prim_lattice</a>();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// Fill up the basis</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> primitive_struc(primitive_lattice);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">Site</a> site_for_prim : non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>()) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    site_for_prim.set_lattice(primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), <a class="code" href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CART</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m_1_1xtal.html#ab804ac22f44ba36729881c35cb2fb096">find_index</a>(primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>(), site_for_prim, tol) ==</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>().size()) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      site_for_prim.within();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#a87ea368ae7d1a43e498a14ecc6ab712e">set_basis</a>().emplace_back(std::move(site_for_prim));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// TODO: Do we want this?</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#ab2701c8c85f85bcc6bb59fbf13aaecd1">set_title</a>(non_primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#a8945168460aed70515058035c436c31e">title</a>());</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">return</span> primitive_struc;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a7929a79fc159de4268f95eecc0ff7a32">  323</a></span>&#160;std::pair&lt;double, Eigen::Vector3d&gt; <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a7929a79fc159de4268f95eecc0ff7a32">calc_rotation_angle_and_axis</a>(</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a> &amp;op, <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html">Lattice</a> &amp;lat) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keyword">auto</span> matrix = op.<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a6aec538883a7177af78f533842c8a233">matrix</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">angle</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  Eigen::Vector3d rotation_axis, _axis;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// Simplest case is identity: has no axis and no location</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(matrix.trace(), 3.) || <a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(matrix.trace(), -3.)) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">angle</a> = 0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    _axis = Eigen::Vector3d::Zero();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    rotation_axis = <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">Coordinate</a>(_axis, lat, <a class="code" href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CART</a>).<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a58629dd20f06aff8e382b05f1110f65b">const_frac</a>();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> std::make_pair(<a class="code" href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">angle</a>, rotation_axis);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// det is -1 if improper and +1 if proper</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">int</span> det = <a class="code" href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">round</a>(matrix.determinant());</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// Find eigen decomposition of proper operation (by multiplying by</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// determinant)</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  Eigen::EigenSolver&lt;Eigen::Matrix3d&gt; t_eig(det * matrix);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">// &#39;axis&#39; is eigenvector whose eigenvalue is +1</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">almost_equal</a>(t_eig.eigenvalues()(i), std::complex&lt;double&gt;(1, 0))) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      _axis = t_eig.eigenvectors().col(i).real();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// Sign convention for &#39;axis&#39;: first non-zero element is positive</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>(_axis[i])) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      _axis *= <a class="code" href="namespace_c_a_s_m.html#a9a375f96cb8c89bfe672017d47e62572">float_sgn</a>(_axis[i]);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// get vector orthogonal to axis: ortho,</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// apply matrix: rot</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// and check angle between ortho and det*rot,</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// using determinant to get the correct angle for improper</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// (i.e. want angle before inversion for rotoinversion)</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  Eigen::Vector3d ortho = _axis.unitOrthogonal();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  Eigen::Vector3d rot = det * (matrix * ortho);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">angle</a> = fmod(</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      (180. / M_PI) * atan2(_axis.dot(ortho.cross(rot)), ortho.dot(rot)) + 360.,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      360.);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  rotation_axis = <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">Coordinate</a>(_axis, lat, <a class="code" href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CART</a>).<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a58629dd20f06aff8e382b05f1110f65b">const_frac</a>();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">return</span> std::make_pair(<a class="code" href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">angle</a>, rotation_axis);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">//*******************************************************************************************</span></div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a73316def5404c519e7a5504f0d850f08">  383</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a73316def5404c519e7a5504f0d850f08">sort_factor_group</a>(std::vector&lt;SymOp&gt; &amp;<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>, <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html">Lattice</a> &amp;lat) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// floating point comparison tolerance</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordtype">double</span> tol = <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// COORD_TYPE print_mode = CART;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// compare on vector of &#39;-det&#39;, &#39;-trace&#39;, &#39;angle&#39;, &#39;axis&#39;, &#39;tau&#39;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keyword">typedef</span> Eigen::Matrix&lt;double, 10, 1&gt; key_type;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">auto</span> make_key = [](<span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a> &amp;op, <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html">Lattice</a> &amp;lat) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    key_type vec;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">double</span> sym_angle;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    Eigen::Vector3d sym_frac;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    std::tie(sym_angle, sym_frac) = <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a7929a79fc159de4268f95eecc0ff7a32">calc_rotation_angle_and_axis</a>(op, lat);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    vec[offset] = double(op.<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#abbdb84f849df80928097940d35ebe6e7">is_time_reversal_active</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    offset++;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    vec[offset] = -op.<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a6aec538883a7177af78f533842c8a233">matrix</a>.determinant();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    offset++;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    vec[offset] = -op.<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a6aec538883a7177af78f533842c8a233">matrix</a>.trace();</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    offset++;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    vec[offset] = sym_angle;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    offset++;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    vec.segment&lt;3&gt;(offset) = sym_frac;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    offset += 3;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    vec.segment&lt;3&gt;(offset) = <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">Coordinate</a>(op.<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a8604ca9aa12e54f3681eafc5cd1914a5">translation</a>, lat, <a class="code" href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CART</a>).<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a58629dd20f06aff8e382b05f1110f65b">const_frac</a>();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    offset += 3;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">return</span> vec;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  };</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// define symop compare function</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keyword">auto</span> op_compare = [tol](<span class="keyword">const</span> key_type &amp;A, <span class="keyword">const</span> key_type &amp;B) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a9b03bd008c2c9c175d9a39f800240283">float_lexicographical_compare</a>(A, B, tol);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  };</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">typedef</span> std::map&lt;key_type, <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a>,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                   std::reference_wrapper&lt;decltype(op_compare)&gt;&gt;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      map_type;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// first put identity in position 0 in order to calculat multi_table correctly</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.size(); ++i) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>[i].matrix.isIdentity() &amp;&amp;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>[i].translation.norm() &lt; <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a> &amp;&amp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        !<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>[i].is_time_reversal_active) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="namespace_c_a_s_m.html#a4afad0f276101a30d9239372e963976b">std::swap</a>(<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>[0], <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>[i]);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// sort conjugacy class using the first symop in the sorted class</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keyword">auto</span> cclass_compare = [tol](<span class="keyword">const</span> map_type &amp;A, <span class="keyword">const</span> map_type &amp;B) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m.html#a9b03bd008c2c9c175d9a39f800240283">float_lexicographical_compare</a>(A.begin()-&gt;first, B.begin()-&gt;first,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                         tol);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  };</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// sort elements in each conjugracy class (or just put all elements in the</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// first map)</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="settings_8cc.html#ad5425481f21e611bf815fc00d454467a">std::set</a>&lt;map_type, std::reference_wrapper&lt;decltype(cclass_compare)&gt;&gt; sorter(</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      cclass_compare);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// else just sort element</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  map_type all_op(op_compare);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.begin(); it != <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.end(); ++it) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    all_op.emplace(make_key(*it, lat), *it);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  sorter.emplace(std::move(all_op));</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// copy symop back into group</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordtype">int</span> j = 0;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;cclass : sorter) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = cclass.begin(); it != cclass.end(); ++it) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>[j] = it-&gt;second;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      ++j;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;}</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a258b215615b0e85c00cef701eaf2e5f4">  466</a></span>&#160;std::vector&lt;SymOp&gt; <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a258b215615b0e85c00cef701eaf2e5f4">make_factor_group</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;struc, <span class="keywordtype">double</span> tol) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keyword">auto</span> prim_factor_group_pair = ::make_primitive_factor_group(struc, tol);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;primitive_struc = prim_factor_group_pair.first;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keyword">const</span> std::vector&lt;SymOp&gt; &amp;primitive_factor_group =</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      prim_factor_group_pair.second;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keyword">auto</span> all_lattice_points = <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a0258e1e5306d850114c48c44c29c5512">make_lattice_points</a>(</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>().<a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a74df291ef75456a26fb54c8c2ec39911">tol</a>());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  std::vector&lt;SymOp&gt; point_group = <a class="code" href="namespace_c_a_s_m_1_1xtal.html#ae137eba34c546641e8dfb1a441a29ddd">make_point_group</a>(struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>());</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  std::vector&lt;SymOp&gt; <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a> &amp;prim_op : primitive_factor_group) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// If the primitive factor group operation with translations removed can&#39;t</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// map the original structure&#39;s lattice onto itself, then ditch that</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// operation.</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_unary_compare__f.html">UnaryCompare_f&lt;SymOpMatrixCompare_f&gt;</a> equals_prim_op_ignoring_trans(prim_op,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                                                       tol);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">if</span> (std::find_if(point_group.begin(), point_group.end(),</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                     equals_prim_op_ignoring_trans) == point_group.end()) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// Otherwise take that factor operation, and expand it by adding additional</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// translations within the structure</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_unit_cell.html">UnitCell</a> &amp;lattice_point : all_lattice_points) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">xtal::Coordinate</a> lattice_point_coordinate = <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aa3543105c731d1653cfe5fcd8fdabe4b">make_superlattice_coordinate</a>(</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;          lattice_point, primitive_struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>());</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.emplace_back(</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a10c3b8e242aea6de6840e0c7f076ced7">SymOp::translation_operation</a>(lattice_point_coordinate.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a2422ca2fe1a9be2de5648512c970f3e2">cart</a>()) *</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          prim_op);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a73316def5404c519e7a5504f0d850f08">sort_factor_group</a>(<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>, struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>());</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;std::vector&lt;Eigen::PermutationMatrix&lt;Eigen::Dynamic, Eigen::Dynamic, Index&gt;&gt;</div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a49b7bd361888f937640d376abf72a2c0">  523</a></span>&#160;<a class="code" href="namespace_c_a_s_m_1_1xtal.html#a49b7bd361888f937640d376abf72a2c0">make_permutation_representation</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">xtal::BasicStructure</a> &amp;struc,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                <span class="keyword">const</span> std::vector&lt;SymOp&gt; &amp;<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  std::string clr(100, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.size() &lt;= 0) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;ERROR in xtal::make_permutation_representation&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Factor group is empty.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    exit(1);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  std::vector&lt;xtal::UnitCellCoord&gt; sitemap;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  Eigen::PermutationMatrix&lt;Eigen::Dynamic, Eigen::Dynamic, Index&gt; init_perm_mat;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  init_perm_mat.setIdentity(struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>().size());</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  std::vector&lt;Eigen::PermutationMatrix&lt;Eigen::Dynamic, Eigen::Dynamic, Index&gt;&gt;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      perm_rep(<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.size(), init_perm_mat);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> <a class="code" href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a> = 0; <a class="code" href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a> &lt; <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>.size(); ++<a class="code" href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a>) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> &amp;op = <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>[<a class="code" href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a>];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    std::vector&lt;Index&gt; _perm(struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>().size(), -1);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    sitemap = <a class="code" href="group___structure.html#ga56648ae934b441964932bc9714c7066f">xtal::symop_site_map</a>(op, struc);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> b = 0; b &lt; struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>().size(); ++b) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> &amp;dofref_to =</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>()[sitemap[b].sublattice()].occupant_dof();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keyword">auto</span> <span class="keyword">const</span> &amp;dofref_from = struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>()[b].occupant_dof();</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_occupant_do_f_is_equivalent.html">OccupantDoFIsEquivalent&lt;xtal::Molecule&gt;</a> eq(dofref_from);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="comment">// adapter::Adapter&lt;SymOp, CASM::SymOp&gt;()(op)</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">if</span> (eq(op, dofref_to)) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        _perm[b] = sitemap[b].sublattice();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="stringliteral">&quot;In Structure::_generate_basis_symreps(), Sites originally &quot;</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="stringliteral">&quot;identified as equivalent cannot be mapped by symmetry.&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    Eigen::Map&lt;Eigen::Matrix&lt;Index, Eigen::Dynamic, 1&gt;&gt; index_matrix(</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        _perm.data(), _perm.size());</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    perm_rep[<a class="code" href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a>].indices() = index_matrix;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">return</span> perm_rep;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a00635d43f96b90091c0f94181bbdba4e">  573</a></span>&#160;std::set&lt;std::set&lt;Index&gt;&gt; <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a00635d43f96b90091c0f94181bbdba4e">make_asymmetric_unit</a>(</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">xtal::BasicStructure</a> &amp;struc, <span class="keyword">const</span> std::vector&lt;SymOp&gt; &amp;<a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordtype">double</span> tol = struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>().<a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a74df291ef75456a26fb54c8c2ec39911">tol</a>();</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keyword">auto</span> transformed_site_index = [&amp;](<a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">Site</a> <span class="keyword">const</span> &amp;site, <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a> <span class="keyword">const</span> &amp;op) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">Site</a> transformed_site = op * site;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_unit_cell_coord.html#a88a2f9ca4d62609240fcb33c01d740e5">UnitCellCoord::from_coordinate</a>(struc, transformed_site, tol)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        .<a class="code" href="class_c_a_s_m_1_1xtal_1_1_unit_cell_coord.html#a8d8762f44145d7c1335e2c856e07008c">sublattice</a>();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  };</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  std::set&lt;std::set&lt;Index&gt;&gt; asym_unit;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">Site</a> <span class="keyword">const</span> &amp;site : struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>()) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    std::set&lt;Index&gt; equivalent_sites;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a> <span class="keyword">const</span> &amp;op : <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      equivalent_sites.insert(transformed_site_index(site, op));</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    asym_unit.insert(equivalent_sites);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">return</span> asym_unit;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#ac6df61115769416547b3996f51b3aa4c">  602</a></span>&#160;std::set&lt;std::set&lt;Index&gt;&gt; <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a00635d43f96b90091c0f94181bbdba4e">make_asymmetric_unit</a>(</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">xtal::BasicStructure</a> &amp;struc) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  std::vector&lt;SymOp&gt; <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a> =</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a258b215615b0e85c00cef701eaf2e5f4">make_factor_group</a>(struc, struc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>().<a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a74df291ef75456a26fb54c8c2ec39911">tol</a>());</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a00635d43f96b90091c0f94181bbdba4e">make_asymmetric_unit</a>(struc, <a class="code" href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">factor_group</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a19fefd7cadbb3d0d6dc50e232464bf86">  609</a></span>&#160;<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a19fefd7cadbb3d0d6dc50e232464bf86">symmetrize</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;<a class="code" href="namespace_c_a_s_m_1_1_config_i_o.html#a612f2b25a67dabf14f7013a701c46bc5">structure</a>,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                          <span class="keyword">const</span> std::vector&lt;SymOp&gt; &amp;enforced_group) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// All your sites need to be within</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keyword">auto</span> symmetrized_structure = <a class="code" href="namespace_c_a_s_m_1_1_config_i_o.html#a612f2b25a67dabf14f7013a701c46bc5">structure</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="comment">// First make a copy of your current basis</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="comment">// This copy will eventually become the new average basis.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keyword">auto</span> avg_basis = <a class="code" href="namespace_c_a_s_m_1_1_config_i_o.html#a612f2b25a67dabf14f7013a701c46bc5">structure</a>.basis();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">// Loop through given symmetry group an fill a temporary &quot;operated basis&quot;</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  decltype(avg_basis) operated_basis;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="comment">// Loop through given symmetry group an fill a temporary &quot;operated basis&quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">SymOp</a> &amp;enforce_group_operation : enforced_group) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    operated_basis.clear();</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;symmetrized_structure_site :</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;         symmetrized_structure.basis()) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      operated_basis.push_back(enforce_group_operation *</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                               symmetrized_structure_site);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// Now that you have a transformed basis, find the closest mapping of atoms</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// Then average the distance and add it to the average basis</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">Index</a> b = 0; b &lt; symmetrized_structure.basis().size(); b++) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordtype">double</span> smallest = 1000000;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">Coordinate</a> bshift(symmetrized_structure.lattice());</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;operated_basis_site : operated_basis) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordtype">double</span> dist =</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            operated_basis_site.min_dist(symmetrized_structure.basis()[b]);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">if</span> (dist &lt; smallest) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          bshift = operated_basis_site.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a7fbed807d7e5892ffa643d79bcb81e48">min_translation</a>(</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;              symmetrized_structure.basis()[b]);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;          smallest = dist;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      bshift.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a2422ca2fe1a9be2de5648512c970f3e2">cart</a>() *= (1.0 / enforced_group.size());</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      avg_basis[b] += bshift;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  symmetrized_structure.set_basis(avg_basis);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">return</span> symmetrized_structure;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;}</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> IntegralType, <span class="keywordtype">int</span> Options&gt;</div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#acce70bca45c064241f9430d637dc6349">  653</a></span>&#160;<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#acce70bca45c064241f9430d637dc6349">make_superstructure</a>(</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;tiling_unit,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keyword">const</span> Eigen::Matrix&lt;IntegralType, 3, 3, Options&gt; &amp;transformation_matrix) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  static_assert(std::is_integral&lt;IntegralType&gt;::value,</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <span class="stringliteral">&quot;Transfomration matrix must be integer matrix&quot;</span>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html">Lattice</a> superlat =</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <a class="code" href="group___lattice.html#gaa999543bab1b8afe3bf74e355e86f737">make_superlattice</a>(tiling_unit.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), transformation_matrix);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> superstruc(superlat);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  std::vector&lt;UnitCell&gt; all_lattice_points =</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a0258e1e5306d850114c48c44c29c5512">make_lattice_points</a>(tiling_unit.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), superlat, superlat.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a74df291ef75456a26fb54c8c2ec39911">tol</a>());</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  std::vector&lt;Site&gt; superstruc_basis;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_site.html">Site</a> &amp;unit_basis_site : tiling_unit.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">basis</a>()) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_unit_cell.html">UnitCell</a> &amp;lattice_point : all_lattice_points) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <a class="code" href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">Coordinate</a> lattice_point_coordinate = <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aa3543105c731d1653cfe5fcd8fdabe4b">make_superlattice_coordinate</a>(</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          lattice_point, tiling_unit.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">lattice</a>(), superlat);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      superstruc_basis.emplace_back(unit_basis_site + lattice_point_coordinate);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  superstruc.<a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#a87ea368ae7d1a43e498a14ecc6ab712e">set_basis</a>(superstruc_basis, <a class="code" href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CART</a>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">return</span> superstruc;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#aaaa495d9f9f7f10f7703f6ac1dfb2a01">  677</a></span>&#160;<span class="keyword">template</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#aaaa495d9f9f7f10f7703f6ac1dfb2a01">make_superstructure&lt;int, 0&gt;</a>(</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;tiling_unit,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keyword">const</span> Eigen::Matrix&lt;int, 3, 3, 0&gt; &amp;transformation_matrix);</div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m_1_1xtal.html#a0ef7d791084d03ec1c4e1f6791bd8505">  680</a></span>&#160;<span class="keyword">template</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> <a class="code" href="namespace_c_a_s_m_1_1xtal.html#a0ef7d791084d03ec1c4e1f6791bd8505">make_superstructure&lt;long, 0&gt;</a>(</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">BasicStructure</a> &amp;tiling_unit,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keyword">const</span> Eigen::Matrix&lt;long, 3, 3, 0&gt; &amp;transformation_matrix);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}  <span class="comment">// namespace xtal</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}  <span class="comment">// namespace CASM</span></div>
<div class="ttc" id="a_basic_structure_8hh_html"><div class="ttname"><a href="_basic_structure_8hh.html">BasicStructure.hh</a></div></div>
<div class="ttc" id="a_basic_structure_tools_8hh_html"><div class="ttname"><a href="_basic_structure_tools_8hh.html">BasicStructureTools.hh</a></div></div>
<div class="ttc" id="a_c_a_s_m___eigen__math_8hh_html"><div class="ttname"><a href="_c_a_s_m___eigen__math_8hh.html">CASM_Eigen_math.hh</a></div></div>
<div class="ttc" id="a_coordinate_8hh_html"><div class="ttname"><a href="_coordinate_8hh.html">Coordinate.hh</a></div></div>
<div class="ttc" id="a_database_types_8cc_html_a56317e7f57c2fa6d74d61f81ecb4b3b3"><div class="ttname"><a href="_database_types_8cc.html#a56317e7f57c2fa6d74d61f81ecb4b3b3">s</a></div><div class="ttdeci">std::set&lt; std::string &gt; &amp; s</div><div class="ttdef"><b>Definition:</b> <a href="_database_types_8cc_source.html#l00015">DatabaseTypes.cc:15</a></div></div>
<div class="ttc" id="a_do_f_is_equivalent_8hh_html"><div class="ttname"><a href="_do_f_is_equivalent_8hh.html">DoFIsEquivalent.hh</a></div></div>
<div class="ttc" id="a_do_f_is_equivalent__impl_8hh_html"><div class="ttname"><a href="_do_f_is_equivalent__impl_8hh.html">DoFIsEquivalent_impl.hh</a></div></div>
<div class="ttc" id="a_integral_coordinate_within_8hh_html"><div class="ttname"><a href="_integral_coordinate_within_8hh.html">IntegralCoordinateWithin.hh</a></div></div>
<div class="ttc" id="a_lattice_8hh_html"><div class="ttname"><a href="_lattice_8hh.html">Lattice.hh</a></div></div>
<div class="ttc" id="a_niggli_8hh_html"><div class="ttname"><a href="_niggli_8hh.html">Niggli.hh</a></div></div>
<div class="ttc" id="a_site_8hh_html"><div class="ttname"><a href="_site_8hh.html">Site.hh</a></div></div>
<div class="ttc" id="a_superlattice_8hh_html"><div class="ttname"><a href="_superlattice_8hh.html">Superlattice.hh</a></div></div>
<div class="ttc" id="a_superlattice_enumerator_8hh_html"><div class="ttname"><a href="_superlattice_enumerator_8hh.html">SuperlatticeEnumerator.hh</a></div></div>
<div class="ttc" id="a_sym_op_8hh_html"><div class="ttname"><a href="_sym_op_8hh.html">SymOp.hh</a></div></div>
<div class="ttc" id="a_sym_type_8hh_html"><div class="ttname"><a href="_sym_type_8hh.html">SymType.hh</a></div></div>
<div class="ttc" id="a_sym_type_comparator_8hh_html"><div class="ttname"><a href="_sym_type_comparator_8hh.html">SymTypeComparator.hh</a></div></div>
<div class="ttc" id="a_unit_cell_coord_8hh_html"><div class="ttname"><a href="_unit_cell_coord_8hh.html">UnitCellCoord.hh</a></div></div>
<div class="ttc" id="abasis__set_2_adapter_8hh_html"><div class="ttname"><a href="basis__set_2_adapter_8hh.html">Adapter.hh</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_occupant_do_f_is_equivalent_html"><div class="ttname"><a href="class_c_a_s_m_1_1_occupant_do_f_is_equivalent.html">CASM::OccupantDoFIsEquivalent</a></div><div class="ttdoc">Class for checking equivalence of two OccupantDoF objects, with respect to symmetry transformations.</div><div class="ttdef"><b>Definition:</b> <a href="_do_f_is_equivalent_8hh_source.html#l00075">DoFIsEquivalent.hh:75</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1_unary_compare__f_html"><div class="ttname"><a href="class_c_a_s_m_1_1_unary_compare__f.html">CASM::UnaryCompare_f</a></div><div class="ttdef"><b>Definition:</b> <a href="definitions_8hh_source.html#l00059">definitions.hh:59</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html">CASM::xtal::BasicStructure</a></div><div class="ttdoc">BasicStructure specifies the lattice and atomic basis of a crystal.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00032">BasicStructure.hh:32</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html_a6c158b021fc135a0ce9aaad6a5c637f2"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#a6c158b021fc135a0ce9aaad6a5c637f2">CASM::xtal::BasicStructure::global_dofs</a></div><div class="ttdeci">std::map&lt; DoFKey, DoFSet &gt; const  &amp; global_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00079">BasicStructure.hh:79</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html_a87ea368ae7d1a43e498a14ecc6ab712e"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#a87ea368ae7d1a43e498a14ecc6ab712e">CASM::xtal::BasicStructure::set_basis</a></div><div class="ttdeci">std::vector&lt; Site &gt; &amp; set_basis()</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00073">BasicStructure.hh:73</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html_a8945168460aed70515058035c436c31e"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#a8945168460aed70515058035c436c31e">CASM::xtal::BasicStructure::title</a></div><div class="ttdeci">const std::string &amp; title() const</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00075">BasicStructure.hh:75</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html_ab2701c8c85f85bcc6bb59fbf13aaecd1"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#ab2701c8c85f85bcc6bb59fbf13aaecd1">CASM::xtal::BasicStructure::set_title</a></div><div class="ttdeci">void set_title(std::string const &amp;_title)</div><div class="ttdoc">Set the title of the structure.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8cc_source.html#l00084">BasicStructure.cc:84</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html_acf87cd9936047ec973f75622060f58ba"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#acf87cd9936047ec973f75622060f58ba">CASM::xtal::BasicStructure::lattice</a></div><div class="ttdeci">const Lattice &amp; lattice() const</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00069">BasicStructure.hh:69</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html_af0e2307333b5f26a0ce8cd00a3f88f50"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af0e2307333b5f26a0ce8cd00a3f88f50">CASM::xtal::BasicStructure::is_time_reversal_active</a></div><div class="ttdeci">bool is_time_reversal_active() const</div><div class="ttdoc">Returns true if structure has attributes affected by time reversal.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8cc_source.html#l00323">BasicStructure.cc:323</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_basic_structure_html_af9efe2163e14cf866a6244964204c913"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_basic_structure.html#af9efe2163e14cf866a6244964204c913">CASM::xtal::BasicStructure::basis</a></div><div class="ttdeci">const std::vector&lt; Site &gt; &amp; basis() const</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00071">BasicStructure.hh:71</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_coordinate_html"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_coordinate.html">CASM::xtal::Coordinate</a></div><div class="ttdoc">Represents cartesian and fractional coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00034">Coordinate.hh:34</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_coordinate_html_a2422ca2fe1a9be2de5648512c970f3e2"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a2422ca2fe1a9be2de5648512c970f3e2">CASM::xtal::Coordinate::cart</a></div><div class="ttdeci">Coordinate_impl::CartCoordinate cart()</div><div class="ttdoc">Set Cartesian coordinate vector and update fractional coordinate vector.</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00562">Coordinate.hh:562</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_coordinate_html_a2fe8fb4c98020832700136902a20cc22"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a2fe8fb4c98020832700136902a20cc22">CASM::xtal::Coordinate::lattice</a></div><div class="ttdeci">const Lattice &amp; lattice() const</div><div class="ttdoc">Access the home lattice of the coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00206">Coordinate.hh:206</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_coordinate_html_a58629dd20f06aff8e382b05f1110f65b"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a58629dd20f06aff8e382b05f1110f65b">CASM::xtal::Coordinate::const_frac</a></div><div class="ttdeci">const vector_type &amp; const_frac() const</div><div class="ttdoc">user override to force const Access the fractional coordinate vector</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00068">Coordinate.hh:68</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_coordinate_html_a7fbed807d7e5892ffa643d79bcb81e48"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a7fbed807d7e5892ffa643d79bcb81e48">CASM::xtal::Coordinate::min_translation</a></div><div class="ttdeci">Coordinate min_translation(const Coordinate &amp;neighbor) const</div><div class="ttdoc">Returns translation coordinate (in Angstr) to nearest periodic image of neighbor.</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8cc_source.html#l00156">Coordinate.cc:156</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_coordinate_html_a8245e700e3a9ee7696f5b331f22cda86"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#a8245e700e3a9ee7696f5b331f22cda86">CASM::xtal::Coordinate::within</a></div><div class="ttdeci">bool within()</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8cc_source.html#l00205">Coordinate.cc:205</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_coordinate_html_af6b7a17a3a6a7d4bf98d5b7945765c35"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_coordinate.html#af6b7a17a3a6a7d4bf98d5b7945765c35">CASM::xtal::Coordinate::const_cart</a></div><div class="ttdeci">const vector_type &amp; const_cart() const</div><div class="ttdoc">user override to force const Access the Cartesian coordinate vector</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00090">Coordinate.hh:90</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_do_f_set_html"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_do_f_set.html">CASM::xtal::DoFSet</a></div><div class="ttdef"><b>Definition:</b> <a href="crystallography_2_do_f_set_8hh_source.html#l00029">DoFSet.hh:29</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_lattice_html"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_lattice.html">CASM::xtal::Lattice</a></div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8hh_source.html#l00029">Lattice.hh:29</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_lattice_html_a74df291ef75456a26fb54c8c2ec39911"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a74df291ef75456a26fb54c8c2ec39911">CASM::xtal::Lattice::tol</a></div><div class="ttdeci">double tol() const</div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8hh_source.html#l00195">Lattice.hh:195</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_lattice_html_a93fa0886a3b5f8c5ff0c34cb90da45c3"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_lattice.html#a93fa0886a3b5f8c5ff0c34cb90da45c3">CASM::xtal::Lattice::volume</a></div><div class="ttdeci">double volume() const</div><div class="ttdoc">Return signed volume of this lattice.</div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8hh_source.html#l00088">Lattice.hh:88</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_site_html"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_site.html">CASM::xtal::Site</a></div><div class="ttdef"><b>Definition:</b> <a href="_site_8hh_source.html#l00023">Site.hh:23</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_site_html_a2da81af1e9344e0da16216d03ed97929"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_site.html#a2da81af1e9344e0da16216d03ed97929">CASM::xtal::Site::compare_type</a></div><div class="ttdeci">bool compare_type(const Site &amp;test_site) const</div><div class="ttdef"><b>Definition:</b> <a href="_site_8cc_source.html#l00189">Site.cc:189</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_superlattice_html"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_superlattice.html">CASM::xtal::Superlattice</a></div><div class="ttdef"><b>Definition:</b> <a href="_superlattice_8hh_source.html#l00008">Superlattice.hh:8</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_superlattice_html_a2052413f9c7aef6328b66d31f513c2a7"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_superlattice.html#a2052413f9c7aef6328b66d31f513c2a7">CASM::xtal::Superlattice::prim_lattice</a></div><div class="ttdeci">const Lattice &amp; prim_lattice() const</div><div class="ttdef"><b>Definition:</b> <a href="_superlattice_8hh_source.html#l00020">Superlattice.hh:20</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_superlattice_html_af001191d511ba1a02898229e3f65a3b3"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_superlattice.html#af001191d511ba1a02898229e3f65a3b3">CASM::xtal::Superlattice::smooth_prim</a></div><div class="ttdeci">static Superlattice smooth_prim(const Lattice &amp;tiling_unit, const Lattice &amp;superlattice)</div><div class="ttdef"><b>Definition:</b> <a href="_superlattice_8cc_source.html#l00022">Superlattice.cc:22</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_unit_cell_coord_html_a88a2f9ca4d62609240fcb33c01d740e5"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_unit_cell_coord.html#a88a2f9ca4d62609240fcb33c01d740e5">CASM::xtal::UnitCellCoord::from_coordinate</a></div><div class="ttdeci">static UnitCellCoord from_coordinate(const PrimType &amp;, const Coordinate &amp;coord, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="_unit_cell_coord_8cc_source.html#l00054">UnitCellCoord.cc:54</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_unit_cell_coord_html_a8d8762f44145d7c1335e2c856e07008c"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_unit_cell_coord.html#a8d8762f44145d7c1335e2c856e07008c">CASM::xtal::UnitCellCoord::sublattice</a></div><div class="ttdeci">Index sublattice() const</div><div class="ttdef"><b>Definition:</b> <a href="_unit_cell_coord_8hh_source.html#l00152">UnitCellCoord.hh:152</a></div></div>
<div class="ttc" id="aclass_c_a_s_m_1_1xtal_1_1_unit_cell_html"><div class="ttname"><a href="class_c_a_s_m_1_1xtal_1_1_unit_cell.html">CASM::xtal::UnitCell</a></div><div class="ttdoc">Unit Cell Indices.</div><div class="ttdef"><b>Definition:</b> <a href="_unit_cell_coord_8hh_source.html#l00034">UnitCellCoord.hh:34</a></div></div>
<div class="ttc" id="acrystallography_2_do_f_set_8hh_html"><div class="ttname"><a href="crystallography_2_do_f_set_8hh.html">DoFSet.hh</a></div></div>
<div class="ttc" id="acrystallography_2_sym_tools_8hh_html"><div class="ttname"><a href="crystallography_2_sym_tools_8hh.html">SymTools.hh</a></div></div>
<div class="ttc" id="adefinitions_8hh_html"><div class="ttname"><a href="definitions_8hh.html">definitions.hh</a></div></div>
<div class="ttc" id="agroup___configuration_html_ga982c4b30538777719482f3e7aa2d2e77"><div class="ttname"><a href="group___configuration.html#ga982c4b30538777719482f3e7aa2d2e77">CASM::is_primitive</a></div><div class="ttdeci">bool is_primitive(const Configuration &amp;_config)</div><div class="ttdoc">returns true if _config describes primitive cell of the configuration it describes</div><div class="ttdef"><b>Definition:</b> <a href="_configuration_8cc_source.html#l01045">Configuration.cc:1045</a></div></div>
<div class="ttc" id="agroup___coordinate_html_gafea15f31cb44314ab9e8a607bb87d7cb"><div class="ttname"><a href="group___coordinate.html#gafea15f31cb44314ab9e8a607bb87d7cb">CASM::xtal::Coordinate::origin</a></div><div class="ttdeci">static Coordinate origin(const Lattice &amp;_home)</div><div class="ttdoc">construct a coordinate describing origin of _home lattice</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00284">Coordinate.hh:284</a></div></div>
<div class="ttc" id="agroup___lattice_html_gaa999543bab1b8afe3bf74e355e86f737"><div class="ttname"><a href="group___lattice.html#gaa999543bab1b8afe3bf74e355e86f737">CASM::xtal::make_superlattice</a></div><div class="ttdeci">Lattice make_superlattice(const Lattice &amp;lat, const Eigen::Matrix&lt; IntegralType, 3, 3, Options &gt; &amp;transf_mat)</div><div class="ttdoc">Returns a super Lattice. Transformation matrix must be integer.</div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8hh_source.html#l00287">Lattice.hh:287</a></div></div>
<div class="ttc" id="agroup___linear_algebra_html_ga67c49c9fefde840185641db30cf46348"><div class="ttname"><a href="group___linear_algebra.html#ga67c49c9fefde840185641db30cf46348">CASM::triple_product</a></div><div class="ttdeci">Derived::Scalar triple_product(const Derived &amp;vec0, const Derived &amp;vec1, const Derived &amp;vec2)</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8hh_source.html#l00158">CASM_Eigen_math.hh:158</a></div></div>
<div class="ttc" id="agroup___linear_algebra_html_ga6fccc5dcedea06e5cf6663cdea393fe8"><div class="ttname"><a href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">CASM::angle</a></div><div class="ttdeci">double angle(const Eigen::Ref&lt; const Eigen::Vector3d &gt; &amp;a, const Eigen::Ref&lt; const Eigen::Vector3d &gt; &amp;b)</div><div class="ttdoc">Get angle, in radians, between two vectors on range [0,pi].</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8cc_source.html#l00611">CASM_Eigen_math.cc:611</a></div></div>
<div class="ttc" id="agroup___linear_algebra_html_ga8f2e443ab100f75d5ac872706f0ced0e"><div class="ttname"><a href="group___linear_algebra.html#ga8f2e443ab100f75d5ac872706f0ced0e">CASM::round</a></div><div class="ttdeci">Eigen::CwiseUnaryOp&lt; decltype(Local::round_l&lt; typename Derived::Scalar &gt;), const Derived &gt; round(const Eigen::MatrixBase&lt; Derived &gt; &amp;val)</div><div class="ttdoc">Round Eigen::MatrixXd.</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8hh_source.html#l00202">CASM_Eigen_math.hh:202</a></div></div>
<div class="ttc" id="agroup___molecule_html_ga34179f5dc76b15423a482b8ce4932ccb"><div class="ttname"><a href="group___molecule.html#ga34179f5dc76b15423a482b8ce4932ccb">CASM::xtal::compare_type</a></div><div class="ttdeci">bool compare_type(AtomPosition const &amp;A, AtomPosition const &amp;B, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="_molecule_8cc_source.html#l00019">Molecule.cc:19</a></div></div>
<div class="ttc" id="agroup___structure_html_ga56648ae934b441964932bc9714c7066f"><div class="ttname"><a href="group___structure.html#ga56648ae934b441964932bc9714c7066f">CASM::xtal::symop_site_map</a></div><div class="ttdeci">std::vector&lt; UnitCellCoord &gt; symop_site_map(SymOp const &amp;_op, BasicStructure const &amp;_struc)</div><div class="ttdoc">To which site a SymOp transforms each basis site.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8cc_source.html#l00340">BasicStructure.cc:340</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_config_i_o_html_a612f2b25a67dabf14f7013a701c46bc5"><div class="ttname"><a href="namespace_c_a_s_m_1_1_config_i_o.html#a612f2b25a67dabf14f7013a701c46bc5">CASM::ConfigIO::structure</a></div><div class="ttdeci">ConfigIO::GenericConfigFormatter&lt; jsonParser &gt; structure()</div><div class="ttdef"><b>Definition:</b> <a href="_config_i_o_8cc_source.html#l00766">ConfigIO.cc:766</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1_shared_prim__dataformatter__impl_html_a3b6e81830e1b964a163d4f95b3b85ced"><div class="ttname"><a href="namespace_c_a_s_m_1_1_shared_prim__dataformatter__impl.html#a3b6e81830e1b964a163d4f95b3b85ced">CASM::SharedPrim_dataformatter_impl::factor_group</a></div><div class="ttdeci">SharedPrimFormatter&lt; jsonParser &gt; factor_group()</div><div class="ttdef"><b>Definition:</b> <a href="_shared_prim__data__io_8cc_source.html#l00069">SharedPrim_data_io.cc:69</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1sym_html_a76e4a4b3415ee21b9509b074a194d99a"><div class="ttname"><a href="namespace_c_a_s_m_1_1sym.html#a76e4a4b3415ee21b9509b074a194d99a">CASM::sym::copy_apply</a></div><div class="ttdeci">xtal::Coordinate copy_apply(const xtal::SymOp &amp;op, xtal::Coordinate coord)</div><div class="ttdoc">Copy and apply SymOp to a Coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8cc_source.html#l00354">Coordinate.cc:354</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a00635d43f96b90091c0f94181bbdba4e"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a00635d43f96b90091c0f94181bbdba4e">CASM::xtal::make_asymmetric_unit</a></div><div class="ttdeci">std::set&lt; std::set&lt; Index &gt; &gt; make_asymmetric_unit(const xtal::BasicStructure &amp;struc, const std::vector&lt; SymOp &gt; &amp;factor_group)</div><div class="ttdoc">Return indices of equivalent basis sites.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00573">BasicStructureTools.cc:573</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a0258e1e5306d850114c48c44c29c5512"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a0258e1e5306d850114c48c44c29c5512">CASM::xtal::make_lattice_points</a></div><div class="ttdeci">std::vector&lt; UnitCell &gt; make_lattice_points(const Eigen::Matrix3l &amp;transformation_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="_integral_coordinate_within_8cc_source.html#l00108">IntegralCoordinateWithin.cc:108</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a0ef7d791084d03ec1c4e1f6791bd8505"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a0ef7d791084d03ec1c4e1f6791bd8505">CASM::xtal::make_superstructure&lt; long, 0 &gt;</a></div><div class="ttdeci">template BasicStructure make_superstructure&lt; long, 0 &gt;(const BasicStructure &amp;tiling_unit, const Eigen::Matrix&lt; long, 3, 3, 0 &gt; &amp;transformation_matrix)</div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a19fefd7cadbb3d0d6dc50e232464bf86"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a19fefd7cadbb3d0d6dc50e232464bf86">CASM::xtal::symmetrize</a></div><div class="ttdeci">BasicStructure symmetrize(const BasicStructure &amp;structure, const std::vector&lt; SymOp &gt; &amp;enforced_group)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00609">BasicStructureTools.cc:609</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a258b215615b0e85c00cef701eaf2e5f4"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a258b215615b0e85c00cef701eaf2e5f4">CASM::xtal::make_factor_group</a></div><div class="ttdeci">std::vector&lt; SymOp &gt; make_factor_group(const BasicStructure &amp;struc, double tol=TOL)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00466">BasicStructureTools.cc:466</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a49b7bd361888f937640d376abf72a2c0"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a49b7bd361888f937640d376abf72a2c0">CASM::xtal::make_permutation_representation</a></div><div class="ttdeci">std::vector&lt; Eigen::PermutationMatrix&lt; Eigen::Dynamic, Eigen::Dynamic, Index &gt; &gt; make_permutation_representation(const xtal::BasicStructure &amp;struc, const std::vector&lt; SymOp &gt; &amp;factor_group)</div><div class="ttdoc">Create the permutation group of a structure.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00523">BasicStructureTools.cc:523</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a73316def5404c519e7a5504f0d850f08"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a73316def5404c519e7a5504f0d850f08">CASM::xtal::sort_factor_group</a></div><div class="ttdeci">void sort_factor_group(std::vector&lt; SymOp &gt; &amp;factor_group, const Lattice &amp;lat)</div><div class="ttdoc">Sort SymOp in the SymGroup.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00383">BasicStructureTools.cc:383</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a7929a79fc159de4268f95eecc0ff7a32"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a7929a79fc159de4268f95eecc0ff7a32">CASM::xtal::calc_rotation_angle_and_axis</a></div><div class="ttdeci">std::pair&lt; double, Eigen::Vector3d &gt; calc_rotation_angle_and_axis(const SymOp &amp;op, const Lattice &amp;lat)</div><div class="ttdoc">Calculates the rotation angle and axis of a symmetry operation. This function is almost exactly ident...</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00323">BasicStructureTools.cc:323</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a8be6264f95230f1aea3f67c17e65d427"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a8be6264f95230f1aea3f67c17e65d427">CASM::xtal::make_primitive</a></div><div class="ttdeci">BasicStructure make_primitive(const BasicStructure &amp;non_primitive_struc, double tol=TOL)</div><div class="ttdoc">Returns the smallest possible tiling unit of the given structure.</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00250">BasicStructureTools.cc:250</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_a9bc595622c9f82c19a2d54dd319dbb27"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#a9bc595622c9f82c19a2d54dd319dbb27">CASM::xtal::is_primitive</a></div><div class="ttdeci">bool is_primitive(const BasicStructure &amp;struc, double tol=TOL)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00244">BasicStructureTools.cc:244</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_aa3543105c731d1653cfe5fcd8fdabe4b"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#aa3543105c731d1653cfe5fcd8fdabe4b">CASM::xtal::make_superlattice_coordinate</a></div><div class="ttdeci">Coordinate make_superlattice_coordinate(const UnitCell &amp;ijk, const Superlattice &amp;superlattice)</div><div class="ttdef"><b>Definition:</b> <a href="_unit_cell_coord_8cc_source.html#l00112">UnitCellCoord.cc:112</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_aa9d6d98eff4f536033eb18beda8d07bb"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#aa9d6d98eff4f536033eb18beda8d07bb">CASM::xtal::niggli</a></div><div class="ttdeci">Lattice niggli(const Lattice &amp;in_lat, double compare_tol, bool keep_handedness=false)</div><div class="ttdef"><b>Definition:</b> <a href="_niggli_8cc_source.html#l00330">Niggli.cc:330</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_aaaa495d9f9f7f10f7703f6ac1dfb2a01"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#aaaa495d9f9f7f10f7703f6ac1dfb2a01">CASM::xtal::make_superstructure&lt; int, 0 &gt;</a></div><div class="ttdeci">template BasicStructure make_superstructure&lt; int, 0 &gt;(const BasicStructure &amp;tiling_unit, const Eigen::Matrix&lt; int, 3, 3, 0 &gt; &amp;transformation_matrix)</div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_ab804ac22f44ba36729881c35cb2fb096"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#ab804ac22f44ba36729881c35cb2fb096">CASM::xtal::find_index</a></div><div class="ttdeci">Index find_index(const std::vector&lt; Site &gt; &amp;basis, const Site &amp;test_site, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00233">BasicStructureTools.cc:233</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_acce70bca45c064241f9430d637dc6349"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#acce70bca45c064241f9430d637dc6349">CASM::xtal::make_superstructure</a></div><div class="ttdeci">BasicStructure make_superstructure(const BasicStructure &amp;tiling_unit, const Eigen::Matrix&lt; IntegralType, 3, 3, Options &gt; &amp;transformation_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_tools_8cc_source.html#l00653">BasicStructureTools.cc:653</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_ae137eba34c546641e8dfb1a441a29ddd"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#ae137eba34c546641e8dfb1a441a29ddd">CASM::xtal::make_point_group</a></div><div class="ttdeci">std::vector&lt; SymOp &gt; make_point_group(Lattice const &amp;_lat)</div><div class="ttdoc">Populate.</div><div class="ttdef"><b>Definition:</b> <a href="crystallography_2_sym_tools_8cc_source.html#l00113">SymTools.cc:113</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_1_1xtal_html_aee7426b4e646caadf98ed9dd79108fbc"><div class="ttname"><a href="namespace_c_a_s_m_1_1xtal.html#aee7426b4e646caadf98ed9dd79108fbc">CASM::xtal::SymOpVector</a></div><div class="ttdeci">std::vector&lt; SymOp &gt; SymOpVector</div><div class="ttdef"><b>Definition:</b> <a href="_canonical_form_8hh_source.html#l00013">CanonicalForm.hh:12</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html"><div class="ttname"><a href="namespace_c_a_s_m.html">CASM</a></div><div class="ttdoc">Main CASM namespace.</div><div class="ttdef"><b>Definition:</b> <a href="_a_p_i_command_8hh_source.html#l00008">APICommand.hh:8</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a0141b3c03c8b8006102d53cf9279d9dd"><div class="ttname"><a href="namespace_c_a_s_m.html#a0141b3c03c8b8006102d53cf9279d9dd">CASM::almost_equal</a></div><div class="ttdeci">bool almost_equal(ClusterInvariants const &amp;A, ClusterInvariants const &amp;B, double tol)</div><div class="ttdoc">Check if ClusterInvariants are equal.</div><div class="ttdef"><b>Definition:</b> <a href="_cluster_invariants_8cc_source.html#l00036">ClusterInvariants.cc:36</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a4afad0f276101a30d9239372e963976b"><div class="ttname"><a href="namespace_c_a_s_m.html#a4afad0f276101a30d9239372e963976b">CASM::swap</a></div><div class="ttdeci">void swap(ConfigDoF &amp;A, ConfigDoF &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="_config_do_f_8cc_source.html#l00260">ConfigDoF.cc:260</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a71b214017b27f6027f6dc8ba848651a7"><div class="ttname"><a href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">CASM::TOL</a></div><div class="ttdeci">const double TOL</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8hh_source.html#l00030">definitions.hh:30</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a89a5a207d869cba7f5a9b83eca9ccffe"><div class="ttname"><a href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">CASM::almost_zero</a></div><div class="ttdeci">bool almost_zero(const T &amp;val, double tol=TOL)</div><div class="ttdoc">If T is not integral, use std::abs(val) &lt; tol;.</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__math_8hh_source.html#l00104">CASM_math.hh:104</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a9a375f96cb8c89bfe672017d47e62572"><div class="ttname"><a href="namespace_c_a_s_m.html#a9a375f96cb8c89bfe672017d47e62572">CASM::float_sgn</a></div><div class="ttdeci">int float_sgn(T val, double compare_tol=TOL)</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__math_8hh_source.html#l00188">CASM_math.hh:188</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_a9b03bd008c2c9c175d9a39f800240283"><div class="ttname"><a href="namespace_c_a_s_m.html#a9b03bd008c2c9c175d9a39f800240283">CASM::float_lexicographical_compare</a></div><div class="ttdeci">bool float_lexicographical_compare(const Eigen::Ref&lt; const Eigen::MatrixXd &gt; &amp;A, const Eigen::Ref&lt; const Eigen::MatrixXd &gt; &amp;B, double tol)</div><div class="ttdoc">Floating point lexicographical comparison with tol.</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m___eigen__math_8hh_source.html#l00045">CASM_Eigen_math.hh:45</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_acc40b6c3fb4765f678d85c378f940ccd"><div class="ttname"><a href="namespace_c_a_s_m.html#acc40b6c3fb4765f678d85c378f940ccd">CASM::CART</a></div><div class="ttdeci">const COORD_TYPE CART</div><div class="ttdef"><b>Definition:</b> <a href="global_2enum_8hh_source.html#l00009">enum.hh:9</a></div></div>
<div class="ttc" id="anamespace_c_a_s_m_html_aeb5d5a2111693f4d1eb9a34b58cef6fb"><div class="ttname"><a href="namespace_c_a_s_m.html#aeb5d5a2111693f4d1eb9a34b58cef6fb">CASM::Index</a></div><div class="ttdeci">INDEX_TYPE Index</div><div class="ttdoc">For long integer indexing:</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8hh_source.html#l00039">definitions.hh:39</a></div></div>
<div class="ttc" id="asettings_8cc_html_ad5425481f21e611bf815fc00d454467a"><div class="ttname"><a href="settings_8cc.html#ad5425481f21e611bf815fc00d454467a">set</a></div><div class="ttdeci">ProjectSettings &amp; set</div><div class="ttdef"><b>Definition:</b> <a href="settings_8cc_source.html#l00137">settings.cc:137</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_do_f_set_is_equivalent__f_html"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_do_f_set_is_equivalent__f.html">CASM::xtal::DoFSetIsEquivalent_f</a></div><div class="ttdef"><b>Definition:</b> <a href="crystallography_2_do_f_set_8hh_source.html#l00149">DoFSet.hh:149</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_sym_op_html"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html">CASM::xtal::SymOp</a></div><div class="ttdef"><b>Definition:</b> <a href="_sym_type_8hh_source.html#l00022">SymType.hh:22</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_sym_op_html_a0a4018d2a64d7f4247474e28d028a1b1"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a0a4018d2a64d7f4247474e28d028a1b1">CASM::xtal::SymOp::identity</a></div><div class="ttdeci">static SymOp identity()</div><div class="ttdef"><b>Definition:</b> <a href="_sym_type_8hh_source.html#l00029">SymType.hh:29</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_sym_op_html_a10c3b8e242aea6de6840e0c7f076ced7"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a10c3b8e242aea6de6840e0c7f076ced7">CASM::xtal::SymOp::translation_operation</a></div><div class="ttdeci">static SymOp translation_operation(const SymOpTranslationType &amp;translation)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_type_8hh_source.html#l00039">SymType.hh:39</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_sym_op_html_a6aec538883a7177af78f533842c8a233"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a6aec538883a7177af78f533842c8a233">CASM::xtal::SymOp::matrix</a></div><div class="ttdeci">SymOpMatrixType matrix</div><div class="ttdef"><b>Definition:</b> <a href="_sym_type_8hh_source.html#l00047">SymType.hh:47</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_sym_op_html_a8604ca9aa12e54f3681eafc5cd1914a5"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#a8604ca9aa12e54f3681eafc5cd1914a5">CASM::xtal::SymOp::translation</a></div><div class="ttdeci">SymOpTranslationType translation</div><div class="ttdef"><b>Definition:</b> <a href="_sym_type_8hh_source.html#l00048">SymType.hh:48</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_sym_op_html_abbdb84f849df80928097940d35ebe6e7"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#abbdb84f849df80928097940d35ebe6e7">CASM::xtal::SymOp::is_time_reversal_active</a></div><div class="ttdeci">SymOpTimeReversalType is_time_reversal_active</div><div class="ttdef"><b>Definition:</b> <a href="_sym_type_8hh_source.html#l00049">SymType.hh:49</a></div></div>
<div class="ttc" id="astruct_c_a_s_m_1_1xtal_1_1_sym_op_html_aef062feb90e9e7ebb5b33873df82b237"><div class="ttname"><a href="struct_c_a_s_m_1_1xtal_1_1_sym_op.html#aef062feb90e9e7ebb5b33873df82b237">CASM::xtal::SymOp::time_reversal</a></div><div class="ttdeci">static SymOp time_reversal()</div><div class="ttdef"><b>Definition:</b> <a href="_sym_type_8hh_source.html#l00034">SymType.hh:34</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1b1ebb90c7bf70e8cab253691ef0700c.html">casm</a></li><li class="navelem"><a class="el" href="dir_1b8938a455f5ebac00deef2b41570a20.html">crystallography</a></li><li class="navelem"><a class="el" href="_basic_structure_tools_8cc.html">BasicStructureTools.cc</a></li>
    <li class="footer">Generated on Tue Mar 23 2021 14:16:46 for CASM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
