<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>CASM: /Users/bpuchala/Work/codes/CASMcode_v0.2.X_reference/src/casm/crystallography/Structure.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CASM
   </div>
   <div id="projectbrief">AClustersApproachtoStatisticalMechanics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_structure_8cc_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Modules</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Structure.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_structure_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_structure_8hh.html">casm/crystallography/Structure.hh</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_site_cluster_8hh.html">casm/clusterography/SiteCluster.hh</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_orbitree_8hh.html">casm/clusterography/Orbitree.hh</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="json_clust_8hh.html">casm/clusterography/jsonClust.hh</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="algorithm_8hh.html">casm/misc/algorithm.hh</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_c_a_s_m.html">CASM</a> {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="comment">//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a30fba7c7f5922a35d3473df0b8ce8be7">   18</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html#a10795799a8f9041461f823547a14dc9b">Structure::Structure</a>(<span class="keyword">const</span> <a class="code" href="namespace_c_a_s_m_1_1_import__impl.html#a9ba4c7572b4f76374009b80af84a3d8ca8df396e95c9bd31111a8ede0ab7ebec4">fs::path</a> &amp;filepath) : <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html">BasicStructure</a>&lt;<a class="code" href="class_c_a_s_m_1_1_site.html">Site</a>&gt;() {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span>(!fs::exists(filepath)) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;Error in Structure::Structure(const fs::path &amp;filepath).&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;  File does not exist at: &quot;</span> &lt;&lt; filepath &lt;&lt; std::endl;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      exit(1);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    }</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    fs::ifstream infile(filepath);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#aafb695e0f054d17249f14b2e6c7f7e53">read</a>(infile);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#ae87592a49fe2fb416036f888b437448f">   31</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html#a10795799a8f9041461f823547a14dc9b">Structure::Structure</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;RHS) :</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html">BasicStructure</a>&lt;<a class="code" href="class_c_a_s_m_1_1_site.html">Site</a>&gt;(RHS) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#abc0cfc709840d223bd41bebf9a32e96a">copy_attributes_from</a>(RHS);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  };</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#ac456c1cf9228707cbc8940b53b353ddf">   40</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;<a class="code" href="class_c_a_s_m_1_1_structure.html#ac456c1cf9228707cbc8940b53b353ddf">Structure::operator=</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;RHS) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2f79db2e8427199093a3487639c2e18b">BasicStructure&lt;Site&gt;::operator=</a>(RHS);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//Following gets done by base class</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//lattice = RHS.lattice;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//basis = RHS.basis;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//title = RHS.title;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">    for(Index i = 0; i &lt; basis.size(); i++) {</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">      basis[i].set_lattice(lattice);</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#abc0cfc709840d223bd41bebf9a32e96a">copy_attributes_from</a>(RHS);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#abc0cfc709840d223bd41bebf9a32e96a">   62</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#abc0cfc709840d223bd41bebf9a32e96a">Structure::copy_attributes_from</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;RHS) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2d9cc96452fc1d5b046038fc9217e967">BasicStructure&lt;Site&gt;::copy_attributes_from</a>(RHS);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#abeafcaf64a4e7790db7442867f6a2d35">SD_flag</a> = RHS.<a class="code" href="class_c_a_s_m_1_1_structure.html#abeafcaf64a4e7790db7442867f6a2d35">SD_flag</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a274512883a57f449990a62bfdb68551f">basis_perm_rep_ID</a> = RHS.<a class="code" href="class_c_a_s_m_1_1_structure.html#a274512883a57f449990a62bfdb68551f">basis_perm_rep_ID</a>; <span class="comment">//this *should* work</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a> = RHS.<a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#aa808b6e65565ae9b7277de1934d45ffa">set_lattice</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aca97accc5e038e198e8e37f1d615afe2">   77</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#aca97accc5e038e198e8e37f1d615afe2">Structure::generate_factor_group_slow</a>(<span class="keywordtype">double</span> map_tol)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#ae36732d3425b628eaf02a2a4094f1e9e">clear</a>();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#aa808b6e65565ae9b7277de1934d45ffa">set_lattice</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a758801dc02a507f1365a5a45ba3cb184">BasicStructure&lt;Site&gt;::generate_factor_group_slow</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>, map_tol);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aab8aeba4dbb29b4e39cde3511e8a4bec">   85</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#aab8aeba4dbb29b4e39cde3511e8a4bec">Structure::generate_factor_group</a>(<span class="keywordtype">double</span> map_tol)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#ae36732d3425b628eaf02a2a4094f1e9e">clear</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#aa808b6e65565ae9b7277de1934d45ffa">set_lattice</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;GENERATING STRUCTURE FACTOR GROUP &quot; &lt;&lt; &amp;m_factor_group &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a335908405b2a5724dc742d125fd12887">BasicStructure&lt;Site&gt;::generate_factor_group</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>, map_tol);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">   94</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_master_sym_group.html">MasterSymGroup</a> &amp;<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">Structure::factor_group</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>())</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#aab8aeba4dbb29b4e39cde3511e8a4bec">generate_factor_group</a>();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aee3a422237a9366b9323e68163b548b0">  101</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> &amp;<a class="code" href="class_c_a_s_m_1_1_structure.html#aee3a422237a9366b9323e68163b548b0">Structure::point_group</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>().<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#a16e9aa4122b2b4b6efbd39c5a673ec45">point_group</a>();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a3275b25a6fb08af4baa200f4e4d2809d">  107</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_sym_group_rep.html">SymGroupRep</a> <span class="keyword">const</span> *<a class="code" href="class_c_a_s_m_1_1_structure.html#a3275b25a6fb08af4baa200f4e4d2809d">Structure::basis_permutation_symrep</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span> &amp;(<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>().<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#abdab8f7779422c2c90fb25c721f74ef2">representation</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a32d00f62c499164237827346bc0f3897">basis_permutation_symrep_ID</a>()));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a32d00f62c499164237827346bc0f3897">  113</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_sym_group_rep_i_d.html">SymGroupRepID</a> <a class="code" href="class_c_a_s_m_1_1_structure.html#a32d00f62c499164237827346bc0f3897">Structure::basis_permutation_symrep_ID</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a274512883a57f449990a62bfdb68551f">basis_perm_rep_ID</a>.<a class="code" href="class_c_a_s_m_1_1_sym_group_rep_i_d.html#ab9fe6fc494b40c34e3185d2c21a30b8d">empty</a>())</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#a0afd98ba44747b0bfc52a000b281d131">generate_basis_permutation_representation</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a274512883a57f449990a62bfdb68551f">basis_perm_rep_ID</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aa0cb3d437cbd7d05cf7503808d897cf0">  123</a></span>&#160;  std::vector&lt;Specie&gt; <a class="code" href="class_c_a_s_m_1_1_structure.html#aa0cb3d437cbd7d05cf7503808d897cf0">Structure::get_struc_specie</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    std::vector&lt;Molecule&gt; struc_molecule = <a class="code" href="class_c_a_s_m_1_1_structure.html#a00a515632e929b13fe0ac7005c96cfea">get_struc_molecule</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::vector&lt;Specie&gt; struc_specie;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i, j;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">//For each molecule type</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; struc_molecule.size(); i++) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// For each atomposition in the molecule</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; struc_molecule[i].size(); j++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="namespace_c_a_s_m.html#abaf3dc70b7ec68e71a693d80f3b99fca">contains</a>(struc_specie, struc_molecule[i][j].specie)) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          struc_specie.push_back(struc_molecule[i][j].specie);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> struc_specie;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a00a515632e929b13fe0ac7005c96cfea">  146</a></span>&#160;  std::vector&lt;Molecule&gt; <a class="code" href="class_c_a_s_m_1_1_structure.html#a00a515632e929b13fe0ac7005c96cfea">Structure::get_struc_molecule</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::vector&lt;Molecule&gt; struc_molecule;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i, j;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">//loop over all Sites in basis</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">//loop over all Molecules in Site</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">//Collect unique Molecules</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="namespace_c_a_s_m.html#abaf3dc70b7ec68e71a693d80f3b99fca">contains</a>(struc_molecule, <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant()[j])) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          struc_molecule.push_back(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant()[j]);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }<span class="comment">//end loop over all Sites</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> struc_molecule;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a6208c7211ddf90623b76caca0f04cd89">  166</a></span>&#160;  std::vector&lt;std::string&gt; <a class="code" href="class_c_a_s_m_1_1_structure.html#a6208c7211ddf90623b76caca0f04cd89">Structure::get_struc_molecule_name</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// get Molecule allowed in prim, and how many there are</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    std::vector&lt;Molecule&gt; struc_mol = <a class="code" href="class_c_a_s_m_1_1_structure.html#a00a515632e929b13fe0ac7005c96cfea">get_struc_molecule</a>();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// store Molecule names in vector</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    std::vector&lt;std::string&gt; struc_mol_name;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; struc_mol.size(); i++) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      struc_mol_name.push_back(struc_mol[i].name);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> struc_mol_name;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a77096ea1b4e9cf91135278937b5a14e7">  184</a></span>&#160;  Eigen::VectorXi <a class="code" href="class_c_a_s_m_1_1_structure.html#a77096ea1b4e9cf91135278937b5a14e7">Structure::get_num_each_specie</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    std::vector&lt;Specie&gt; struc_specie = <a class="code" href="class_c_a_s_m_1_1_structure.html#aa0cb3d437cbd7d05cf7503808d897cf0">get_struc_specie</a>();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    Eigen::VectorXi num_each_specie = Eigen::VectorXi::Zero(struc_specie.size());</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i, j;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// For each site</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">// For each atomposition in the molecule on the site</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].occ().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">// Count the present specie</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        num_each_specie(<a class="code" href="namespace_c_a_s_m.html#a43e98dc6648de583c637f18f7f7503fe">find_index</a>(struc_specie, <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].occ()[j].specie))++;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> num_each_specie;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#ae4e0935a5dcfed612f3ca7d4362084f8">  206</a></span>&#160;  Eigen::VectorXi <a class="code" href="class_c_a_s_m_1_1_structure.html#ae4e0935a5dcfed612f3ca7d4362084f8">Structure::get_num_each_molecule</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    std::vector&lt;Molecule&gt; struc_molecule = <a class="code" href="class_c_a_s_m_1_1_structure.html#a00a515632e929b13fe0ac7005c96cfea">get_struc_molecule</a>();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    Eigen::VectorXi num_each_molecule = Eigen::VectorXi(struc_molecule.size());</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// For each site</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">// Count the molecule</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      num_each_molecule(<a class="code" href="namespace_c_a_s_m.html#a43e98dc6648de583c637f18f7f7503fe">find_index</a>(struc_molecule, <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].occ()))++;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> num_each_molecule;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a57aa47601c56510ef5c559447d800203">  225</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#ab82f33499d2edcf833d426c2bec3415f">Structure::fg_converge</a>(<span class="keywordtype">double</span> small_tol, <span class="keywordtype">double</span> large_tol, <span class="keywordtype">double</span> increment) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#afd88e52455c79ff69628b997fd982cf0">BasicStructure&lt;Site&gt;::fg_converge</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>, small_tol, large_tol, increment);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#ab82f33499d2edcf833d426c2bec3415f">  231</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#ab82f33499d2edcf833d426c2bec3415f">Structure::fg_converge</a>(<span class="keywordtype">double</span> large_tol) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#afd88e52455c79ff69628b997fd982cf0">BasicStructure&lt;Site&gt;::fg_converge</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>, <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>, large_tol, (large_tol - <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>) / 10.0);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">//************************************************************</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">/*void Structure::print_factor_group(std::ostream &amp;stream) const {</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">    stream &lt;&lt; &quot;Factor Group of &quot; &lt;&lt; title &lt;&lt; &quot;, containing &quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">           &lt;&lt; factor_group().size() &lt;&lt; &quot; symmetry operations:\n&quot;;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">    for(Index i = 0; i &lt; m_factor_group.size(); i++) {</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">      m_factor_group[i].print(stream);</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">    return;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a14bd1c736b6a5c0862517baf0333d9a0">  263</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a14bd1c736b6a5c0862517baf0333d9a0">Structure::fill_supercell</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;prim, <span class="keywordtype">double</span> map_tol) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i, j;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> latvec_pg;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#acee4cee62f04718a6279836d77b24cb6">m_lattice</a>.<a class="code" href="class_c_a_s_m_1_1_lattice.html#a0761002315d0e245ffb3e074e788cc31">generate_point_group</a>(latvec_pg);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#abeafcaf64a4e7790db7442867f6a2d35">SD_flag</a> = prim.<a class="code" href="class_c_a_s_m_1_1_structure.html#abeafcaf64a4e7790db7442867f6a2d35">SD_flag</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_prim_grid.html">PrimGrid</a> prim_grid(prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">clear</a>();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> tcoord(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">//loop over basis sites of prim</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span>(j = 0; j &lt; prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">//loop over prim_grid points</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; prim_grid.size(); i++) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">//push back translated basis site of prim onto superstructure basis</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[j] + prim_grid.coord(i, <a class="code" href="namespace_c_a_s_m.html#ab7d92879af881561fdeeda3a01b26368a42b41bfe52012805600e51df2b3dbc21">PRIM</a>));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">//reset lattice for most recent superstructure Site</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">//set_lattice() converts fractional coordinates to be compatible with new lattice</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">back</a>().<a class="code" href="class_c_a_s_m_1_1_site.html#ae21925394c1a4edd4140234b45f2c9ab">set_lattice</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">back</a>().<a class="code" href="class_c_a_s_m_1_1_coordinate.html#af0104bf945ae61b02b64cbd83ba026d6">within</a>();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> k = 0; k &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() - 1; k++) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[k].<a class="code" href="namespace_c_a_s_m.html#aaa391e050b7425ef18412ac1bd24aa6c">compare</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">back</a>(), map_tol)) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a13050039016e76fe3b0d22f7850e373a">pop_back</a>();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;WORKING ON FACTOR GROUP &quot; &lt;&lt; &amp;m_factor_group &lt;&lt; &quot; for structure with volume &quot; &lt;&lt; prim_grid.size() &lt;&lt; &quot;:\n&quot;;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//trans_and_expand primitive factor_group</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; prim.<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">if</span>(latvec_pg.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#ade185ee6fc635fa6bced0f3d0fb8f29f">find_no_trans</a>(prim.<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>()[i]) == latvec_pg.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>()) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; prim_grid.size(); j++) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> t_tau(prim.<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>()[i].tau() + prim_grid.coord(j, <a class="code" href="namespace_c_a_s_m.html#ab7d92879af881561fdeeda3a01b26368a59e8ef72de047f743136a7b89c1b2b31">SCEL</a>).const_cart(), <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          t_tau.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#af0104bf945ae61b02b64cbd83ba026d6">within</a>();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#a9243eb7bc565dd9e8bcdd926ac55319a">push_back</a>(<a class="code" href="class_c_a_s_m_1_1_sym_op.html">SymOp</a>(prim.<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>()[i].matrix(),</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                         t_tau.cart()));</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() &gt; 200) {<span class="comment">// how big is too big? this is at least big enough for FCC conventional cell</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING: You have a very large factor group of a non-primitive structure. Certain symmetry features will be unavailable.\n&quot;</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#a72c30baa8c7fbf67997402f7480f5767">invalidate_multi_tables</a>();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Final size is: &quot; &lt;&lt; m_factor_group.size() &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a6b97b1ab6ada176506cab4438e7c28c7">update</a>();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a7f2f92afcc0bd2dd37d9682937ebbe92">  335</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> <a class="code" href="class_c_a_s_m_1_1_structure.html#a7f2f92afcc0bd2dd37d9682937ebbe92">Structure::create_superstruc</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_lattice.html">Lattice</a> &amp;scel_lat, <span class="keywordtype">double</span> map_tol)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> tsuper(scel_lat);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    tsuper.<a class="code" href="class_c_a_s_m_1_1_structure.html#a14bd1c736b6a5c0862517baf0333d9a0">fill_supercell</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">return</span> tsuper;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">/*shorttag allows the user to decide whether or not to print the</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">   * entire symmetry matrix.  If shorttag=0, then only the name of the</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">   * operation and the eigenvector will be printed.  If it equals anything else,</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">   * then the symmetry operation matrix will be printed out.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a00858666d0ffa7d1b6d610cf445fbea2">  348</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a00858666d0ffa7d1b6d610cf445fbea2">Structure::print_site_symmetry</a>(std::ostream &amp;stream, <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7de">COORD_TYPE</a> mode, <span class="keywordtype">int</span> shorttag = 1, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a> = <a class="code" href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">TOL</a>) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html">GenericOrbitBranch&lt;SiteCluster&gt;</a> asym_unit(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#ab68b73b13412b54639e0388e52926a20">generate_asymmetric_unit</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>, <a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>(), <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    stream &lt;&lt;  <span class="stringliteral">&quot; Printing symmetry operations that leave each site unchanged:\n \n&quot;</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>(); i++) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; asym_unit[i].<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>(); j++) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        stream &lt;&lt; <span class="stringliteral">&quot;Site: &quot;</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a7a55a6676e05dc73609fb3430d4c2897">at</a>(i).at(j).at(0).print(stream); <span class="comment">//Print the site (not cluster) for the asymmetric unit</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        stream &lt;&lt; <span class="stringliteral">&quot; Total Symmetry Operations: &quot;</span> &lt;&lt; asym_unit[i][j].clust_group().<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> nc = 0; nc &lt; asym_unit[i][j].clust_group().<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>(); nc++) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="comment">//print_short is a new fxn I added in SymOp to not print out the whole symmetry matrix</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <span class="keywordflow">if</span>(shorttag == 0) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            stream &lt;&lt;  std::setw(4)  &lt;&lt; nc + 1 &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="comment">//asym_unit[i][j].clust_group()[nc].print_short(stream); // I turned this off because the &quot;print_short&quot; function does not appear to exist...</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            stream.flags(std::ios::left);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            stream &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt;  std::setw(3)  &lt;&lt; nc + 1 &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            stream.unsetf(std::ios::left);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span>(mode == <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;              asym_unit[i][j].clust_group()[nc].<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#ac1ce22835f15775f8afc6c35272975a5">print</a>(stream, Eigen::Matrix3d::Identity());</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;              asym_unit[i][j].clust_group()[nc].<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#ac1ce22835f15775f8afc6c35272975a5">print</a>(stream, <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>().inv_lat_column_mat());</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        stream &lt;&lt; <span class="stringliteral">&quot;\n  ---------------------------------------------------------------------   \n\n&quot;</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a1e88d140e18817670fd98f35fd6d8be9">  385</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a1e88d140e18817670fd98f35fd6d8be9">Structure::reset</a>() {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;begin reset() &quot; &lt;&lt; this &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> nb = 0; nb &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); nb++) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[nb].set_basis_ind(nb);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a90a060200671d8faa9e902e6d44619fb">within</a>();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#ae36732d3425b628eaf02a2a4094f1e9e">clear</a>();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;finish reset()&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a96967eb1b76165970cbf2026b9fde4ac">  410</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a96967eb1b76165970cbf2026b9fde4ac">Structure::generate_flowertrees</a>(<span class="keyword">const</span> <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> &amp;in_tree, <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;SiteOrbitree&gt;</a> &amp;out_trees, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span>(out_trees.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() != 0) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING in Structure::generate_flowertrees_safe&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;The provided array of SiteOrbitree wasn&#39;t empty! Hope nothing important was there...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      out_trees.<a class="code" href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">clear</a>();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">//Theres a flowertree for each basis site b</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> b = 0; b &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); b++) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> ttree(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), tol);   <span class="comment">//Weird behavior without this</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      ttree.<a class="code" href="group___array.html#ga34b55c27718e49a5e3db20ee71a7bcaf">reserve</a>(in_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>());</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      out_trees.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(ttree);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="comment">//We want clusters of every size in the tree, except the 0th term (...right guys?)</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> s = 1; s &lt; in_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>(); s++) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">//Make each site basis into a cluster so we can use extract_orbits_including</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="class_c_a_s_m_1_1_site_cluster.html">SiteCluster</a> tsiteclust(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        tsiteclust.<a class="code" href="singleton_c_a_s_m_1_1_generic_cluster.html#a16cdd2f07808decf80464a49eaf1fdc1">within</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        tsiteclust.<a class="code" href="class_c_a_s_m_1_1_site_cluster.html#af0b7ec42ae9a13ec8fe5d225b789e61c">push_back</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[b]);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">//Make a branch where all the clusters of a given size s go</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html">SiteOrbitBranch</a> tbranch(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">//Push back flower onto tree</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        out_trees[b].<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(tbranch);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">//Get one flower for a given basis site</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        in_tree[s].extract_orbits_including(tsiteclust, out_trees[b].back(), tol);  <span class="comment">//couldn&#39;t get it to work withough directly passing tree.back() (i.e. can&#39;t make branch then push_back)</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      out_trees[b].get_index();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      out_trees[b].collect_basis_info(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// Fills an orbitree such that each OrbitBranch corresponds to a basis site and contains all orbits</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// that include that basis site</span></div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a6529b1770a3d3123f489ca82da758c46">  446</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a6529b1770a3d3123f489ca82da758c46">Structure::generate_basis_bouquet</a>(<span class="keyword">const</span> <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> &amp;in_tree, <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> &amp;out_tree, <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> num_sites, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> na, np, nb, ne;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    out_tree.<a class="code" href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">clear</a>(); <span class="comment">//Added by Ivy 11/07/12</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">//make room in out_tree for flowers</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">//out_tree.reserve(basis.size());</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a1bbc2b205bd236b432abaaa1a9327821">lattice</a> = in_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a1bbc2b205bd236b432abaaa1a9327821">lattice</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">//out_tree.set_lattice(in_tree.lattice,FRAC);   //better?</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">//get asymmetric unit</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html">GenericOrbitBranch&lt;SiteCluster&gt;</a> asym_unit(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#ab68b73b13412b54639e0388e52926a20">generate_asymmetric_unit</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>, <a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>(), tol);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">for</span>(na = 0; na &lt; asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>(); na++) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a2581d6db8d6bbb0ccedabc12adc576f8">prototype</a>(na).clust_group().character_table();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;Working on asym_unit element &quot; &lt;&lt; na + 1 &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      nb = out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="comment">//Add new branch with asym_unit.prototype(na) as pivot</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a9622bd956345a475da4360b6c0d43f86">push_back</a>(<a class="code" href="namespace_c_a_s_m.html#a8bb1a3cab5b3a60e1cd2bb54746af874">SiteOrbitBranch</a>(asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a2581d6db8d6bbb0ccedabc12adc576f8">prototype</a>(na)));</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">for</span>(np = 0; np &lt; in_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>(); np++) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span>(num_sites != in_tree[np].num_sites()) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;Starting to extract petals from OrbitBranch &quot; &lt;&lt; np &lt;&lt; &#39;\n&#39;;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        in_tree[np].extract_orbits_including(asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a2581d6db8d6bbb0ccedabc12adc576f8">prototype</a>(na), out_tree.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">back</a>(), <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">for</span>(ne = 1; ne &lt; asym_unit[na].equivalence_map.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>(); ne++) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a9622bd956345a475da4360b6c0d43f86">push_back</a>(out_tree[nb]);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        out_tree.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">back</a>().apply_sym(asym_unit[na].equivalence_map[ne][0]);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">//out_tree.get_index(); //Should not get_index because we want to keep the in_tree indices Ivy 01/15/14</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a82ce80232745f47d38887306e54818e9">collect_basis_info</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// Added by Ivy 10/17/12</span></div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a2ed7448e1d25e9dc67e051f4766b6c4f">  501</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a2ed7448e1d25e9dc67e051f4766b6c4f">Structure::generate_asym_bouquet</a>(<span class="keyword">const</span> <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> &amp;in_tree, <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> &amp;out_tree, <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> num_sites, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> na, np;<span class="comment">//, nb;</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    out_tree.<a class="code" href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">clear</a>();</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">//get asymmetric unit</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html">GenericOrbitBranch&lt;SiteCluster&gt;</a> asym_unit(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#ab68b73b13412b54639e0388e52926a20">generate_asymmetric_unit</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>, <a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>(), tol);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">//make room in out_tree for flowers</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    out_tree.<a class="code" href="group___array.html#ga34b55c27718e49a5e3db20ee71a7bcaf">reserve</a>(asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>());</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a1bbc2b205bd236b432abaaa1a9327821">lattice</a> = in_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a1bbc2b205bd236b432abaaa1a9327821">lattice</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">for</span>(na = 0; na &lt; asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">size</a>(); na++) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="comment">//nb = out_tree.size();</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="comment">//Add new branch with asym_unit.prototype(na) as pivot</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a9622bd956345a475da4360b6c0d43f86">push_back</a>(<a class="code" href="namespace_c_a_s_m.html#a8bb1a3cab5b3a60e1cd2bb54746af874">SiteOrbitBranch</a>(asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a2581d6db8d6bbb0ccedabc12adc576f8">prototype</a>(na)));</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordflow">for</span>(np = 0; np &lt; in_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>(); np++) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span>(num_sites != in_tree[np].num_sites()) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="comment">//prototype of na orbit</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        in_tree[np].extract_orbits_including(asym_unit.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a2581d6db8d6bbb0ccedabc12adc576f8">prototype</a>(na), out_tree.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">back</a>(), <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">//out_tree.get_index(); //Should not get_index because we want to keep the in_tree indices Ivy 01/15/14</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    out_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a82ce80232745f47d38887306e54818e9">collect_basis_info</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">//John G 230913</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a9df24931a4fa76f969575e91ad00a208">  562</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a9df24931a4fa76f969575e91ad00a208">Structure::generate_flowertrees_safe</a>(<span class="keyword">const</span> <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> &amp;in_tree, <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;SiteOrbitree&gt;</a> &amp;out_trees, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>) { <span class="comment">//can we make it const? It would require generate_basis_bouquet to also be const</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">if</span>(out_trees.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() != 0) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING in Structure::generate_flowertrees_safe&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;The provided array of SiteOrbitree wasn&#39;t empty! Hope nothing important was there...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      out_trees.<a class="code" href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">clear</a>();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">//Determine what the largest cluster in the given orbitree is, accounting for the fact that there&#39;s a 0 point cluster</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> max_clust_size = in_tree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>() - 1;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">//Plant all the bouquets, one for each cluster size and store them in</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;SiteOrbitree&gt;</a> bouquets;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 1; i &lt; (max_clust_size + 1); i++) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> tbouquet(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), tol);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#a6529b1770a3d3123f489ca82da758c46">generate_basis_bouquet</a>(in_tree, tbouquet, i, tol);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      bouquets.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(tbouquet);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">//Pluck a branch off each bouquet for a given basis site and stuff it into a SiteOribitree (this is a flowertree)</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">//SiteOrbitree tbouquet=in_tree;   //This is so I don&#39;t have to worry about initializing things I&#39;m scared of</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> tbouquet(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), tol);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">//How many flowertrees do we need? As many as there are basis sites, i.e. bouquet[i].size();</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      tbouquet.<a class="code" href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">clear</a>();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">//How many trees, i.e. cluster sizes</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; bouquets.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">//Not pushing back empty cluster!!</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        tbouquet.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a9622bd956345a475da4360b6c0d43f86">push_back</a>(bouquets[j][i]);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      tbouquet.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#abf7f305316afe9ebfe689b09ea3b7074">get_index</a>();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      tbouquet.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a82ce80232745f47d38887306e54818e9">collect_basis_info</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      out_trees.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(tbouquet);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">//\John G 230913</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#abf4306563beb5ec63bf5e1cc3484b985">  605</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#abf4306563beb5ec63bf5e1cc3484b985">Structure::map_superstruc_to_prim</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;prim) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> prim_to_scel;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_site.html">Site</a> shifted_site(prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">//Check that (*this) is actually a supercell of the prim</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>().<a class="code" href="class_c_a_s_m_1_1_lattice.html#a91754f146800dd4b79ae7f8d08041fad">is_supercell_of</a>(prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), prim.<a class="code" href="class_c_a_s_m_1_1_structure.html#aee3a422237a9366b9323e68163b548b0">point_group</a>())) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;*******************************************\n&quot;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;ERROR in Structure::map_superstruc_to_prim:\n&quot;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;The structure \n&quot;</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      std::cerr &lt;&lt; <a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a>(*<span class="keyword">this</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;is not a supercell of the given prim!\n&quot;</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      std::cerr &lt;&lt; <a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a>(prim) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;*******************************************\n&quot;</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      exit(1);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">//Get prim grid of supercell to get the lattice translations</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">//necessary to stamp the prim in the superstructure</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_prim_grid.html">PrimGrid</a> prim_grid(prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// Translate each of the prim atoms by prim_grid translation</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// vectors, and map that translated atom in the supercell.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> pg = 0; pg &lt; prim_grid.size(); pg++) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> pb = 0; pb &lt; prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); pb++) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        shifted_site = prim.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[pb];</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        shifted_site += prim_grid.coord(pg, <a class="code" href="namespace_c_a_s_m.html#ab7d92879af881561fdeeda3a01b26368a42b41bfe52012805600e51df2b3dbc21">PRIM</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        shifted_site.set_lattice(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        shifted_site.within();</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">// invalidate asym_ind and basis_ind because when we use</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="comment">// Structure::find, we don&#39;t want a comparison using the</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">// basis_ind and asym_ind; we want a comparison using the</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">// cartesian and Specie type.</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        shifted_site.set_basis_ind(-1);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        prim_to_scel = <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a04224a7ad00a5870b56187a2db07ae5a">find</a>(shifted_site);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span>(prim_to_scel == <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>()) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          std::cerr &lt;&lt; <span class="stringliteral">&quot;*******************************************\n&quot;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;ERROR in Structure::map_superstruc_to_prim:\n&quot;</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Cannot associate site \n&quot;</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    &lt;&lt; shifted_site &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;with a site in the supercell basis. \n&quot;</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;*******************************************\n&quot;</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          std::cerr &lt;&lt; <span class="stringliteral">&quot;The basis_ind is &quot;</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    &lt;&lt; shifted_site.basis_ind() &lt;&lt; <span class="stringliteral">&quot;\n &quot;</span>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          exit(2);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">// Set ind_to_prim of the basis site</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="comment">//basis[prim_to_scel].ind_to_prim = pb;</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  };</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#adef79f5cc9e9ae200841a1af56a5b65b">  664</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#adef79f5cc9e9ae200841a1af56a5b65b">Structure::set_lattice</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_lattice.html">Lattice</a> &amp;new_lat, <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7de">COORD_TYPE</a> mode) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">bool</span> is_equiv(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>() == new_lat);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#acee4cee62f04718a6279836d77b24cb6">m_lattice</a> = new_lat;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> nb = 0; nb &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); nb++) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[nb].set_lattice(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), mode);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span>(is_equiv)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_sym_group.html#aa808b6e65565ae9b7277de1934d45ffa">set_lattice</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#a1e88d140e18817670fd98f35fd6d8be9">reset</a>();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a1ad65f317107d806b3edd31714b334c2">  692</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> <a class="code" href="class_c_a_s_m_1_1_structure.html#a1ad65f317107d806b3edd31714b334c2">Structure::stack_on</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;understruc, <span class="keywordtype">bool</span> <span class="keyword">override</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> overstruc(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">//Before doing anything check to see that lattices are aligned correctly (paralled ab planes)</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span>(!<span class="keyword">override</span>) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordtype">double</span> axbangle = <a class="code" href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">angle</a>(understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0].cross(understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1]), overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0].cross(overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1]));</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordflow">if</span>(!<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>(axbangle)) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR in Structure::stack_on&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;Lattice mismatch! Your structures are oriented differently in space. ab planes of structures must be parallel before stacking.\</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral">                    Redefine your structure or use Structure::align_with to fix issue.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;Your vectors were:\n&quot;</span> &lt;&lt; understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0].cross(understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1]) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0].cross(overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1]) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        exit(13);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="comment">//Also check if c axes are on the same side of abplane</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="comment">//else if</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="comment">//{</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="comment">//}</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING in Structure::stack_on&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;You&#39;ve chosen to ignore if ab planes of your structures are not parallel and/or c axes point the right way.\</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">                This will almost surely result in a malformed structure. Do not take the output for granted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//First stretch a and b of overstruc to match a and b of understruc</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_lattice.html">Lattice</a> newoverstruclat(understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0],</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                            understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1],</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                            overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[2]);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    overstruc.<a class="code" href="class_c_a_s_m_1_1_structure.html#adef79f5cc9e9ae200841a1af56a5b65b">set_lattice</a>(newoverstruclat, <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7deab070d36e7a4e90de65c1278e7cd0bed0">FRAC</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">//Create a lattice big enough to fit both structures</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_lattice.html">Lattice</a> heterolat(understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0], <span class="comment">//=overstruc.lattice()[0]</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                      understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1], <span class="comment">//=overstruc.lattice()[1]</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                      understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[2] + overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[2]);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">//Copy understruc and set its lattice to heterolat, keeping its cartesian coordinates.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">//This leaves the basis intact but adds extra space where the overstruc basis can be placed.</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> heterostruc(understruc);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    heterostruc.set_lattice(heterolat, <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">//Fill up empty space in heterostruc with overstruc</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_site.html">Site</a> tsite(overstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i]);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      tsite.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abaa8f4590953e12781949714c6011b3a">cart</a>() = tsite.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abe5a7f4c03e29547f8d7ff1d34c4c8f1">const_cart</a>() + understruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[2];</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      tsite.<a class="code" href="class_c_a_s_m_1_1_site.html#ae21925394c1a4edd4140234b45f2c9ab">set_lattice</a>(heterostruc.lattice(), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      heterostruc.basis.push_back(tsite);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; heterostruc.basis.size(); i++) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      heterostruc.basis[i].within();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    heterostruc.update();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">return</span> heterostruc;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">//\John G 051112</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="comment">//John G 121212</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a174d85a36040421acce971327d72e03e">  769</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> <a class="code" href="class_c_a_s_m_1_1_structure.html#a174d85a36040421acce971327d72e03e">Structure::get_reflection</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> reflectstruc(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    Eigen::Vector3d zreflect;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    zreflect &lt;&lt; 1, 1, -1;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// resets the lattice and reflects cartesian coordinates of the basis atoms</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    reflectstruc.<a class="code" href="class_c_a_s_m_1_1_structure.html#adef79f5cc9e9ae200841a1af56a5b65b">set_lattice</a>(<a class="code" href="class_c_a_s_m_1_1_lattice.html">Lattice</a>(zreflect.asDiagonal() * <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>().<a class="code" href="class_c_a_s_m_1_1_lattice.html#a7925f304b5fa3754e3b20c6c5a84498f">lat_column_mat</a>()), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7deab070d36e7a4e90de65c1278e7cd0bed0">FRAC</a>);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    reflectstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a6b97b1ab6ada176506cab4438e7c28c7">update</a>();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">return</span> reflectstruc;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#ae0e016286499743db16081265aec0dc8">  793</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#ae0e016286499743db16081265aec0dc8">Structure::clump_atoms</a>(<span class="keywordtype">double</span> mindist, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">// Warning, I don&#39;t think we want to do this here, but I&#39;m leaving it in for now - JCT 03/07/14</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a6b97b1ab6ada176506cab4438e7c28c7">update</a>();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">//Define Orbitree just for pairs</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> siamese(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), tol);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    siamese.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a4df42aa2e24670871db29d55b410402a">max_num_sites</a> = 2;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    siamese.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a381762d522e742ae63351b313b835b51">max_length</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(0);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    siamese.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a381762d522e742ae63351b313b835b51">max_length</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(0);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    siamese.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a381762d522e742ae63351b313b835b51">max_length</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(mindist);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    siamese.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a5ada91f6eede699ebe89ff80b8f19825">min_length</a> = 0.0;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    siamese.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a36d6b674443d565debdeaa0ab1c69bbc">min_num_components</a> = 1;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    siamese.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#ac7bd13e31f4a14b27c0c7a4538fd0346">generate_orbitree</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">//Set one atom of the cluster pairs to be at the average distance and flag</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">//the other one for removal later</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; siamese[2].<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>(); i++) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; siamese[2][i].<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>(); j++) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="class_c_a_s_m_1_1_site.html">Site</a> avgsite(siamese[2][i][j][1]);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        avgsite.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abaa8f4590953e12781949714c6011b3a">cart</a>() = (siamese[2][i][j][0].const_cart() + siamese[2][i][j][1].const_cart()) * 0.5;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        avgsite.<a class="code" href="class_c_a_s_m_1_1_site.html#ae21925394c1a4edd4140234b45f2c9ab">set_lattice</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>); <span class="comment">//It&#39;s dumb that I need to do this</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        avgsite.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#af0104bf945ae61b02b64cbd83ba026d6">within</a>();</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;###############&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        std::cout &lt;&lt; siamese[2][i][j][0].basis_ind() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; siamese[2][i][j][0] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        std::cout &lt;&lt; siamese[2][i][j][1].basis_ind() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; siamese[2][i][j][1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;-------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        std::cout &lt;&lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[siamese[2][i][j][0].basis_ind()].basis_ind() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[siamese[2][i][j][0].basis_ind()] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        std::cout &lt;&lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[siamese[2][i][j][1].basis_ind()].basis_ind() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[siamese[2][i][j][1].basis_ind()] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;###############&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[siamese[2][i][j][0].basis_ind()].set_basis_ind(-99);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[siamese[2][i][j][1].basis_ind()].set_basis_ind(-99);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(avgsite);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;BASIS IND:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">//Remove unwanted atoms.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordtype">int</span> bsize = <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>();</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = bsize - 1; i &gt;= 0; i--) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      std::cout &lt;&lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].basis_ind() &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].basis_ind() == <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a>(-99)) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="group___array.html#gaee7403e1ab7714a25b19f3826ce7066f">remove</a>(i);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a6b97b1ab6ada176506cab4438e7c28c7">update</a>();</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a4b6b788cc7e2b76e591aac6ef76c13c1">  858</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a4b6b788cc7e2b76e591aac6ef76c13c1">Structure::sort_basis</a>() {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() - 1; j++) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[j].occ_name() &gt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[j + 1].occ_name()) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa49b28bd3243402eacb01fef829326b1">swap_elem</a>(j, j + 1);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">//John G 050513</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aee15666c923c60231dffd350b543e5df">  888</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> <a class="code" href="class_c_a_s_m_1_1_structure.html#aee15666c923c60231dffd350b543e5df">Structure::stamp_with</a>(<a class="code" href="class_c_a_s_m_1_1_site_cluster.html">SiteCluster</a> stamp, <span class="keywordtype">bool</span> lat_override, <span class="keywordtype">bool</span> im_override)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">//The following check may not work properly</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">if</span>(!lat_override &amp;&amp; !<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>().is_supercell_of((stamp.<a class="code" href="singleton_c_a_s_m_1_1_generic_cluster.html#a7e5f0cd2efc0fc993f7f8fadcdfe9022">home</a>()), <a class="code" href="class_c_a_s_m_1_1_structure.html#aee3a422237a9366b9323e68163b548b0">point_group</a>())) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR in Structure::stamp_with (are you using Structure::bedazzle?)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;The lattice of your cluster is not related to the lattice of the structure you want to stamp!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      exit(60);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">//Some sort of check should happen here to make sure your superstructure</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">//is large enough to accomodate the stamp. Otherwise shit will get messed up</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">//I think image_check is the way to go, but I&#39;m not sure I&#39;m using it correctly</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">//I&#39;m using the default value for nV (1) in image_check. This will allow the cluster</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">//to touch the faces of the voronoi cell.</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">if</span>(!im_override &amp;&amp; stamp.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() &gt; 1 &amp;&amp; stamp.<a class="code" href="singleton_c_a_s_m_1_1_generic_cluster.html#a416cde5978df6c2b5adda5bd342122ea">image_check</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), 1)) {    <span class="comment">//Skip point clusters?</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR in Structure::stamp_with&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;Your superstructure isn&#39;t big enough to fit your cluster!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;Culprit:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      stamp.<a class="code" href="singleton_c_a_s_m_1_1_generic_cluster.html#a5ba2db1fd2813e53babeb83ded1e2e32">print</a>(std::cerr);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      exit(62);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    stamp.<a class="code" href="singleton_c_a_s_m_1_1_generic_cluster.html#a54ba5dff97773ef5fa615d9272b51b4b">set_lattice</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    stamp.<a class="code" href="singleton_c_a_s_m_1_1_generic_cluster.html#a16cdd2f07808decf80464a49eaf1fdc1">within</a>();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> stampedstruc = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> sanity_count = 0;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; stamp.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a>(stamp[i]) == <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a>(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[j])) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          sanity_count++;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          stampedstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[j] = stamp[i];</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span>(sanity_count != stamp.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>()) {  <span class="comment">//Allow if override?</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR in Structure::stamp_with (are you using Structure::bedazzle?)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      std::cerr &lt;&lt; stamp.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() - sanity_count &lt;&lt; <span class="stringliteral">&quot; sites in the cluster (size &quot;</span> &lt;&lt; stamp.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() &lt;&lt; <span class="stringliteral">&quot; did not map onto your structure.\</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="stringliteral">                If you got this far your lattices passed the test, but it seems your bases are unrelated. My guesses:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;You&#39;re trying to map a relaxed site onto an ideal one.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;You have a vacancy in the structure you&#39;re stamping that&#39;s not in the basis.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      exit(61);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    stampedstruc.<a class="code" href="class_c_a_s_m_1_1_structure.html#a1e88d140e18817670fd98f35fd6d8be9">reset</a>();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">return</span> stampedstruc;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#afbe6a69dd0e100c047bfca47b4831b68">  945</a></span>&#160;  <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Structure&gt;</a> <a class="code" href="class_c_a_s_m_1_1_structure.html#afbe6a69dd0e100c047bfca47b4831b68">Structure::bedazzle</a>(<a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;SiteCluster&gt;</a> stamps, <span class="keywordtype">bool</span> lat_override, <span class="keywordtype">bool</span> im_override)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Structure&gt;</a> all_decorations;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; stamps.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      all_decorations.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#aee15666c923c60231dffd350b543e5df">stamp_with</a>(stamps[i], lat_override, im_override));</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">return</span> all_decorations;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aa72e39c485786ceea18780430fc9994a">  965</a></span>&#160;  <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Array&lt;Array&lt;double&gt;</a> &gt; &gt; <a class="code" href="class_c_a_s_m_1_1_structure.html#aa72e39c485786ceea18780430fc9994a">Structure::get_NN_table</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;maxr, <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> &amp;bouquet, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">if</span>(!bouquet.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>()) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING in Structure::get_NN_table&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;The provided SiteOrbitree is about to be rewritten!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Array&lt;Array&lt;double&gt;</a> &gt; &gt; NN;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> normtree(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), tol);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> tbouquet(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), tol);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    bouquet = tbouquet;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    normtree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a36d6b674443d565debdeaa0ab1c69bbc">min_num_components</a> = 1;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    normtree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a4df42aa2e24670871db29d55b410402a">max_num_sites</a> = 2;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    normtree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a381762d522e742ae63351b313b835b51">max_length</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(0.0);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    normtree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a381762d522e742ae63351b313b835b51">max_length</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(0.0);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    normtree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#a381762d522e742ae63351b313b835b51">max_length</a>.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(maxr);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    normtree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#ac7bd13e31f4a14b27c0c7a4538fd0346">generate_orbitree</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    normtree.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#adadec48aaaad2833b99277ee015268e2">print_full_clust</a>(std::cout);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a6529b1770a3d3123f489ca82da758c46">generate_basis_bouquet</a>(normtree, bouquet, 2, tol);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Array&lt;double&gt;</a> &gt; oneNN;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    oneNN.<a class="code" href="group___array.html#ga6294b95edb096e4f301b84c27375b9d6">resize</a>(2);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; bouquet.<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>(); i++) {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      NN.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(oneNN);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; bouquet[i].<a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">size</a>(); j++) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        NN[i][0].<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(bouquet[i][j].size());</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        NN[i][1].<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(bouquet[i][j].max_length());</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">return</span> NN;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aca2be25d430e1c778a8f3d067858997b"> 1008</a></span>&#160;  <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Array&lt;Array&lt;double&gt;</a> &gt; &gt; <a class="code" href="class_c_a_s_m_1_1_structure.html#aa72e39c485786ceea18780430fc9994a">Structure::get_NN_table</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;maxr, <span class="keywordtype">double</span> <a class="code" href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_generic_orbitree.html">SiteOrbitree</a> bouquet(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), tol);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#aa72e39c485786ceea18780430fc9994a">get_NN_table</a>(maxr, bouquet, tol);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a7a1a4a5ec7eb6a5a9190ee0465af6434"> 1022</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a7a1a4a5ec7eb6a5a9190ee0465af6434">Structure::symmetrize</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_sym_group.html">SymGroup</a> &amp;relaxed_factors) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">//First make a copy of your current basis</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">//This copy will eventually become the new average basis.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a1e88d140e18817670fd98f35fd6d8be9">reset</a>();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Site&gt;</a> avg_basis = <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">//Loop through given symmetry group an fill a temporary &quot;operated basis&quot;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Site&gt;</a> operbasis;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> rf = 0; rf &lt; relaxed_factors.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); rf++) {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      operbasis.<a class="code" href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">clear</a>();</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> b = 0; b &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); b++) {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        operbasis.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(relaxed_factors[rf]*<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[b]);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        operbasis.<a class="code" href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">back</a>().<a class="code" href="class_c_a_s_m_1_1_site.html#a4eb87ec25f4ab2df5a01109ae0f1e978">print</a>(std::cout);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="comment">//Now that you have a transformed basis, find the closest mapping of atoms</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="comment">//Then average the distance and add it to the average basis</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> b = 0; b &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); b++) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keywordtype">double</span> smallest = 1000000;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> bshift(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()), tshift(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> ob = 0; ob &lt; operbasis.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); ob++) {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          <span class="keywordtype">double</span> dist = operbasis[ob].min_dist(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[b], tshift);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          <span class="keywordflow">if</span>(dist &lt; smallest) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            bshift = tshift;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            smallest = dist;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        bshift.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abaa8f4590953e12781949714c6011b3a">cart</a>() *= (1.0 / relaxed_factors.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>());</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        avg_basis[b] += bshift;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">//generate_factor_group();</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a6b97b1ab6ada176506cab4438e7c28c7">update</a>();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#ab514685b8abf0afdb13d33febf147d71"> 1069</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a7a1a4a5ec7eb6a5a9190ee0465af6434">Structure::symmetrize</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;tolerance) {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#aab8aeba4dbb29b4e39cde3511e8a4bec">generate_factor_group</a>(tolerance);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a7a1a4a5ec7eb6a5a9190ee0465af6434">symmetrize</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>());</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="comment">//\John G 050513</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a2b4186cc833ab6b0d48def6f50aef9d8"> 1088</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a2b4186cc833ab6b0d48def6f50aef9d8">Structure::add_vacuum_shift</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;new_surface_struc, <span class="keywordtype">double</span> vacuum_thickness, Eigen::Vector3d shift, <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7de">COORD_TYPE</a> mode)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> cshift(shift, <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>(), mode);    <span class="comment">//John G 121030</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">almost_zero</a>(cshift.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#a9b55b38be407e6604d4ef5ec4d63b77e">frac</a>(2))) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      std::cerr &lt;&lt; cshift.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#aca2e30621c1ac34da82d7d26ac13a5f5">const_frac</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING: You&#39;re shifting in the c direction! This will mess with your vacuum and/or structure!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;See Structure::add_vacuum_shift&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    Eigen::Vector3d vacuum_vec;                 <span class="comment">//unit vector perpendicular to ab plane</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    vacuum_vec = <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0].cross(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1]);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    vacuum_vec.normalize();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_lattice.html">Lattice</a> new_lattice(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[0],</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[1],</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                        <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>()[2] + vacuum_thickness * vacuum_vec + cshift.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abe5a7f4c03e29547f8d7ff1d34c4c8f1">const_cart</a>()); <span class="comment">//Add vacuum and shift to c vector</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    new_surface_struc = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    new_surface_struc.<a class="code" href="class_c_a_s_m_1_1_structure.html#adef79f5cc9e9ae200841a1af56a5b65b">set_lattice</a>(new_lattice, <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a13e31d145a8cde7cc6c62f7fd3fdb0f0"> 1110</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a2b4186cc833ab6b0d48def6f50aef9d8">Structure::add_vacuum_shift</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;new_surface_struc, <span class="keywordtype">double</span> vacuum_thickness, <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> shift)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a2b4186cc833ab6b0d48def6f50aef9d8">add_vacuum_shift</a>(new_surface_struc, vacuum_thickness, shift.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abaa8f4590953e12781949714c6011b3a">cart</a>(), <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CART</a>);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a2619f88d1b724ac241043b09f0234aa7"> 1117</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a2619f88d1b724ac241043b09f0234aa7">Structure::add_vacuum</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;new_surface_struc, <span class="keywordtype">double</span> vacuum_thickness)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    Eigen::Vector3d shift(0, 0, 0);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a2b4186cc833ab6b0d48def6f50aef9d8">add_vacuum_shift</a>(new_surface_struc, vacuum_thickness, shift, <a class="code" href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7deab070d36e7a4e90de65c1278e7cd0bed0">FRAC</a>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="comment">// Added by Donghee</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment"></span>  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#af9887d8eb3975da01ea31c0136f87a1d"> 1139</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#af9887d8eb3975da01ea31c0136f87a1d">Structure::intpol</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> end_struc, <span class="keywordtype">int</span> Nofimag, <a class="code" href="namespace_c_a_s_m.html#a9387daa18dfd4363232654c3c231bd10">PERIODICITY_TYPE</a> mode, <a class="code" href="singleton_c_a_s_m_1_1_array.html">Array&lt;Structure&gt;</a> &amp;images) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m = 0; m &lt; Nofimag + 1; m++) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> tstruc(end_struc);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="comment">// Change title</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      std::string header = <span class="stringliteral">&quot;POSCAR 0&quot;</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      std::stringstream convert; <span class="comment">// stringstream used for the conversion;</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      convert &lt;&lt; m;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      tstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#aa533a108409fa3360d6505e0c5c7f2c6">title</a> = header + convert.str(); <span class="comment">// title of submiges is POSCAR0X</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0 ; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> temp(<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">lattice</a>());</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        temp.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#a9b55b38be407e6604d4ef5ec4d63b77e">frac</a>() = (<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i] - end_struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i]).const_frac() * m / (Nofimag + 1);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        tstruc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i] = <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i] + temp;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      images.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(tstruc);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    images.<a class="code" href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">push_back</a>(end_struc);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    return ;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">//This function gets the basis_permutation representation of the</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="comment">// factor group operations of the structure. It first applies</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="comment">// the factor group operation to the structure, and then tries</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="comment">// to map the new position of the basis atom to the various positions</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="comment">// before symmetry was applied. It only checks the positions after</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="comment">// it brings the basis within the crystal.</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">// ROUTINE STILL NEEDS TO BE TESTED!</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a0afd98ba44747b0bfc52a000b281d131"> 1182</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_sym_group_rep_i_d.html">SymGroupRepID</a> <a class="code" href="class_c_a_s_m_1_1_structure.html#a0afd98ba44747b0bfc52a000b281d131">Structure::generate_basis_permutation_representation</a>(<span class="keywordtype">bool</span> verbose)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a274512883a57f449990a62bfdb68551f">basis_perm_rep_ID</a> = <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a526558978b0594a7cc3ad3b1088cf6f4">BasicStructure&lt;Site&gt;::generate_basis_permutation_representation</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">factor_group</a>(), verbose);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#a274512883a57f449990a62bfdb68551f">basis_perm_rep_ID</a>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">//Sets the occupants in the basis sites to those specified by occ_index</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#af9022b543c888d231fae3529dacc7638"> 1190</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#af9022b543c888d231fae3529dacc7638">Structure::set_occs</a>(<a class="code" href="singleton_c_a_s_m_1_1_array.html">Array &lt;int&gt;</a> occ_index) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">if</span>(occ_index.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>() != <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>()) {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;The size of the occ index and basis index do not match!\nEXITING\n&quot;</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      exit(1);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].set_occ_value(occ_index[i]);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a3596ebe21e1d960756b0275ec537c649"> 1201</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;<a class="code" href="class_c_a_s_m_1_1_structure.html#a3596ebe21e1d960756b0275ec537c649">Structure::operator+=</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> &amp;shift) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i] += shift;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a> += shift.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abaa8f4590953e12781949714c6011b3a">cart</a>();</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">return</span> (*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a99354c64784969976e4599ae9c98aed5"> 1213</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;<a class="code" href="class_c_a_s_m_1_1_structure.html#a99354c64784969976e4599ae9c98aed5">Structure::operator-=</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_coordinate.html">Coordinate</a> &amp;shift) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i] -= shift;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a> -= shift.<a class="code" href="class_c_a_s_m_1_1_coordinate.html#abaa8f4590953e12781949714c6011b3a">cart</a>();</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">return</span> (*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="comment">//****************************************************</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#a7ccb267b36fb5fdc4725979de28e3e84"> 1224</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a> &amp;<a class="code" href="class_c_a_s_m_1_1_structure.html#a7ccb267b36fb5fdc4725979de28e3e84">Structure::to_json</a>(<a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a> &amp;json)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// class Structure : public BasicStructure&lt;Site&gt;</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a50f7f649931ee9b57f24641941d67c42">BasicStructure&lt;Site&gt;::to_json</a>(json);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">// mutable MasterSymGroup m_factor_group;</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    json[<span class="stringliteral">&quot;factor_group&quot;</span>] = <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">// bool SD_flag;</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    json[<span class="stringliteral">&quot;SD_flag&quot;</span>] = <a class="code" href="class_c_a_s_m_1_1_structure.html#abeafcaf64a4e7790db7442867f6a2d35">SD_flag</a>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordflow">return</span> json;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="comment">//****************************************************</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="comment">// Assumes constructor CoordType::CoordType(Lattice) exists</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"><a class="line" href="class_c_a_s_m_1_1_structure.html#aa320a08ebdba7f52e38970dd4967e4c7"> 1241</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_c_a_s_m_1_1_structure.html#aa320a08ebdba7f52e38970dd4967e4c7">Structure::from_json</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a> &amp;json) {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="comment">// class Structure : public BasicStructure&lt;Site&gt;</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html">BasicStructure&lt;Site&gt;</a> &amp;basic = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      basic.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a0242e0f8cbeb208307de46d7c1db6745">from_json</a>(json);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="comment">// mutable MasterSymGroup m_factor_group;</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#ae36732d3425b628eaf02a2a4094f1e9e">clear</a>();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <a class="code" href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">m_factor_group</a>.<a class="code" href="class_c_a_s_m_1_1_master_sym_group.html#a73710305b378f710f4e7a029e8744abe">from_json</a>(json[<span class="stringliteral">&quot;factor_group&quot;</span>]);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="comment">// bool SD_flag;</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <a class="code" href="group___project.html#gaabc5891f07bb0c7993904d0b34e5349e">CASM::from_json</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html#abeafcaf64a4e7790db7442867f6a2d35">SD_flag</a>, json[<span class="stringliteral">&quot;SD_flag&quot;</span>]);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    }</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">catch</span>(...) {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keywordflow">throw</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a6b97b1ab6ada176506cab4438e7c28c7">update</a>();</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">//****************************************************</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#ab6c31e38d76005d741771933daf4edb8"> 1265</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a> &amp;<a class="code" href="group___project.html#ga1b18b2f4eecbfee3d245b1e2be481ebb">to_json</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;structure, <a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a> &amp;json) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">return</span> structure.<a class="code" href="class_c_a_s_m_1_1_structure.html#a7ccb267b36fb5fdc4725979de28e3e84">to_json</a>(json);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div>
<div class="line"><a name="l01269"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#aa9829a3e78bef2c06dc2c6df6eaea5db"> 1269</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group___project.html#gaabc5891f07bb0c7993904d0b34e5349e">from_json</a>(<a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;structure, <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1json_parser.html">jsonParser</a> &amp;json) {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    structure.<a class="code" href="class_c_a_s_m_1_1_structure.html#aa320a08ebdba7f52e38970dd4967e4c7">from_json</a>(json);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">  Structure operator*(const SymOp &amp;LHS, const Structure &amp;RHS) { //AAB</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">    return Structure(RHS).apply_sym(LHS);</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="comment">//***********************************************************</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a9058ce2d2cd92410cebbcbfe7276a9b7"> 1281</a></span>&#160;  <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> <a class="code" href="namespace_c_a_s_m.html#a69376047ae753d200d3d13cbe79414a0">operator*</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_lattice.html">Lattice</a> &amp;LHS, <span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;RHS) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> tsuper(LHS);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    tsuper.<a class="code" href="class_c_a_s_m_1_1_structure.html#a14bd1c736b6a5c0862517baf0333d9a0">fill_supercell</a>(RHS);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">return</span> tsuper;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div>
<div class="line"><a name="l01297"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#ad1f95541bc5bea3520b84d2e504ec3be"> 1297</a></span>&#160;  std::vector&lt; std::vector&lt;Index&gt; &gt; <a class="code" href="namespace_c_a_s_m.html#ad1f95541bc5bea3520b84d2e504ec3be">get_index_converter</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;struc, std::vector&lt;Molecule&gt; mol_list) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    std::vector&lt; std::vector&lt;Index&gt; &gt; converter(struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>());</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      converter[i].resize(struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>());</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        converter[i][j] = <a class="code" href="namespace_c_a_s_m.html#a43e98dc6648de583c637f18f7f7503fe">find_index</a>(mol_list, struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant()[j]);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">return</span> converter;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a002a0d6d76684e99bb70086f7257feca"> 1315</a></span>&#160;  std::vector&lt; std::vector&lt;Index&gt; &gt; <a class="code" href="namespace_c_a_s_m.html#ad1f95541bc5bea3520b84d2e504ec3be">get_index_converter</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;struc, std::vector&lt;std::string&gt; mol_name_list) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    std::vector&lt; std::vector&lt;Index&gt; &gt; converter(struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>());</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      converter[i].resize(struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>());</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        converter[i][j] = <a class="code" href="namespace_c_a_s_m.html#a43e98dc6648de583c637f18f7f7503fe">find_index</a>(mol_name_list, struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant()[j].name);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">return</span> converter;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"><a class="line" href="namespace_c_a_s_m.html#a4b0bc547e77a69869f9eab70080d276c"> 1335</a></span>&#160;  std::vector&lt; std::vector&lt;Index&gt; &gt; <a class="code" href="namespace_c_a_s_m.html#a4b0bc547e77a69869f9eab70080d276c">get_index_converter_inverse</a>(<span class="keyword">const</span> <a class="code" href="class_c_a_s_m_1_1_structure.html">Structure</a> &amp;struc, std::vector&lt;std::string&gt; mol_name_list) {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    std::vector&lt; std::vector&lt;Index&gt; &gt; converter_inv(struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>());</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> i = 0; i &lt; struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>.<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); i++) {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      converter_inv[i].resize(mol_name_list.size());</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      std::vector&lt;std::string&gt; site_occ_name_list;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant().<a class="code" href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">size</a>(); j++) {</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        site_occ_name_list.push_back(struc.<a class="code" href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">basis</a>[i].site_occupant()[j].name);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">Index</a> j = 0; j &lt; mol_name_list.size(); j++) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        converter_inv[i][j] = <a class="code" href="namespace_c_a_s_m.html#a43e98dc6648de583c637f18f7f7503fe">find_index</a>(site_occ_name_list, mol_name_list[j]);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">return</span> converter_inv;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;};</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a0242e0f8cbeb208307de46d7c1db6745"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a0242e0f8cbeb208307de46d7c1db6745">CASM::BasicStructure::from_json</a></div><div class="ttdeci">void from_json(const jsonParser &amp;json)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l01201">BasicStructure_impl.hh:1201</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a32d00f62c499164237827346bc0f3897"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a32d00f62c499164237827346bc0f3897">CASM::Structure::basis_permutation_symrep_ID</a></div><div class="ttdeci">SymGroupRepID basis_permutation_symrep_ID() const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00113">Structure.cc:113</a></div></div>
<div class="ttc" id="group___linear_algebra_html_ga6fccc5dcedea06e5cf6663cdea393fe8"><div class="ttname"><a href="group___linear_algebra.html#ga6fccc5dcedea06e5cf6663cdea393fe8">CASM::angle</a></div><div class="ttdeci">double angle(const Eigen::Ref&lt; const Eigen::Vector3d &gt; &amp;a, const Eigen::Ref&lt; const Eigen::Vector3d &gt; &amp;b)</div><div class="ttdoc">Get angle, in radians, between two vectors on range [0,pi]. </div><div class="ttdef"><b>Definition:</b> <a href="_linear_algebra_8cc_source.html#l00154">LinearAlgebra.cc:154</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a31441bb194985a14bbd654475fa7a7de"><div class="ttname"><a href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7de">CASM::COORD_TYPE</a></div><div class="ttdeci">COORD_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00057">CASM_global_definitions.hh:57</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a8b0df5e5301a05eb033962ae622f9806"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a8b0df5e5301a05eb033962ae622f9806">CASM::Structure::m_factor_group</a></div><div class="ttdeci">MasterSymGroup m_factor_group</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8hh_source.html#l00034">Structure.hh:34</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a89a5a207d869cba7f5a9b83eca9ccffe"><div class="ttname"><a href="namespace_c_a_s_m.html#a89a5a207d869cba7f5a9b83eca9ccffe">CASM::almost_zero</a></div><div class="ttdeci">bool almost_zero(const T &amp;val, double tol=TOL)</div><div class="ttdoc">If T is not integral, use std::abs(val) < tol;. </div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__math_8hh_source.html#l00041">CASM_math.hh:41</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a50f7f649931ee9b57f24641941d67c42"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a50f7f649931ee9b57f24641941d67c42">CASM::BasicStructure::to_json</a></div><div class="ttdeci">jsonParser &amp; to_json(jsonParser &amp;json) const </div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l01182">BasicStructure_impl.hh:1182</a></div></div>
<div class="ttc" id="group___project_html_gaabc5891f07bb0c7993904d0b34e5349e"><div class="ttname"><a href="group___project.html#gaabc5891f07bb0c7993904d0b34e5349e">CASM::from_json</a></div><div class="ttdeci">void from_json(ClexDescription &amp;desc, const jsonParser &amp;json)</div><div class="ttdef"><b>Definition:</b> <a href="_project_settings_8cc_source.html#l00066">ProjectSettings.cc:66</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_array_html_aa71c1c4621370d2caef061ec0cdcde9e"><div class="ttname"><a href="singleton_c_a_s_m_1_1_array.html#aa71c1c4621370d2caef061ec0cdcde9e">CASM::Array::size</a></div><div class="ttdeci">Index size() const </div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00145">Array.hh:145</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_coordinate_html_abaa8f4590953e12781949714c6011b3a"><div class="ttname"><a href="class_c_a_s_m_1_1_coordinate.html#abaa8f4590953e12781949714c6011b3a">CASM::Coordinate::cart</a></div><div class="ttdeci">Coordinate_impl::CartCoordinate cart()</div><div class="ttdoc">Set Cartesian coordinate vector and update fractional coordinate vector. </div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00593">Coordinate.hh:593</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_group_rep_i_d_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep_i_d.html">CASM::SymGroupRepID</a></div><div class="ttdoc">Type-safe ID object for communicating and accessing Symmetry representation info. ...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_i_d_8hh_source.html#l00019">SymGroupRepID.hh:19</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a9df24931a4fa76f969575e91ad00a208"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a9df24931a4fa76f969575e91ad00a208">CASM::Structure::generate_flowertrees_safe</a></div><div class="ttdeci">void generate_flowertrees_safe(const SiteOrbitree &amp;in_tree, Array&lt; SiteOrbitree &gt; &amp;out_trees, double tol=TOL)</div><div class="ttdoc">Gets clusters of every size radiating from one site and saves them to a flowertree. A garland for each site is constructed. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00562">Structure.cc:562</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_lattice_html_a0761002315d0e245ffb3e074e788cc31"><div class="ttname"><a href="class_c_a_s_m_1_1_lattice.html#a0761002315d0e245ffb3e074e788cc31">CASM::Lattice::generate_point_group</a></div><div class="ttdeci">void generate_point_group(SymGroup &amp;point_group, double pg_tol=TOL) const </div><div class="ttdoc">Populate. </div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8cc_source.html#l00304">Lattice.cc:304</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_group_rep_i_d_html_ab9fe6fc494b40c34e3185d2c21a30b8d"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep_i_d.html#ab9fe6fc494b40c34e3185d2c21a30b8d">CASM::SymGroupRepID::empty</a></div><div class="ttdeci">bool empty() const </div><div class="ttdoc">Returns true if SymGroupRepID has not been initialized with valid group_index or rep_index. </div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_i_d_8hh_source.html#l00060">SymGroupRepID.hh:60</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_aaa391e050b7425ef18412ac1bd24aa6c"><div class="ttname"><a href="namespace_c_a_s_m.html#aaa391e050b7425ef18412ac1bd24aa6c">CASM::compare</a></div><div class="ttdeci">bool compare(const T &amp;A, const T &amp;B, double tol)</div><div class="ttdoc">Floating point comparison with tol, return A < B. </div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__math_8hh_source.html#l00089">CASM_math.hh:89</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_aee3a422237a9366b9323e68163b548b0"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#aee3a422237a9366b9323e68163b548b0">CASM::Structure::point_group</a></div><div class="ttdeci">const SymGroup &amp; point_group() const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00101">Structure.cc:101</a></div></div>
<div class="ttc" id="_orbitree_8hh_html"><div class="ttname"><a href="_orbitree_8hh.html">Orbitree.hh</a></div></div>
<div class="ttc" id="group___array_html_ga9d8a0ef65d87fac56a2b052b9c15e245"><div class="ttname"><a href="group___array.html#ga9d8a0ef65d87fac56a2b052b9c15e245">CASM::Array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;toPush)</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00513">Array.hh:513</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_master_sym_group_html_a16e9aa4122b2b4b6efbd39c5a673ec45"><div class="ttname"><a href="class_c_a_s_m_1_1_master_sym_group.html#a16e9aa4122b2b4b6efbd39c5a673ec45">CASM::MasterSymGroup::point_group</a></div><div class="ttdeci">const SymGroup &amp; point_group() const </div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l00074">SymGroup.cc:74</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a3596ebe21e1d960756b0275ec537c649"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a3596ebe21e1d960756b0275ec537c649">CASM::Structure::operator+=</a></div><div class="ttdeci">Structure &amp; operator+=(const Coordinate &amp;shift)</div><div class="ttdoc">Translates all atoms in cell. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01201">Structure.cc:1201</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html">CASM::Structure</a></div><div class="ttdoc">Structure specifies the lattice and atomic basis of a crystal. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8hh_source.html#l00029">Structure.hh:29</a></div></div>
<div class="ttc" id="group___project_html_ga1b18b2f4eecbfee3d245b1e2be481ebb"><div class="ttname"><a href="group___project.html#ga1b18b2f4eecbfee3d245b1e2be481ebb">CASM::to_json</a></div><div class="ttdeci">jsonParser &amp; to_json(const ClexDescription &amp;desc, jsonParser &amp;json)</div><div class="ttdef"><b>Definition:</b> <a href="_project_settings_8cc_source.html#l00055">ProjectSettings.cc:55</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a0afd98ba44747b0bfc52a000b281d131"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a0afd98ba44747b0bfc52a000b281d131">CASM::Structure::generate_basis_permutation_representation</a></div><div class="ttdeci">SymGroupRepID generate_basis_permutation_representation(bool verbose=false) const </div><div class="ttdoc">Obtain the basis permutation representation of factor_group, returns its rep_id, and sets internal ba...</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01182">Structure.cc:1182</a></div></div>
<div class="ttc" id="group___array_html_ga6294b95edb096e4f301b84c27375b9d6"><div class="ttname"><a href="group___array.html#ga6294b95edb096e4f301b84c27375b9d6">CASM::Array::resize</a></div><div class="ttdeci">void resize(Index new_N)</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00468">Array.hh:468</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_aca97accc5e038e198e8e37f1d615afe2"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#aca97accc5e038e198e8e37f1d615afe2">CASM::Structure::generate_factor_group_slow</a></div><div class="ttdeci">void generate_factor_group_slow(double map_tol=TOL) const </div><div class="ttdoc">Obtain factor group by testing all operations of the lattice point_group and keep. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00077">Structure.cc:77</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_abc0cfc709840d223bd41bebf9a32e96a"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#abc0cfc709840d223bd41bebf9a32e96a">CASM::Structure::copy_attributes_from</a></div><div class="ttdeci">void copy_attributes_from(const Structure &amp;RHS)</div><div class="ttdoc">copy all non-derived members </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00062">Structure.cc:62</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a96967eb1b76165970cbf2026b9fde4ac"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a96967eb1b76165970cbf2026b9fde4ac">CASM::Structure::generate_flowertrees</a></div><div class="ttdeci">void generate_flowertrees(const SiteOrbitree &amp;in_tree, Array&lt; SiteOrbitree &gt; &amp;out_trees, double tol=TOL)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00410">Structure.cc:410</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html">CASM::BasicStructure</a></div><div class="ttdoc">BasicStructure specifies the lattice and atomic basis of a crystal. </div><div class="ttdef"><b>Definition:</b> <a href="_cluster_8hh_source.html#l00016">Cluster.hh:16</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a00a515632e929b13fe0ac7005c96cfea"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a00a515632e929b13fe0ac7005c96cfea">CASM::Structure::get_struc_molecule</a></div><div class="ttdeci">std::vector&lt; Molecule &gt; get_struc_molecule() const </div><div class="ttdoc">Returns an Array of each possible Molecule in this Structure. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00146">Structure.cc:146</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_ab7d92879af881561fdeeda3a01b26368a59e8ef72de047f743136a7b89c1b2b31"><div class="ttname"><a href="namespace_c_a_s_m.html#ab7d92879af881561fdeeda3a01b26368a59e8ef72de047f743136a7b89c1b2b31">CASM::SCEL</a></div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00064">CASM_global_definitions.hh:64</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a43e98dc6648de583c637f18f7f7503fe"><div class="ttname"><a href="namespace_c_a_s_m.html#a43e98dc6648de583c637f18f7f7503fe">CASM::find_index</a></div><div class="ttdeci">Index find_index(Iterator begin, Iterator end, const T &amp;value)</div><div class="ttdoc">Equivalent to std::distance(begin, std::find(begin, end, value)) </div><div class="ttdef"><b>Definition:</b> <a href="algorithm_8hh_source.html#l00016">algorithm.hh:16</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbit_branch_html"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbit_branch.html">CASM::GenericOrbitBranch</a></div><div class="ttdef"><b>Definition:</b> <a href="_cluster_functions_8hh_source.html#l00011">ClusterFunctions.hh:11</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a8bb1a3cab5b3a60e1cd2bb54746af874"><div class="ttname"><a href="namespace_c_a_s_m.html#a8bb1a3cab5b3a60e1cd2bb54746af874">CASM::SiteOrbitBranch</a></div><div class="ttdeci">GenericOrbitBranch&lt; SiteCluster &gt; SiteOrbitBranch</div><div class="ttdef"><b>Definition:</b> <a href="_orbit_branch_8hh_source.html#l00020">OrbitBranch.hh:20</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a1ad65f317107d806b3edd31714b334c2"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a1ad65f317107d806b3edd31714b334c2">CASM::Structure::stack_on</a></div><div class="ttdeci">Structure stack_on(const Structure &amp;understruc, bool override=0) const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00692">Structure.cc:692</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_ab82f33499d2edcf833d426c2bec3415f"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#ab82f33499d2edcf833d426c2bec3415f">CASM::Structure::fg_converge</a></div><div class="ttdeci">void fg_converge(double large_tol)</div><div class="ttdoc">generate factor groups for a range of tol values, prints results to screen (for now) ...</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00231">Structure.cc:231</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_site_html_ae21925394c1a4edd4140234b45f2c9ab"><div class="ttname"><a href="class_c_a_s_m_1_1_site.html#ae21925394c1a4edd4140234b45f2c9ab">CASM::Site::set_lattice</a></div><div class="ttdeci">void set_lattice(const Lattice &amp;new_lat, COORD_TYPE mode)</div><div class="ttdef"><b>Definition:</b> <a href="_site_8cc_source.html#l00202">Site.cc:202</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a758801dc02a507f1365a5a45ba3cb184"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a758801dc02a507f1365a5a45ba3cb184">CASM::BasicStructure::generate_factor_group_slow</a></div><div class="ttdeci">void generate_factor_group_slow(SymGroup &amp;factor_group, double map_tol) const </div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l00103">BasicStructure_impl.hh:103</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html"><div class="ttname"><a href="namespace_c_a_s_m.html">CASM</a></div><div class="ttdoc">Main CASM namespace. </div><div class="ttdef"><b>Definition:</b> <a href="complete_8cpp_source.html#l00008">complete.cpp:8</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a2466f736aa4866a9a104c7bdf08e2e61"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a2466f736aa4866a9a104c7bdf08e2e61">CASM::BasicStructure&lt; Site &gt;::lattice</a></div><div class="ttdeci">const Lattice &amp; lattice() const</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00074">BasicStructure.hh:74</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_cluster_html_a416cde5978df6c2b5adda5bd342122ea"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_cluster.html#a416cde5978df6c2b5adda5bd342122ea">CASM::GenericCluster::image_check</a></div><div class="ttdeci">*bool image_check(const Lattice &amp;cell, int nV=0) const </div><div class="ttdoc">Checks to see if cluster is "compact" relative to (Lattice cell) in other words, period images of the...</div><div class="ttdef"><b>Definition:</b> <a href="_cluster__impl_8hh_source.html#l00201">Cluster_impl.hh:201</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a71b214017b27f6027f6dc8ba848651a7"><div class="ttname"><a href="namespace_c_a_s_m.html#a71b214017b27f6027f6dc8ba848651a7">CASM::TOL</a></div><div class="ttdeci">const double TOL</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00031">CASM_global_definitions.hh:31</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_a9622bd956345a475da4360b6c0d43f86"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#a9622bd956345a475da4360b6c0d43f86">CASM::GenericOrbitree::push_back</a></div><div class="ttdeci">void push_back(const GenericOrbit&lt; ClustType &gt; &amp;new_orbit)</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree__impl_8hh_source.html#l00134">Orbitree_impl.hh:134</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_site_cluster_html_af0b7ec42ae9a13ec8fe5d225b789e61c"><div class="ttname"><a href="class_c_a_s_m_1_1_site_cluster.html#af0b7ec42ae9a13ec8fe5d225b789e61c">CASM::SiteCluster::push_back</a></div><div class="ttdeci">void push_back(const Site &amp;new_site)</div><div class="ttdef"><b>Definition:</b> <a href="_site_cluster_8cc_source.html#l00011">SiteCluster.cc:11</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_master_sym_group_html_a9243eb7bc565dd9e8bcdd926ac55319a"><div class="ttname"><a href="class_c_a_s_m_1_1_master_sym_group.html#a9243eb7bc565dd9e8bcdd926ac55319a">CASM::MasterSymGroup::push_back</a></div><div class="ttdeci">void push_back(const SymOp &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l00065">SymGroup.cc:65</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_lattice_html_a7925f304b5fa3754e3b20c6c5a84498f"><div class="ttname"><a href="class_c_a_s_m_1_1_lattice.html#a7925f304b5fa3754e3b20c6c5a84498f">CASM::Lattice::lat_column_mat</a></div><div class="ttdeci">const Eigen::Matrix3d &amp; lat_column_mat() const </div><div class="ttdoc">3x3 matrix with lattice vectors as its columne </div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8hh_source.html#l00104">Lattice.hh:104</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_coordinate_html_abe5a7f4c03e29547f8d7ff1d34c4c8f1"><div class="ttname"><a href="class_c_a_s_m_1_1_coordinate.html#abe5a7f4c03e29547f8d7ff1d34c4c8f1">CASM::Coordinate::const_cart</a></div><div class="ttdeci">const vector_type &amp; const_cart() const </div><div class="ttdoc">user override to force const Access the Cartesian coordinate vector </div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00092">Coordinate.hh:92</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a7a1a4a5ec7eb6a5a9190ee0465af6434"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a7a1a4a5ec7eb6a5a9190ee0465af6434">CASM::Structure::symmetrize</a></div><div class="ttdeci">void symmetrize(const SymGroup &amp;relaxed_factors)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01022">Structure.cc:1022</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_site_cluster_html"><div class="ttname"><a href="class_c_a_s_m_1_1_site_cluster.html">CASM::SiteCluster</a></div><div class="ttdef"><b>Definition:</b> <a href="_site_cluster_8hh_source.html#l00020">SiteCluster.hh:20</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a335908405b2a5724dc742d125fd12887"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a335908405b2a5724dc742d125fd12887">CASM::BasicStructure::generate_factor_group</a></div><div class="ttdeci">void generate_factor_group(SymGroup &amp;factor_group, double map_tol) const </div><div class="ttdoc">apply a symmetry operation to the current structure (may change lattice vectors and order of basis at...</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l00188">BasicStructure_impl.hh:188</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_prim_grid_html"><div class="ttname"><a href="class_c_a_s_m_1_1_prim_grid.html">CASM::PrimGrid</a></div><div class="ttdef"><b>Definition:</b> <a href="_prim_grid_8hh_source.html#l00030">PrimGrid.hh:30</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a4b6b788cc7e2b76e591aac6ef76c13c1"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a4b6b788cc7e2b76e591aac6ef76c13c1">CASM::Structure::sort_basis</a></div><div class="ttdeci">void sort_basis()</div><div class="ttdoc">Rearrange basis by grouping atoms by type. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00858">Structure.cc:858</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_aab8aeba4dbb29b4e39cde3511e8a4bec"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#aab8aeba4dbb29b4e39cde3511e8a4bec">CASM::Structure::generate_factor_group</a></div><div class="ttdeci">void generate_factor_group(double map_tol=TOL) const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00085">Structure.cc:85</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_abf7f305316afe9ebfe689b09ea3b7074"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#abf7f305316afe9ebfe689b09ea3b7074">CASM::GenericOrbitree::get_index</a></div><div class="ttdeci">void get_index() const </div><div class="ttdoc">Populates &#39;index&#39;, &#39;index_to_row&#39; and &#39;index_to_column&#39; Arrays. </div><div class="ttdef"><b>Definition:</b> <a href="_orbitree__impl_8hh_source.html#l00312">Orbitree_impl.hh:312</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_coordinate_html_aca2e30621c1ac34da82d7d26ac13a5f5"><div class="ttname"><a href="class_c_a_s_m_1_1_coordinate.html#aca2e30621c1ac34da82d7d26ac13a5f5">CASM::Coordinate::const_frac</a></div><div class="ttdeci">const vector_type &amp; const_frac() const </div><div class="ttdoc">user override to force const Access the fractional coordinate vector </div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00066">Coordinate.hh:66</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a274512883a57f449990a62bfdb68551f"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a274512883a57f449990a62bfdb68551f">CASM::Structure::basis_perm_rep_ID</a></div><div class="ttdeci">SymGroupRepID basis_perm_rep_ID</div><div class="ttdoc">This holds the representation id of the permutation representation. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8hh_source.html#l00036">Structure.hh:36</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a6208c7211ddf90623b76caca0f04cd89"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a6208c7211ddf90623b76caca0f04cd89">CASM::Structure::get_struc_molecule_name</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_struc_molecule_name() const </div><div class="ttdoc">Returns an Array of each possible Molecule in this Structure. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00166">Structure.cc:166</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a3275b25a6fb08af4baa200f4e4d2809d"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a3275b25a6fb08af4baa200f4e4d2809d">CASM::Structure::basis_permutation_symrep</a></div><div class="ttdeci">SymGroupRep const * basis_permutation_symrep() const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00107">Structure.cc:107</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_abeafcaf64a4e7790db7442867f6a2d35"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#abeafcaf64a4e7790db7442867f6a2d35">CASM::Structure::SD_flag</a></div><div class="ttdeci">bool SD_flag</div><div class="ttdoc">Specifies whether selectice dynamics is on or of for DFT calculations. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8hh_source.html#l00038">Structure.hh:38</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a04224a7ad00a5870b56187a2db07ae5a"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a04224a7ad00a5870b56187a2db07ae5a">CASM::BasicStructure&lt; Site &gt;::find</a></div><div class="ttdeci">Index find(const CoordType2 &amp;test_site, double tol=TOL) const</div></div>
<div class="ttc" id="class_c_a_s_m_1_1_master_sym_group_html"><div class="ttname"><a href="class_c_a_s_m_1_1_master_sym_group.html">CASM::MasterSymGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8hh_source.html#l00270">SymGroup.hh:270</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a1e88d140e18817670fd98f35fd6d8be9"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a1e88d140e18817670fd98f35fd6d8be9">CASM::Structure::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">clears symmetry, site internals, and other attributes </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00385">Structure.cc:385</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_acee4cee62f04718a6279836d77b24cb6"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#acee4cee62f04718a6279836d77b24cb6">CASM::BasicStructure&lt; Site &gt;::m_lattice</a></div><div class="ttdeci">Lattice m_lattice</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00032">BasicStructure.hh:32</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_group_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html">CASM::SymGroup</a></div><div class="ttdoc">SymGroup is a collection of symmetry operations that satisfy the group property The symmetry operatio...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8hh_source.html#l00033">SymGroup.hh:33</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_ab7d92879af881561fdeeda3a01b26368a42b41bfe52012805600e51df2b3dbc21"><div class="ttname"><a href="namespace_c_a_s_m.html#ab7d92879af881561fdeeda3a01b26368a42b41bfe52012805600e51df2b3dbc21">CASM::PRIM</a></div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00064">CASM_global_definitions.hh:64</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_a5ada91f6eede699ebe89ff80b8f19825"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#a5ada91f6eede699ebe89ff80b8f19825">CASM::GenericOrbitree::min_length</a></div><div class="ttdeci">double min_length</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree_8hh_source.html#l00054">Orbitree.hh:54</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_cluster_html_a54ba5dff97773ef5fa615d9272b51b4b"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_cluster.html#a54ba5dff97773ef5fa615d9272b51b4b">CASM::GenericCluster::set_lattice</a></div><div class="ttdeci">void set_lattice(const Lattice &amp;new_home, COORD_TYPE mode)</div><div class="ttdef"><b>Definition:</b> <a href="_cluster__impl_8hh_source.html#l00021">Cluster_impl.hh:21</a></div></div>
<div class="ttc" id="_lattice_enum_equivalents_8cc_html_a2687e4b3cb5da7dbd00e565343f66c6c"><div class="ttname"><a href="_lattice_enum_equivalents_8cc.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a></div><div class="ttdeci">double tol</div><div class="ttdef"><b>Definition:</b> <a href="_lattice_enum_equivalents_8cc_source.html#l00021">LatticeEnumEquivalents.cc:21</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1json_parser_html"><div class="ttname"><a href="class_c_a_s_m_1_1json_parser.html">CASM::jsonParser</a></div><div class="ttdef"><b>Definition:</b> <a href="json_parser_8hh_source.html#l00078">jsonParser.hh:78</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_array_html_afada124d8510b98dc71cd26f76f3c21a"><div class="ttname"><a href="singleton_c_a_s_m_1_1_array.html#afada124d8510b98dc71cd26f76f3c21a">CASM::Array::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00216">Array.hh:216</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_a1bbc2b205bd236b432abaaa1a9327821"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#a1bbc2b205bd236b432abaaa1a9327821">CASM::GenericOrbitree::lattice</a></div><div class="ttdeci">Lattice lattice</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree_8hh_source.html#l00042">Orbitree.hh:42</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_site_html_a4eb87ec25f4ab2df5a01109ae0f1e978"><div class="ttname"><a href="class_c_a_s_m_1_1_site.html#a4eb87ec25f4ab2df5a01109ae0f1e978">CASM::Site::print</a></div><div class="ttdeci">void print(std::ostream &amp;stream) const </div><div class="ttdef"><b>Definition:</b> <a href="_site_8cc_source.html#l00379">Site.cc:379</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_op_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_op.html">CASM::SymOp</a></div><div class="ttdoc">SymOp is the Coordinate representation of a symmetry operation it keeps fraction (FRAC) and Cartesian...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_op_8hh_source.html#l00028">SymOp.hh:28</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a83e1f2b756139f7fc7772e10dcb4237d"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a83e1f2b756139f7fc7772e10dcb4237d">CASM::Structure::factor_group</a></div><div class="ttdeci">const MasterSymGroup &amp; factor_group() const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00094">Structure.cc:94</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a69376047ae753d200d3d13cbe79414a0"><div class="ttname"><a href="namespace_c_a_s_m.html#a69376047ae753d200d3d13cbe79414a0">CASM::operator*</a></div><div class="ttdeci">BasisSet operator*(const SymOp &amp;LHS, const BasisSet &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="_basis_set_8cc_source.html#l01154">BasisSet.cc:1154</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbit_branch_html_ac1ce22835f15775f8afc6c35272975a5"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#ac1ce22835f15775f8afc6c35272975a5">CASM::GenericOrbitBranch::print</a></div><div class="ttdeci">void print(std::ostream &amp;stream, COORD_TYPE mode=FRAC)</div><div class="ttdef"><b>Definition:</b> <a href="_orbit_branch__impl_8hh_source.html#l00116">OrbitBranch_impl.hh:116</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_coordinate_html"><div class="ttname"><a href="class_c_a_s_m_1_1_coordinate.html">CASM::Coordinate</a></div><div class="ttdoc">Represents cartesian and fractional coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00034">Coordinate.hh:34</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_a4df42aa2e24670871db29d55b410402a"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#a4df42aa2e24670871db29d55b410402a">CASM::GenericOrbitree::max_num_sites</a></div><div class="ttdeci">Index max_num_sites</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree_8hh_source.html#l00047">Orbitree.hh:47</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a2b4186cc833ab6b0d48def6f50aef9d8"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a2b4186cc833ab6b0d48def6f50aef9d8">CASM::Structure::add_vacuum_shift</a></div><div class="ttdeci">void add_vacuum_shift(Structure &amp;new_surface_struc, double vacuum_thickness, Eigen::Vector3d shift, COORD_TYPE mode) const </div><div class="ttdoc">Add vacuum and shift c vector. The vacuum is always added parallel to c, and the shift vector should ...</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01088">Structure.cc:1088</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_a82ce80232745f47d38887306e54818e9"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#a82ce80232745f47d38887306e54818e9">CASM::GenericOrbitree::collect_basis_info</a></div><div class="ttdeci">void collect_basis_info(const Structure &amp;struc)</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree__impl_8hh_source.html#l00223">Orbitree_impl.hh:223</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a2eabb1ad1af976fcdef1c92908ad86aa"><div class="ttname"><a href="namespace_c_a_s_m.html#a2eabb1ad1af976fcdef1c92908ad86aa">CASM::Index</a></div><div class="ttdeci">EigenIndex Index</div><div class="ttdoc">For long integer indexing: </div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00054">CASM_global_definitions.hh:54</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a99354c64784969976e4599ae9c98aed5"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a99354c64784969976e4599ae9c98aed5">CASM::Structure::operator-=</a></div><div class="ttdeci">Structure &amp; operator-=(const Coordinate &amp;shift)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01213">Structure.cc:1213</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a14bd1c736b6a5c0862517baf0333d9a0"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a14bd1c736b6a5c0862517baf0333d9a0">CASM::Structure::fill_supercell</a></div><div class="ttdeci">void fill_supercell(const Structure &amp;prim, double map_tol=TOL)</div><div class="ttdoc">fill an empty structure with the basis of its corresponding primitive cell - performs optimized facto...</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00263">Structure.cc:263</a></div></div>
<div class="ttc" id="algorithm_8hh_html"><div class="ttname"><a href="algorithm_8hh.html">algorithm.hh</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_aa320a08ebdba7f52e38970dd4967e4c7"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#aa320a08ebdba7f52e38970dd4967e4c7">CASM::Structure::from_json</a></div><div class="ttdeci">void from_json(const jsonParser &amp;json)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01241">Structure.cc:1241</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a2619f88d1b724ac241043b09f0234aa7"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a2619f88d1b724ac241043b09f0234aa7">CASM::Structure::add_vacuum</a></div><div class="ttdeci">void add_vacuum(Structure &amp;new_surface_struc, double vacuum_thickness) const </div><div class="ttdoc">Adds vacuum layer on top of ab plane. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01117">Structure.cc:1117</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a5ea5cc6603ee2b20ba7fa2a9be4ac797"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a5ea5cc6603ee2b20ba7fa2a9be4ac797">CASM::BasicStructure&lt; Site &gt;::basis</a></div><div class="ttdeci">Array&lt; Site &gt; basis</div><div class="ttdoc">Lattice vectors that specifies periodicity of the crystal. </div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00042">BasicStructure.hh:42</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a6529b1770a3d3123f489ca82da758c46"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a6529b1770a3d3123f489ca82da758c46">CASM::Structure::generate_basis_bouquet</a></div><div class="ttdeci">void generate_basis_bouquet(const SiteOrbitree &amp;in_tree, SiteOrbitree &amp;out_tree, Index num_sites, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00446">Structure.cc:446</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_aee15666c923c60231dffd350b543e5df"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#aee15666c923c60231dffd350b543e5df">CASM::Structure::stamp_with</a></div><div class="ttdeci">Structure stamp_with(SiteCluster stamp, bool lat_override=0, bool im_override=0) const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00888">Structure.cc:888</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_afd88e52455c79ff69628b997fd982cf0"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#afd88e52455c79ff69628b997fd982cf0">CASM::BasicStructure::fg_converge</a></div><div class="ttdeci">void fg_converge(double small_tol, double large_tol, double increment)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l00230">BasicStructure_impl.hh:230</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_group_html_a72c30baa8c7fbf67997402f7480f5767"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html#a72c30baa8c7fbf67997402f7480f5767">CASM::SymGroup::invalidate_multi_tables</a></div><div class="ttdeci">void invalidate_multi_tables() const </div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l03189">SymGroup.cc:3189</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_adef79f5cc9e9ae200841a1af56a5b65b"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#adef79f5cc9e9ae200841a1af56a5b65b">CASM::Structure::set_lattice</a></div><div class="ttdeci">void set_lattice(const Lattice &amp;lattice, COORD_TYPE mode)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00664">Structure.cc:664</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a2ed7448e1d25e9dc67e051f4766b6c4f"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a2ed7448e1d25e9dc67e051f4766b6c4f">CASM::Structure::generate_asym_bouquet</a></div><div class="ttdeci">void generate_asym_bouquet(const SiteOrbitree &amp;in_tree, SiteOrbitree &amp;out_tree, Index num_sites, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00501">Structure.cc:501</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_aa533a108409fa3360d6505e0c5c7f2c6"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#aa533a108409fa3360d6505e0c5c7f2c6">CASM::BasicStructure::title</a></div><div class="ttdeci">std::string title</div><div class="ttdoc">User-specified name of this Structure. </div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure_8hh_source.html#l00039">BasicStructure.hh:39</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_lattice_html_a91754f146800dd4b79ae7f8d08041fad"><div class="ttname"><a href="class_c_a_s_m_1_1_lattice.html#a91754f146800dd4b79ae7f8d08041fad">CASM::Lattice::is_supercell_of</a></div><div class="ttdeci">bool is_supercell_of(const Lattice &amp;tile, Eigen::Matrix3d &amp;multimat, double _tol=TOL) const </div><div class="ttdoc">Matrix that relates two lattices (e.g., strain or slat) </div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8cc_source.html#l00655">Lattice.cc:655</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a9387daa18dfd4363232654c3c231bd10"><div class="ttname"><a href="namespace_c_a_s_m.html#a9387daa18dfd4363232654c3c231bd10">CASM::PERIODICITY_TYPE</a></div><div class="ttdeci">PERIODICITY_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00062">CASM_global_definitions.hh:62</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a7f2f92afcc0bd2dd37d9682937ebbe92"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a7f2f92afcc0bd2dd37d9682937ebbe92">CASM::Structure::create_superstruc</a></div><div class="ttdeci">Structure create_superstruc(const Lattice &amp;scel_lat, double map_tol=TOL) const </div><div class="ttdoc">Shortcut routine to create a supercell structure and fill it with sites. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00335">Structure.cc:335</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a6b97b1ab6ada176506cab4438e7c28c7"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a6b97b1ab6ada176506cab4438e7c28c7">CASM::BasicStructure&lt; Site &gt;::update</a></div><div class="ttdeci">void update()</div></div>
<div class="ttc" id="namespace_c_a_s_m_html_ad1f95541bc5bea3520b84d2e504ec3be"><div class="ttname"><a href="namespace_c_a_s_m.html#ad1f95541bc5bea3520b84d2e504ec3be">CASM::get_index_converter</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Index &gt; &gt; get_index_converter(const Structure &amp;struc, std::vector&lt; Molecule &gt; mol_list)</div><div class="ttdoc">Helper Functions. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01297">Structure.cc:1297</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_lattice_html"><div class="ttname"><a href="class_c_a_s_m_1_1_lattice.html">CASM::Lattice</a></div><div class="ttdef"><b>Definition:</b> <a href="_lattice_8hh_source.html#l00031">Lattice.hh:31</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a31441bb194985a14bbd654475fa7a7deab070d36e7a4e90de65c1278e7cd0bed0"><div class="ttname"><a href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7deab070d36e7a4e90de65c1278e7cd0bed0">CASM::FRAC</a></div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00057">CASM_global_definitions.hh:57</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a174d85a36040421acce971327d72e03e"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a174d85a36040421acce971327d72e03e">CASM::Structure::get_reflection</a></div><div class="ttdeci">Structure get_reflection() const </div><div class="ttdoc">Return reflection of structure. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00769">Structure.cc:769</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_array_html_a7a55a6676e05dc73609fb3430d4c2897"><div class="ttname"><a href="singleton_c_a_s_m_1_1_array.html#a7a55a6676e05dc73609fb3430d4c2897">CASM::Array&lt; GenericOrbit&lt; ClustType &gt; &gt;::at</a></div><div class="ttdeci">GenericOrbit&lt; ClustType &gt; &amp; at(Index ind)</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00157">Array.hh:157</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_af9887d8eb3975da01ea31c0136f87a1d"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#af9887d8eb3975da01ea31c0136f87a1d">CASM::Structure::intpol</a></div><div class="ttdeci">void intpol(Structure end_struc, int Nofimag, PERIODICITY_TYPE mode, Array&lt; Structure &gt; &amp;images)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01139">Structure.cc:1139</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_array_html_aa49b28bd3243402eacb01fef829326b1"><div class="ttname"><a href="singleton_c_a_s_m_1_1_array.html#aa49b28bd3243402eacb01fef829326b1">CASM::Array::swap_elem</a></div><div class="ttdeci">void swap_elem(Index i, Index j)</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00231">Array.hh:231</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_aafb695e0f054d17249f14b2e6c7f7e53"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#aafb695e0f054d17249f14b2e6c7f7e53">CASM::BasicStructure&lt; Site &gt;::read</a></div><div class="ttdeci">virtual void read(std::istream &amp;stream)</div><div class="ttdoc">Print intpolated images in seperate directries. </div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_group_html_ade185ee6fc635fa6bced0f3d0fb8f29f"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html#ade185ee6fc635fa6bced0f3d0fb8f29f">CASM::SymGroup::find_no_trans</a></div><div class="ttdeci">Index find_no_trans(const SymOp &amp;test_op) const </div><div class="ttdoc">Check to see if a SymOp is contained in in SymGroup and return its index. </div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l03309">SymGroup.cc:3309</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_adadec48aaaad2833b99277ee015268e2"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#adadec48aaaad2833b99277ee015268e2">CASM::GenericOrbitree::print_full_clust</a></div><div class="ttdeci">void print_full_clust(std::ostream &amp;out) const </div><div class="ttdef"><b>Definition:</b> <a href="_orbitree__impl_8hh_source.html#l01630">Orbitree_impl.hh:1630</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_master_sym_group_html_a73710305b378f710f4e7a029e8744abe"><div class="ttname"><a href="class_c_a_s_m_1_1_master_sym_group.html#a73710305b378f710f4e7a029e8744abe">CASM::MasterSymGroup::from_json</a></div><div class="ttdeci">void from_json(const jsonParser &amp;json)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l04596">SymGroup.cc:4596</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a2d9cc96452fc1d5b046038fc9217e967"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a2d9cc96452fc1d5b046038fc9217e967">CASM::BasicStructure::copy_attributes_from</a></div><div class="ttdeci">void copy_attributes_from(const BasicStructure &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l00055">BasicStructure_impl.hh:55</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_a36d6b674443d565debdeaa0ab1c69bbc"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#a36d6b674443d565debdeaa0ab1c69bbc">CASM::GenericOrbitree::min_num_components</a></div><div class="ttdeci">Index min_num_components</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree_8hh_source.html#l00047">Orbitree.hh:47</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_aa0cb3d437cbd7d05cf7503808d897cf0"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#aa0cb3d437cbd7d05cf7503808d897cf0">CASM::Structure::get_struc_specie</a></div><div class="ttdeci">std::vector&lt; Specie &gt; get_struc_specie() const </div><div class="ttdoc">Returns an Array of each possible Specie in this Structure. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00123">Structure.cc:123</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_aa72e39c485786ceea18780430fc9994a"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#aa72e39c485786ceea18780430fc9994a">CASM::Structure::get_NN_table</a></div><div class="ttdeci">Array&lt; Array&lt; Array&lt; double &gt; &gt; &gt; get_NN_table(const double &amp;maxr, SiteOrbitree &amp;bouquet, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00965">Structure.cc:965</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbit_branch_html_a2581d6db8d6bbb0ccedabc12adc576f8"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a2581d6db8d6bbb0ccedabc12adc576f8">CASM::GenericOrbitBranch::prototype</a></div><div class="ttdeci">ClustType &amp; prototype(Index no)</div><div class="ttdoc">Method to access prototypes. </div><div class="ttdef"><b>Definition:</b> <a href="_orbit_branch__impl_8hh_source.html#l00036">OrbitBranch_impl.hh:36</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_afbe6a69dd0e100c047bfca47b4831b68"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#afbe6a69dd0e100c047bfca47b4831b68">CASM::Structure::bedazzle</a></div><div class="ttdeci">Array&lt; Structure &gt; bedazzle(Array&lt; SiteCluster &gt; stamps, bool lat_override=0, bool im_override=0) const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00945">Structure.cc:945</a></div></div>
<div class="ttc" id="json_clust_8hh_html"><div class="ttname"><a href="json_clust_8hh.html">jsonClust.hh</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_ac456c1cf9228707cbc8940b53b353ddf"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#ac456c1cf9228707cbc8940b53b353ddf">CASM::Structure::operator=</a></div><div class="ttdeci">Structure &amp; operator=(const Structure &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00040">Structure.cc:40</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_cluster_html_a7e5f0cd2efc0fc993f7f8fadcdfe9022"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_cluster.html#a7e5f0cd2efc0fc993f7f8fadcdfe9022">CASM::GenericCluster::home</a></div><div class="ttdeci">const Lattice &amp; home() const </div><div class="ttdef"><b>Definition:</b> <a href="_cluster_8hh_source.html#l00042">Cluster.hh:42</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_ac7bd13e31f4a14b27c0c7a4538fd0346"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#ac7bd13e31f4a14b27c0c7a4538fd0346">CASM::GenericOrbitree::generate_orbitree</a></div><div class="ttdeci">void generate_orbitree(const Structure &amp;prim, bool verbose=false)</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree__impl_8hh_source.html#l00355">Orbitree_impl.hh:355</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_af9022b543c888d231fae3529dacc7638"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#af9022b543c888d231fae3529dacc7638">CASM::Structure::set_occs</a></div><div class="ttdeci">void set_occs(Array&lt; int &gt; occ_index)</div><div class="ttdoc">Setting the current occupants of the structure to those specified by an array of integers. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01190">Structure.cc:1190</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_ae4e0935a5dcfed612f3ca7d4362084f8"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#ae4e0935a5dcfed612f3ca7d4362084f8">CASM::Structure::get_num_each_molecule</a></div><div class="ttdeci">Eigen::VectorXi get_num_each_molecule() const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00206">Structure.cc:206</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a4b0bc547e77a69869f9eab70080d276c"><div class="ttname"><a href="namespace_c_a_s_m.html#a4b0bc547e77a69869f9eab70080d276c">CASM::get_index_converter_inverse</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Index &gt; &gt; get_index_converter_inverse(const Structure &amp;struc, std::vector&lt; std::string &gt; mol_name_list)</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01335">Structure.cc:1335</a></div></div>
<div class="ttc" id="group___array_html_ga34b55c27718e49a5e3db20ee71a7bcaf"><div class="ttname"><a href="group___array.html#ga34b55c27718e49a5e3db20ee71a7bcaf">CASM::Array::reserve</a></div><div class="ttdeci">void reserve(Index new_max)</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00491">Array.hh:491</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_1_1_import__impl_html_a9ba4c7572b4f76374009b80af84a3d8ca8df396e95c9bd31111a8ede0ab7ebec4"><div class="ttname"><a href="namespace_c_a_s_m_1_1_import__impl.html#a9ba4c7572b4f76374009b80af84a3d8ca8df396e95c9bd31111a8ede0ab7ebec4">CASM::Import_impl::path</a></div><div class="ttdef"><b>Definition:</b> <a href="import_8cc_source.html#l00016">import.cc:16</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a10795799a8f9041461f823547a14dc9b"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a10795799a8f9041461f823547a14dc9b">CASM::Structure::Structure</a></div><div class="ttdeci">Structure()</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8hh_source.html#l00057">Structure.hh:57</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_array_html_a13050039016e76fe3b0d22f7850e373a"><div class="ttname"><a href="singleton_c_a_s_m_1_1_array.html#a13050039016e76fe3b0d22f7850e373a">CASM::Array::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00212">Array.hh:212</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_coordinate_html_a9b55b38be407e6604d4ef5ec4d63b77e"><div class="ttname"><a href="class_c_a_s_m_1_1_coordinate.html#a9b55b38be407e6604d4ef5ec4d63b77e">CASM::Coordinate::frac</a></div><div class="ttdeci">Coordinate_impl::FracCoordinate frac()</div><div class="ttdoc">Set the fractional coordinate vector. </div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8hh_source.html#l00581">Coordinate.hh:581</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_master_sym_group_html_ae36732d3425b628eaf02a2a4094f1e9e"><div class="ttname"><a href="class_c_a_s_m_1_1_master_sym_group.html#ae36732d3425b628eaf02a2a4094f1e9e">CASM::MasterSymGroup::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l00083">SymGroup.cc:83</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_abf4306563beb5ec63bf5e1cc3484b985"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#abf4306563beb5ec63bf5e1cc3484b985">CASM::Structure::map_superstruc_to_prim</a></div><div class="ttdeci">void map_superstruc_to_prim(Structure &amp;prim)</div><div class="ttdoc">Figures out which prim basis each superstructure basis corresponds to. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00605">Structure.cc:605</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html">CASM::GenericOrbitree</a></div><div class="ttdef"><b>Definition:</b> <a href="clex_2clex_8hh_source.html#l00013">Clex.hh:13</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_a381762d522e742ae63351b313b835b51"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#a381762d522e742ae63351b313b835b51">CASM::GenericOrbitree::max_length</a></div><div class="ttdeci">Array&lt; double &gt; max_length</div><div class="ttdef"><b>Definition:</b> <a href="_orbitree_8hh_source.html#l00051">Orbitree.hh:51</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_group_html_aa808b6e65565ae9b7277de1934d45ffa"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group.html#aa808b6e65565ae9b7277de1934d45ffa">CASM::SymGroup::set_lattice</a></div><div class="ttdeci">void set_lattice(const Lattice &amp;new_lat)</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l00435">SymGroup.cc:435</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_sym_group_rep_html"><div class="ttname"><a href="class_c_a_s_m_1_1_sym_group_rep.html">CASM::SymGroupRep</a></div><div class="ttdoc">SymGroupRep is an alternative representation of a SymGroup for something other than real space...</div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_rep_8hh_source.html#l00030">SymGroupRep.hh:30</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_site_html"><div class="ttname"><a href="class_c_a_s_m_1_1_site.html">CASM::Site</a></div><div class="ttdef"><b>Definition:</b> <a href="_site_8hh_source.html#l00016">Site.hh:16</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725"><div class="ttname"><a href="namespace_c_a_s_m.html#a31441bb194985a14bbd654475fa7a7dea243babd9b6342cf6b3a627362cbce725">CASM::CART</a></div><div class="ttdef"><b>Definition:</b> <a href="_c_a_s_m__global__definitions_8hh_source.html#l00057">CASM_global_definitions.hh:57</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a526558978b0594a7cc3ad3b1088cf6f4"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a526558978b0594a7cc3ad3b1088cf6f4">CASM::BasicStructure::generate_basis_permutation_representation</a></div><div class="ttdeci">SymGroupRepID generate_basis_permutation_representation(const MasterSymGroup &amp;factor_group, bool verbose) const </div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l00275">BasicStructure_impl.hh:275</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_coordinate_html_af0104bf945ae61b02b64cbd83ba026d6"><div class="ttname"><a href="class_c_a_s_m_1_1_coordinate.html#af0104bf945ae61b02b64cbd83ba026d6">CASM::Coordinate::within</a></div><div class="ttdeci">bool within()</div><div class="ttdef"><b>Definition:</b> <a href="_coordinate_8cc_source.html#l00261">Coordinate.cc:261</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a90a060200671d8faa9e902e6d44619fb"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a90a060200671d8faa9e902e6d44619fb">CASM::BasicStructure&lt; Site &gt;::within</a></div><div class="ttdeci">void within()</div><div class="ttdoc">Translate all basis sites so that they are inside the unit cell. </div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbit_branch_html_a49ac57de6452c24fd8e768b61a3e79c5"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#a49ac57de6452c24fd8e768b61a3e79c5">CASM::GenericOrbitBranch::size</a></div><div class="ttdeci">Index size(Index no) const </div><div class="ttdoc">How many equivalent clusters are int orbit &#39;no&#39;. </div><div class="ttdef"><b>Definition:</b> <a href="_orbit_branch__impl_8hh_source.html#l00057">OrbitBranch_impl.hh:57</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a00858666d0ffa7d1b6d610cf445fbea2"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a00858666d0ffa7d1b6d610cf445fbea2">CASM::Structure::print_site_symmetry</a></div><div class="ttdeci">void print_site_symmetry(std::ostream &amp;stream, COORD_TYPE mode, int shorttag, double tol)</div><div class="ttdoc">For each symmetrically distinct site, print the symmetry operations that map it onto itself...</div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00348">Structure.cc:348</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbit_branch_html_ab68b73b13412b54639e0388e52926a20"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbit_branch.html#ab68b73b13412b54639e0388e52926a20">CASM::GenericOrbitBranch::generate_asymmetric_unit</a></div><div class="ttdeci">void generate_asymmetric_unit(const Array&lt; typename ClustType::WhichCoordType &gt; &amp;basis, const SymGroup &amp;factor_group, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="_orbit_branch__impl_8hh_source.html#l00194">OrbitBranch_impl.hh:194</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_array_html_a0ced4c52a42bd9e4fa79bb4107d2b87c"><div class="ttname"><a href="singleton_c_a_s_m_1_1_array.html#a0ced4c52a42bd9e4fa79bb4107d2b87c">CASM::Array::back</a></div><div class="ttdeci">T &amp; back()</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00177">Array.hh:177</a></div></div>
<div class="ttc" id="namespace_c_a_s_m_html_abaf3dc70b7ec68e71a693d80f3b99fca"><div class="ttname"><a href="namespace_c_a_s_m.html#abaf3dc70b7ec68e71a693d80f3b99fca">CASM::contains</a></div><div class="ttdeci">bool contains(const Container &amp;container, const T &amp;value)</div><div class="ttdoc">Equivalent to container.end() != std::find(container.begin(), container.end(), value) ...</div><div class="ttdef"><b>Definition:</b> <a href="algorithm_8hh_source.html#l00066">algorithm.hh:66</a></div></div>
<div class="ttc" id="_site_cluster_8hh_html"><div class="ttname"><a href="_site_cluster_8hh.html">SiteCluster.hh</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_cluster_html_a16cdd2f07808decf80464a49eaf1fdc1"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_cluster.html#a16cdd2f07808decf80464a49eaf1fdc1">CASM::GenericCluster::within</a></div><div class="ttdeci">void within(Index pivot_ind=0)</div><div class="ttdoc">Translate entire cluster so that point at(pivot_ind) is inside unit cell. </div><div class="ttdef"><b>Definition:</b> <a href="_cluster__impl_8hh_source.html#l00139">Cluster_impl.hh:139</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_array_html"><div class="ttname"><a href="singleton_c_a_s_m_1_1_array.html">CASM::Array</a></div><div class="ttdoc">Basic std::vector like container (deprecated) </div><div class="ttdef"><b>Definition:</b> <a href="_cluster_functions_8hh_source.html#l00008">ClusterFunctions.hh:8</a></div></div>
<div class="ttc" id="_structure_8hh_html"><div class="ttname"><a href="_structure_8hh.html">Structure.hh</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_ae0e016286499743db16081265aec0dc8"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#ae0e016286499743db16081265aec0dc8">CASM::Structure::clump_atoms</a></div><div class="ttdeci">void clump_atoms(double maxdist, double tol)</div><div class="ttdoc">If atoms are too close together, average their distance and make them one. </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00793">Structure.cc:793</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_cluster_html_a5ba2db1fd2813e53babeb83ded1e2e32"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_cluster.html#a5ba2db1fd2813e53babeb83ded1e2e32">CASM::GenericCluster::print</a></div><div class="ttdeci">void print(std::ostream &amp;stream, char delim= '\n', COORD_TYPE mode=COORD_DEFAULT) const </div><div class="ttdef"><b>Definition:</b> <a href="_cluster__impl_8hh_source.html#l00756">Cluster_impl.hh:756</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_generic_orbitree_html_acfa220926b31e1adce6acfe2a1c91b21"><div class="ttname"><a href="singleton_c_a_s_m_1_1_generic_orbitree.html#acfa220926b31e1adce6acfe2a1c91b21">CASM::GenericOrbitree::size</a></div><div class="ttdeci">Index size(Index np) const </div><div class="ttdoc">Number of orbits in OrbitBranch &#39;np&#39;. </div><div class="ttdef"><b>Definition:</b> <a href="_orbitree__impl_8hh_source.html#l00089">Orbitree_impl.hh:89</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a7ccb267b36fb5fdc4725979de28e3e84"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a7ccb267b36fb5fdc4725979de28e3e84">CASM::Structure::to_json</a></div><div class="ttdeci">jsonParser &amp; to_json(jsonParser &amp;json) const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l01224">Structure.cc:1224</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_structure_html_a77096ea1b4e9cf91135278937b5a14e7"><div class="ttname"><a href="class_c_a_s_m_1_1_structure.html#a77096ea1b4e9cf91135278937b5a14e7">CASM::Structure::get_num_each_specie</a></div><div class="ttdeci">Eigen::VectorXi get_num_each_specie() const </div><div class="ttdef"><b>Definition:</b> <a href="_structure_8cc_source.html#l00184">Structure.cc:184</a></div></div>
<div class="ttc" id="group___array_html_gaee7403e1ab7714a25b19f3826ce7066f"><div class="ttname"><a href="group___array.html#gaee7403e1ab7714a25b19f3826ce7066f">CASM::Array::remove</a></div><div class="ttdeci">void remove(Index ind)</div><div class="ttdef"><b>Definition:</b> <a href="_array_8hh_source.html#l00546">Array.hh:546</a></div></div>
<div class="ttc" id="class_c_a_s_m_1_1_master_sym_group_html_abdab8f7779422c2c90fb25c721f74ef2"><div class="ttname"><a href="class_c_a_s_m_1_1_master_sym_group.html#abdab8f7779422c2c90fb25c721f74ef2">CASM::MasterSymGroup::representation</a></div><div class="ttdeci">SymGroupRep const &amp; representation(SymGroupRepID i) const </div><div class="ttdoc">Const access of alternate Representations of a SymGroup. </div><div class="ttdef"><b>Definition:</b> <a href="_sym_group_8cc_source.html#l00375">SymGroup.cc:375</a></div></div>
<div class="ttc" id="singleton_c_a_s_m_1_1_basic_structure_html_a2f79db2e8427199093a3487639c2e18b"><div class="ttname"><a href="singleton_c_a_s_m_1_1_basic_structure.html#a2f79db2e8427199093a3487639c2e18b">CASM::BasicStructure::operator=</a></div><div class="ttdeci">virtual BasicStructure &amp; operator=(const BasicStructure &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="_basic_structure__impl_8hh_source.html#l00040">BasicStructure_impl.hh:40</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5cfd736d3f72e24a1e41f845c72e1330.html">src</a></li><li class="navelem"><a class="el" href="dir_9bbf44b014308585d1c69daaee49072e.html">casm</a></li><li class="navelem"><a class="el" href="dir_a1c1da64f5e65e263ea6109f65166a95.html">crystallography</a></li><li class="navelem"><a class="el" href="_structure_8cc.html">Structure.cc</a></li>
    <li class="footer">Generated on Fri Aug 10 2018 02:19:29 for CASM by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
